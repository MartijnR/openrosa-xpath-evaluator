{"version":3,"sources":["webpack://orxe/webpack/universalModuleDefinition","webpack://orxe/webpack/bootstrap","webpack://orxe/./src/utils/date.js","webpack://orxe/./src/config.js","webpack://orxe/./src/utils/result.js","webpack://orxe/./src/orxe.js","webpack://orxe/./src/engine.js","webpack://orxe/./src/date-extensions.js","webpack://orxe/./src/extended-xpath.js","webpack://orxe/./src/utils/shuffle.js","webpack://orxe/./src/utils/ns.js","webpack://orxe/./src/utils/operation.js","webpack://orxe/./src/utils/native.js","webpack://orxe/./src/utils/input.js","webpack://orxe/./src/openrosa-extensions.js","webpack://orxe/./src/geo.js","webpack://orxe/./src/digest.js","webpack://orxe/external \"node-forge\"","webpack://orxe/./src/random-token.js"],"names":["DATE_STRING","dateToDays","d","rounded","temp","indexOf","Date","split","r","getTime","Math","round","module","exports","allowStringComparison","includeTimeForTodayString","returnCurrentTimeForToday","toNodes","n","v","iterateNext","push","getNamespaceAtts","result","name","unshift","toSnapshotResult","nodes","rt","singleItem","idx","resultType","singleNodeValue","length","snapshotLength","snapshotItem","i","require","ExtendedXpathEvaluator","openrosaExtensions","config","extensions","extendedXpathEvaluator","openrosaXpathExtensions","customXPathFunction","type","StringType","XPR","string","NumberType","number","BooleanType","DateType","date","add","fnObj","func","remove","all","getCurrentDomLevel3XPathBindings","XPathException","window","XPathExpression","XPathNSResolver","XPathResult","XPathNamespace","createExpression","document","createNSResolver","evaluate","createDomLevel3XPathBindings","options","evaluator","XPathEvaluator","e","contextPath","namespaceResolver","wrappedXpathEvaluator","node","startsWith","wrappedResultType","ANY_TYPE","xevaluator","apply","arguments","bindDomLevel3XPath","doc","bindings","newBindings","currentBindings","prototype","toISOLocalString","toString","dt","getTimezoneOffset","toISOString","replace","getTimezoneOffsetAsTime","offsetMinutesTotal","hours","minutes","direction","pad2","x","floor","abs","shuffle","isNamespaceExpr","handleNamespaceExpr","handleOperation","isNativeFunction","preprocessNativeArgs","inputArgs","preprocessInput","OP_PRECEDENCE","DIGIT","FUNCTION_NAME","NUMERIC_COMPARATOR","BOOLEAN_COMPARATOR","BOOLEAN_FN_COMPARATOR","COMPARATOR","INVALID_ARGS","Error","TOO_MANY_ARGS","TOO_FEW_ARGS","wrapped","extendedFuncs","extendedProcessors","process","toInternalResult","NUMBER_TYPE","t","numberValue","BOOLEAN_TYPE","booleanValue","UNORDERED_NODE_ITERATOR_TYPE","textContent","stringValue","toExternalResult","res","then","STRING_TYPE","test","val","days","UNORDERED_SNAPSHOT_TYPE","Array","isArray","parseInt","callFn","args","hasOwnProperty","callExtended","Number","POSITIVE_INFINITY","NEGATIVE_INFINITY","callNative","argVals","argString","arg","quote","typefor","input","cN","nR","rT","isNaN","nodeType","ownerElement","exec","bargs","substring","ownerDocument","cur","stack","tokens","peek","err","message","JSON","stringify","newCurrent","pushOp","evalOp","lhs","op","rhs","handleInfix","evalOpAt","opIndex","splice","backtrack","j","ops","handleXpathExpr","expr","evaluated","includes","nextChar","charAt","finaliseNum","parseFloat","prevToken","peeked","isNum","c","sq","decimal","tail","pop","expectedReturnType","trim","prev","toLowerCase","MAX_INT32","MINSTD","array","seed","rng","isInteger","rnd","Random","nextFloat","bind","random","_seed","next","namespace","nsId","xnamespaces","xitems","attributes","ii","xattr","xitem","getAttributeNode","nodeName","localName","namespaceURI","nodeValue","namespaceNode","namespaces","namespaceKeys","items","attr","item","names","parentNode","xmlns","xml","sort","n1","n2","isNumber","value","nbr","NaN","undefined","Boolean","iii","k","l","m","p","q","NATIVE_FUNS","checkMinMaxArgs","min","max","checkNativeFn","isOperation","ARGS_REGEX","match","area","distance","areaOrDistance","digest","randomToken","openrosa_xpath_extensions","MILLIS_PER_DAY","RAW_NUMBER","_zeroPad","len","_int","_float","_str","_dateToString","getFullYear","getMonth","getDate","_round","num","_uuid_part","_date","it","keepTime","setDate","_dateForReturnType","uuid","format_date","format","sb","f","year","getYear","month","day","hour","getHours","minute","getMinutes","second","getSeconds","millis","getMilliseconds","secTicks","dow","getDay","locale","enketoFormLocale","toLocaleDateString","weekday","ret","now_and_today","resetTime","_now","acos","asin","atan","atan2","y","checklist","trues","coalesce","a","b","concat","out","join","cos","counter","s","parts","count","parse","time","PRECISION","dec","today","msg","algo","encoding","exp","exp10","pow","con","exists","endsWith","delim","log","log10","not","now","once","Infinity","pi","PI","position","tagName","previousElementSibling","randomize","regex","haystack","pattern","RegExp","num_digits","selected","needle","list","index","sin","sqrt","substr","startIndex","endIndex","slice","sum","tan","values","weights","weightedTrues","w","EARTH_EQUATORIAL_RADIUS_METERS","_toLatLngs","geopoints","map","geopoint","_toRadians","angle","_latLngsValid","latLngs","every","coords","_distanceBetween","p1","p2","Δλ","lng","φ1","lat","φ2","xpr","fn","pointsCount","forge","md","create","update","hashBuffer","util","encode64","bytes","toHex","_random13chars","loops","ceil","fill","reduce"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;QCVA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;;;;;AClFA,MAAIA,WAAW,GAAG,+EAAlB;;AAEA,WAASC,UAAT,CAAoBC,CAApB,EAAuBC,OAAvB,EAAgC;AAC9B,QAAIC,IAAI,GAAG,IAAX;;AACA,QAAGF,CAAC,CAACG,OAAF,CAAU,GAAV,IAAiB,CAApB,EAAuB;AACrBD,UAAI,GAAG,IAAIE,IAAJ,CAASJ,CAAT,CAAP;AACD,KAFD,MAEO;AACLE,UAAI,GAAGF,CAAC,CAACK,KAAF,CAAQ,GAAR,CAAP;AACAH,UAAI,GAAG,IAAIE,IAAJ,CAASF,IAAI,CAAC,CAAD,CAAb,EAAkBA,IAAI,CAAC,CAAD,CAAJ,GAAQ,CAA1B,EAA6BA,IAAI,CAAC,CAAD,CAAjC,CAAP;AACD;;AACD,QAAII,CAAC,GAAIJ,IAAI,CAACK,OAAL,EAAD,IAAoB,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAArC,CAAR;AACA,WAAON,OAAO,KAAK,KAAZ,GAAoBK,CAApB,GAAwBE,IAAI,CAACC,KAAL,CAAWH,CAAC,GAAC,MAAb,IAAqB,MAApD;AACD;;AAEDI,QAAM,CAACC,OAAP,GAAiB;AACfb,eAAW,EAAXA,WADe;AAEfC,cAAU,EAAVA;AAFe,GAAjB;;;;;;;;;;;;;;;;;ACdAW,QAAM,CAACC,OAAP,GAAiB;AACfC,yBAAqB,EAAE,IADR;AAEfC,6BAAyB,EAAE,KAFZ;AAGfC,6BAAyB,EAAE;AAHZ,GAAjB;;;;;;;;;;;;;;;;;ACAA,WAASC,OAAT,CAAiBT,CAAjB,EAAoB;AAClB,QAAIU,CAAJ;AAAA,QAAOC,CAAC,GAAG,EAAX;;AACA,WAAOD,CAAC,GAAGV,CAAC,CAACY,WAAF,EAAX;AAA6BD,OAAC,CAACE,IAAF,CAAOH,CAAP;AAA7B;;AACA,WAAOC,CAAP;AACD;;AAED,WAASG,gBAAT,CAA0BC,MAA1B,EAAkC;AAChC,QAAIJ,CAAC,GAAG,EAAR;AAAA,QAAYD,CAAZ;;AACA,WAAOA,CAAC,GAAGK,MAAM,CAACH,WAAP,EAAX,EAAkC;AAChC,UAAGF,CAAC,CAACM,IAAF,CAAOnB,OAAP,CAAe,GAAf,IAAoB,CAAvB,EAA0Bc,CAAC,CAACM,OAAF,CAAUP,CAAV;AAC3B;;AACD,WAAOC,CAAP;AACD;;AAED,WAASO,gBAAT,CAA0BC,KAA1B,EAAiCC,EAAjC,EAAqCC,UAArC,EAAiD;AAC/C,WAAO,YAAW;AAChB,UAAIC,GAAG,GAAG,CAAV;AACA,aAAO;AACLC,kBAAU,EAAEH,EADP;AAELI,uBAAe,EAAEL,KAAK,CAACM,MAAN,GAAeJ,UAAU,IAAIF,KAAK,CAAC,CAAD,CAAlC,GAAwC,IAFpD;AAGLO,sBAAc,EAAEP,KAAK,CAACM,MAHjB;AAILE,oBAAY,EAAE,sBAASC,CAAT,EAAW;AAAC,iBAAOT,KAAK,CAACS,CAAD,CAAZ;AAAiB,SAJtC;AAKLhB,mBAAW,EAAE,uBAAU;AAAC,iBAAOO,KAAK,CAACM,MAAN,GAAeH,GAAf,GAAqBH,KAAK,CAACG,GAAG,EAAJ,CAA1B,GAAoC,IAA3C;AAAiD;AALpE,OAAP;AAOD,KATM,EAAP;AAUD;;AAEDlB,QAAM,CAACC,OAAP,GAAiB;AACfS,oBAAgB,EAAhBA,gBADe;AAEfL,WAAO,EAAPA,OAFe;AAGfS,oBAAgB,EAAhBA;AAHe,GAAjB;;;;;;;;;;;;;;;;;AC3BAd,QAAM,CAACC,OAAP,GAAiBwB,mBAAO,CAAC,CAAD,CAAxB;;;;;;;;;;;;;;;;;ACAAA,qBAAO,CAAC,CAAD,CAAP;;AACA,MAAIC,sBAAsB,GAAGD,mBAAO,CAAC,CAAD,CAApC;;AACA,MAAIE,kBAAkB,GAAGF,mBAAO,CAAC,EAAD,CAAhC;;AACA,MAAIG,MAAM,GAAGH,mBAAO,CAAC,CAAD,CAApB;;AACA,MAAII,UAAU,GAAGF,kBAAkB,CAACC,MAAD,CAAnC;;AAEA5B,QAAM,CAACC,OAAP,GAAkB,YAAU;AAE1B,QAAID,MAAM,GAAG;AACX8B,4BAAsB,EAAEJ,sBADb;AAEXK,6BAAuB,EAAEJ,kBAFd;AAGXC,YAAM,EAAEA,MAHG;AAIXI,yBAAmB,EAAE;AACtBC,YAAI,EAAE;AACLC,oBAAU,EAAEL,UAAU,CAACM,GAAX,CAAeC,MADtB;AAELC,oBAAU,EAAER,UAAU,CAACM,GAAX,CAAeG,MAFtB;AAGLC,qBAAW,EAAEV,UAAU,CAACM,GAAX,WAHR;AAILK,kBAAQ,EAAEX,UAAU,CAACM,GAAX,CAAeM;AAJpB,SADgB;AAOtBC,WAAG,EAAE,aAAS9B,IAAT,EAAe+B,KAAf,EAAsB;AAC1Bd,oBAAU,CAACe,IAAX,CAAgBhC,IAAhB,IAAwB+B,KAAxB;AACA,SATqB;AAUtBE,cAAM,EAAE,gBAASjC,IAAT,EAAe;AACtB,iBAAOiB,UAAU,CAACe,IAAX,CAAgBhC,IAAhB,CAAP;AACA,SAZqB;AAanBkC,WAAG,EAAE,eAAW;AACd,iBAAOjB,UAAU,CAACe,IAAlB;AACD;AAfkB,OAJV;AA6BbG,sCAAgC,EAAE,4CAClC;AACC,eAAO;AACN,oBAAU;AACTC,0BAAc,EAAEC,MAAM,CAACD,cADd;AAETE,2BAAe,EAAED,MAAM,CAACC,eAFf;AAGTC,2BAAe,EAAEF,MAAM,CAACE,eAHf;AAITC,uBAAW,EAAEH,MAAM,CAACG,WAJX;AAKTC,0BAAc,EAAEJ,MAAM,CAACI;AALd,WADJ;AAQN,sBAAY;AACXC,4BAAgB,EAAEC,QAAQ,CAACD,gBADhB;AAEXE,4BAAgB,EAAED,QAAQ,CAACC,gBAFhB;AAGXC,oBAAQ,EAAEF,QAAQ,CAACE;AAHR;AARN,SAAP;AAcA,OA7CY;AAsDbC,kCAA4B,EAAE,sCAASC,OAAT,EAC9B;AACC,YAAIC,SAAS,GAAG,IAAIC,cAAJ,CAAmBF,OAAnB,CAAhB;AAEA,eAAO;AACN,sBAAY;AACNF,oBAAQ,EAAE,kBAASK,CAAT,EAAYC,WAAZ,EAAyBC,iBAAzB,EAA4C7C,UAA5C,EAAwDR,MAAxD,EAAgE;AACxE,kBAAIsD,qBAAqB,GAAG,SAAxBA,qBAAwB,CAAS1D,CAAT,EAAY2D,IAAZ,EAAkBlD,EAAlB,EAAsB;AAChD,oBAAGG,UAAU,GAAG,CAAb,IAAkBZ,CAAC,CAAC4D,UAAF,CAAa,IAAb,CAArB,EAAyChD,UAAU,GAAG,IAAb;AACzC,oBAAIiD,iBAAiB,GAAGpD,EAAE,IAAIG,UAAN,IAAoBiC,WAAW,CAACiB,QAAxD;AACA,uBAAOT,SAAS,CAACH,QAAV,CAAmBlD,CAAnB,EAAsB2D,IAAI,IAAIH,WAA9B,EAA2CC,iBAA3C,EAA8DI,iBAAiB,IAAIhB,WAAW,CAACiB,QAA/F,EAAyG1D,MAAzG,CAAP;AACD,eAJD;;AAKA,kBAAI2D,UAAU,GAAG,IAAI5C,sBAAJ,CAA2BuC,qBAA3B,EAAkDpC,UAAlD,CAAjB;AACA,qBAAOyC,UAAU,CAACb,QAAX,CAAoBc,KAApB,CAA0BD,UAA1B,EAAsCE,SAAtC,CAAP;AACD;AATK;AADN,SAAP;AAaA,OAvEY;AA+EbC,wBAAkB,EAAE,4BAASC,GAAT,EAAcC,QAAd,EACpB;AACC,YAAIC,WAAW,GAAID,QAAQ,IAAI3E,MAAM,CAAC0D,4BAAP,EAA/B;AAAA,YACCmB,eAAe,GAAG7E,MAAM,CAAC+C,gCAAP,EADnB;AAAA,YAECvB,CAFD;AAKAkD,WAAG,GAAGA,GAAG,IAAInB,QAAb;;AAEA,aAAI/B,CAAJ,IAASoD,WAAW,CAAC,UAAD,CAApB,EACA;AACCF,aAAG,CAAClD,CAAD,CAAH,GAASoD,WAAW,CAAC,UAAD,CAAX,CAAwBpD,CAAxB,CAAT;AACA;;AAED,eAAOqD,eAAP;AACA;AA9FY,KAAb;AAgGD,WAAO7E,MAAP;AAEA,GApGgB,EAAjB;;;;;;;;;;;;;;;;;ACDAN,MAAI,CAACoF,SAAL,CAAeC,gBAAf,GAAkC,YAAW;AAG3C,QAAG,KAAKC,QAAL,OAAoB,cAAvB,EAAuC;AACrC,aAAO,KAAKA,QAAL,EAAP;AACD;;AAED,QAAIC,EAAE,GAAG,IAAIvF,IAAJ,CAAS,KAAKG,OAAL,KAAkB,KAAKqF,iBAAL,KAA2B,EAA3B,GAAgC,IAA3D,EAAkEC,WAAlE,GACJC,OADI,CACI,GADJ,EACS,KAAKC,uBAAL,EADT,CAAT;;AAGA,QAAGJ,EAAE,CAACxF,OAAH,CAAW,eAAX,IAA8B,CAAjC,EAAoC;AAClC,aAAOwF,EAAE,CAACtF,KAAH,CAAS,GAAT,EAAc,CAAd,CAAP;AACD,KAFD,MAEO;AACL,aAAOsF,EAAP;AACD;AACF,GAfD;;AAiBAvF,MAAI,CAACoF,SAAL,CAAeO,uBAAf,GAAyC,YAAW;AAClD,QAAIC,kBAAJ;AACA,QAAIC,KAAJ;AACA,QAAIC,OAAJ;AACA,QAAIC,SAAJ;;AACA,QAAIC,IAAI,GAAG,SAAPA,IAAO,CAASC,CAAT,EAAY;AACrB,aAAQA,CAAC,GAAG,EAAL,GAAW,MAAMA,CAAjB,GAAqBA,CAA5B;AACD,KAFD;;AAIA,QAAG,KAAKX,QAAL,OAAoB,cAAvB,EAAuC;AACrC,aAAO,KAAKA,QAAL,EAAP;AACD;;AAEDM,sBAAkB,GAAG,KAAKJ,iBAAL,EAArB;AAEAO,aAAS,GAAIH,kBAAkB,GAAG,CAAtB,GAA2B,GAA3B,GAAiC,GAA7C;AACAC,SAAK,GAAGG,IAAI,CAAC5F,IAAI,CAAC8F,KAAL,CAAW9F,IAAI,CAAC+F,GAAL,CAASP,kBAAkB,GAAG,EAA9B,CAAX,CAAD,CAAZ;AACAE,WAAO,GAAGE,IAAI,CAAC5F,IAAI,CAAC8F,KAAL,CAAW9F,IAAI,CAAC+F,GAAL,CAASP,kBAAkB,GAAG,EAA9B,CAAX,CAAD,CAAd;AAEA,WAAOG,SAAS,GAAGF,KAAZ,GAAoB,GAApB,GAA0BC,OAAjC;AACD,GApBD;;;;;;;;;;;;;;;;;ACtBA,MAAI5D,MAAM,GAAGH,mBAAO,CAAC,CAAD,CAApB;;AACA,MAAIqE,OAAO,GAAGrE,mBAAO,CAAC,CAAD,CAArB;;iBAC6CA,mBAAO,CAAC,CAAD,C;MAA/CsE,e,YAAAA,e;MAAiBC,mB,YAAAA,mB;;kBACEvE,mBAAO,CAAC,CAAD,C;MAA1BwE,e,aAAAA,e;;kBAC0CxE,mBAAO,CAAC,EAAD,C;MAAjDyE,gB,aAAAA,gB;MAAkBC,oB,aAAAA,oB;;kBACS1E,mBAAO,CAAC,CAAD,C;MAAlCrC,W,aAAAA,W;MAAaC,U,aAAAA,U;;kBACgBoC,mBAAO,CAAC,CAAD,C;MAApCpB,O,aAAAA,O;MAASS,gB,aAAAA,gB;;kBACqBW,mBAAO,CAAC,EAAD,C;MAArC2E,S,aAAAA,S;MAAWC,e,aAAAA,e;;AAMhB,MAAIC,aAAa,GAAG,CAClB,CAAC,GAAD,CADkB,EAElB,CAAC,GAAD,CAFkB,EAGlB,CAAC,GAAD,EAAM,IAAN,CAHkB,EAIlB,CAAC,GAAD,EAAM,IAAN,EAAY,IAAZ,EAAkB,GAAlB,CAJkB,EAKlB,CAAC,GAAD,EAAM,GAAN,CALkB,EAMlB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CANkB,CAApB;AASA,MAAIC,KAAK,GAAG,OAAZ;AACA,MAAIC,aAAa,GAAG,QAApB;AACA,MAAIC,kBAAkB,GAAG,OAAzB;AACA,MAAIC,kBAAkB,GAAG,KAAzB;AACA,MAAIC,qBAAqB,GAAG,sBAA5B;AACA,MAAIC,UAAU,GAAG,SAAjB;AAEA,MAAIC,YAAY,GAAG,IAAIC,KAAJ,CAAU,cAAV,CAAnB;AACA,MAAIC,aAAa,GAAG,IAAID,KAAJ,CAAU,eAAV,CAApB;AACA,MAAIE,YAAY,GAAG,IAAIF,KAAJ,CAAU,cAAV,CAAnB;;AAGA,MAAIpF,sBAAsB,GAAG,SAAzBA,sBAAyB,CAASuF,OAAT,EAAkBpF,UAAlB,EAA8B;AACzD,QACEqF,aAAa,GAAGrF,UAAU,CAACe,IAAX,IAAmB,EADrC;AAAA,QAEEuE,kBAAkB,GAAGtF,UAAU,CAACuF,OAAX,IAAsB,EAF7C;AAAA,QAGEC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAASzH,CAAT,EAAY;AAC7B,UAAIU,CAAJ,EAAOC,CAAP;AACA,UAAGX,CAAC,CAACuB,UAAF,KAAiBiC,WAAW,CAACkE,WAAhC,EAA6C,OAAO;AAAEC,SAAC,EAAC,KAAJ;AAAWhH,SAAC,EAACX,CAAC,CAAC4H;AAAf,OAAP;AAC7C,UAAG5H,CAAC,CAACuB,UAAF,KAAiBiC,WAAW,CAACqE,YAAhC,EAA8C,OAAO;AAAGF,SAAC,EAAC,MAAL;AAAahH,SAAC,EAACX,CAAC,CAAC8H;AAAjB,OAAP;;AAC9C,UAAG9H,CAAC,CAACuB,UAAF,KAAiBiC,WAAW,CAACuE,4BAAhC,EAA8D;AAC5DpH,SAAC,GAAG,EAAJ;;AACA,eAAOD,CAAC,GAAGV,CAAC,CAACY,WAAF,EAAX;AAA6BD,WAAC,CAACE,IAAF,CAAOH,CAAC,CAACsH,WAAT;AAA7B;;AACA,eAAO;AAAEL,WAAC,EAAC,KAAJ;AAAWhH,WAAC,EAACA;AAAb,SAAP;AACD;;AACD,aAAO;AAAEgH,SAAC,EAAC,KAAJ;AAAWhH,SAAC,EAACX,CAAC,CAACiI;AAAf,OAAP;AACD,KAbH;AAAA,QAcEC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAASlI,CAAT,EAAYoB,EAAZ,EAAgB;AACjC,UAAGmG,kBAAkB,CAACW,gBAAtB,EAAwC;AACtC,YAAIC,GAAG,GAAGZ,kBAAkB,CAACW,gBAAnB,CAAoClI,CAApC,CAAV;AACA,YAAGmI,GAAH,EAAQ,OAAOA,GAAP;AACT;;AAGD,UAAGnI,CAAC,CAACW,CAAF,IAAO,OAAOX,CAAC,CAACW,CAAF,CAAIyH,IAAX,KAAoB,UAA3B,IAAyChH,EAAE,KAAKoC,WAAW,CAAC6E,WAA/D,EAA4E;AAC1E,eAAO;AAAC9G,oBAAU,EAAEiC,WAAW,CAAC6E,WAAzB;AAAsCJ,qBAAW,EAAEjI,CAAC,CAACW;AAArD,SAAP;AACD;;AAED,UAAIX,CAAC,CAAC2H,CAAF,KAAQ,KAAR,IAAiBvG,EAAE,KAAKoC,WAAW,CAACkE,WAApC,IAAmDlI,WAAW,CAAC8I,IAAZ,CAAiBtI,CAAC,CAACW,CAAF,CAAI,CAAJ,CAAjB,CAApD,IACEX,CAAC,CAAC2H,CAAF,KAAQ,KAAR,IAAiBvG,EAAE,KAAKoC,WAAW,CAACkE,WAApC,IAAmDlI,WAAW,CAAC8I,IAAZ,CAAiBtI,CAAC,CAACW,CAAnB,CADxD,EACgF;AAC9E,YAAI4H,GAAG,GAAGvI,CAAC,CAAC2H,CAAF,KAAQ,KAAR,GAAgB3H,CAAC,CAACW,CAAF,CAAI,CAAJ,CAAhB,GAAyBX,CAAC,CAACW,CAArC;AACA,YAAI6H,IAAI,GAAG/I,UAAU,CAAC8I,GAAD,CAArB;AACA,eAAO;AACLhH,oBAAU,EAACiC,WAAW,CAACkE,WADlB;AAELE,qBAAW,EAACY,IAFP;AAGLP,qBAAW,EAACO;AAHP,SAAP;AAKD;;AAED,UAAGxI,CAAC,CAAC2H,CAAF,KAAQ,KAAX,EAAkB,OAAO;AAAEpG,kBAAU,EAACiC,WAAW,CAACkE,WAAzB;AAAsCE,mBAAW,EAAC5H,CAAC,CAACW,CAApD;AAAuDsH,mBAAW,EAACjI,CAAC,CAACW,CAAF,CAAIyE,QAAJ;AAAnE,OAAP;AAClB,UAAGpF,CAAC,CAAC2H,CAAF,KAAQ,MAAX,EAAkB,OAAO;AAAEpG,kBAAU,EAACiC,WAAW,CAACqE,YAAzB;AAAuCC,oBAAY,EAAC9H,CAAC,CAACW,CAAtD;AAAyDsH,mBAAW,EAACjI,CAAC,CAACW,CAAF,CAAIyE,QAAJ;AAArE,OAAP;;AAElB,UAAGhE,EAAE,GAAG,CAAR,EAAW;AACTpB,SAAC,GAAGkG,OAAO,CAAClG,CAAC,CAAC,CAAD,CAAF,EAAOA,CAAC,CAAC,CAAD,CAAR,CAAX;AACA,eAAOkB,gBAAgB,CAAClB,CAAD,EAAIwD,WAAW,CAACiF,uBAAhB,CAAvB;AACD;;AAED,UAAG,CAACzI,CAAC,CAAC2H,CAAH,IAAQe,KAAK,CAACC,OAAN,CAAc3I,CAAd,CAAX,EAA6B;AAC3B,YAAGoB,EAAE,KAAKoC,WAAW,CAACkE,WAAtB,EAAmC;AACjC,cAAI/G,CAAC,GAAGiI,QAAQ,CAAC5I,CAAC,CAAC,CAAD,CAAD,CAAKgI,WAAN,CAAhB;AACA,iBAAO;AAAEzG,sBAAU,EAACiC,WAAW,CAACkE,WAAzB;AAAsCE,uBAAW,EAACjH,CAAlD;AAAqDsH,uBAAW,EAACtH,CAAC,CAACyE,QAAF;AAAjE,WAAP;AACD,SAHD,MAGO,IAAGhE,EAAE,KAAKoC,WAAW,CAAC6E,WAAtB,EAAmC;AACxC,iBAAO;AAAE9G,sBAAU,EAACiC,WAAW,CAAC6E,WAAzB;AAAsCJ,uBAAW,EAAEjI,CAAC,CAACyB,MAAF,GAAWzB,CAAC,CAAC,CAAD,CAAZ,GAAkB;AAArE,WAAP;AACD;AACF;;AAED,aAAO;AAAEuB,kBAAU,EAACiC,WAAW,CAAC6E,WAAzB;AAAsCJ,mBAAW,EAAEjI,CAAC,CAACW,CAAF,KAAM,IAAN,GAAa,EAAb,GAAkBX,CAAC,CAACW,CAAF,CAAIyE,QAAJ;AAArE,OAAP;AACD,KAtDH;AAAA,QAuDEyD,MAAM,GAAG,SAATA,MAAS,CAAS7H,IAAT,EAAe8H,IAAf,EAAqB1H,EAArB,EAAyB;AAChC,UAAGkG,aAAa,CAACyB,cAAd,CAA6B/H,IAA7B,CAAH,EAAuC;AAErC,YAAGI,EAAE,IAAK,iCAAiCkH,IAAjC,CAAsCtH,IAAtC,CAAV,EAAwD8H,IAAI,CAACjI,IAAL,CAAUO,EAAV;AACxD,YAAG,kBAAkBkH,IAAlB,CAAuBtH,IAAvB,CAAH,EAAiC8H,IAAI,CAACjI,IAAL,CAAUO,EAAE,IAAIoC,WAAW,CAACqE,YAA5B;AACjC,eAAOmB,YAAY,CAAChI,IAAD,EAAO8H,IAAP,CAAnB;AACD;;AAED,UAAG9H,IAAI,KAAK,iBAAT,IAA8B8H,IAAI,CAACrH,MAAtC,EAA8C;AAC5C,YAAI0G,GAAG,GAAGW,IAAI,CAAC,CAAD,CAAJ,CAAQnI,CAAlB;AACAwH,WAAG,GAAGA,GAAG,CAAC3C,OAAJ,CAAY,KAAZ,EAAmB,KAAnB,CAAN;AACA2C,WAAG,GAAGA,GAAG,CAAC3C,OAAJ,CAAY,OAAZ,EAAqB,IAArB,CAAN;AACA2C,WAAG,GAAGA,GAAG,CAAC3C,OAAJ,CAAY,KAAZ,EAAmB,KAAnB,CAAN;AACA2C,WAAG,GAAGA,GAAG,CAAC3C,OAAJ,CAAY,MAAZ,EAAoB,GAApB,CAAN;AACA2C,WAAG,GAAGA,GAAG,CAAC3C,OAAJ,CAAY,YAAZ,EAA0B,EAA1B,CAAN;AACA2C,WAAG,GAAGA,GAAG,CAAC3C,OAAJ,CAAY,MAAZ,EAAoB,IAApB,CAAN;AACA2C,WAAG,GAAGA,GAAG,CAAC3C,OAAJ,CAAY,MAAZ,EAAoB,IAApB,CAAN;AACA,eAAO;AAACmC,WAAC,EAAE,KAAJ;AAAWhH,WAAC,EAAEwH;AAAd,SAAP;AACD;;AAED,UAAGnH,IAAI,KAAK,QAAT,IAAqB8H,IAAI,CAACrH,MAAL,GAAc,CAAnC,KACDqH,IAAI,CAAC,CAAD,CAAJ,CAAQnI,CAAR,KAAcsI,MAAM,CAACC,iBAArB,IACAJ,IAAI,CAAC,CAAD,CAAJ,CAAQnI,CAAR,KAAcsI,MAAM,CAACE,iBADrB,IAEAL,IAAI,CAAC,CAAD,CAAJ,CAAQnI,CAAR,KAAcmI,IAAI,CAAC,CAAD,CAAJ,CAAQnI,CAHrB,CAAH,EAG6B;AAC3B,eAAO;AAAEgH,WAAC,EAAC,KAAJ;AAAWhH,WAAC,EAAEmI,IAAI,CAAC,CAAD,CAAJ,CAAQnI;AAAtB,SAAP;AACD;;AACD,aAAOyI,UAAU,CAACpI,IAAD,EAAOuF,oBAAoB,CAACvF,IAAD,EAAO8H,IAAP,CAA3B,CAAjB;AACD,KAlFH;AAAA,QAmFEE,YAAY,GAAG,SAAfA,YAAe,CAAShI,IAAT,EAAe8H,IAAf,EAAqB;AAClC,UAAIO,OAAO,GAAG,EAAd;AAAA,UAAkBlB,GAAlB;AAAA,UAAuBvG,CAAvB;;AACA,WAAIA,CAAC,GAAC,CAAN,EAASA,CAAC,GAACkH,IAAI,CAACrH,MAAhB,EAAwB,EAAEG,CAA1B;AAA6ByH,eAAO,CAACxI,IAAR,CAAaiI,IAAI,CAAClH,CAAD,CAAjB;AAA7B;;AACAuG,SAAG,GAAGb,aAAa,CAACtG,IAAD,CAAb,CAAoB2D,KAApB,CAA0B,IAA1B,EAAgC0E,OAAhC,CAAN;AACA,aAAOlB,GAAP;AACD,KAxFH;AAAA,QAyFEiB,UAAU,GAAG,SAAbA,UAAa,CAASpI,IAAT,EAAe8H,IAAf,EAAqB;AAChC,UAAIQ,SAAS,GAAG,EAAhB;AAAA,UAAoBC,GAApB;AAAA,UAAyBC,KAAzB;AAAA,UAAgC5H,CAAhC;;AACA,WAAIA,CAAC,GAAC,CAAN,EAASA,CAAC,GAACkH,IAAI,CAACrH,MAAhB,EAAwB,EAAEG,CAA1B,EAA6B;AAC3B2H,WAAG,GAAGT,IAAI,CAAClH,CAAD,CAAV;;AACA,YAAG2H,GAAG,CAAC5B,CAAJ,KAAU,KAAV,IAAmB4B,GAAG,CAAC5B,CAAJ,KAAU,MAAhC,EAAwC;AACtC6B,eAAK,GAAGD,GAAG,CAAC5I,CAAJ,CAAMd,OAAN,CAAc,GAAd,MAAuB,CAAC,CAAxB,GAA4B,GAA5B,GAAkC,GAA1C;AACAyJ,mBAAS,IAAIE,KAAb;AACD;;AACDF,iBAAS,IAAIC,GAAG,CAAC5I,CAAjB;AACA,YAAG4I,GAAG,CAAC5B,CAAJ,KAAU,MAAb,EAAqB2B,SAAS,IAAI,IAAb;AACrB,YAAGC,GAAG,CAAC5B,CAAJ,KAAU,KAAV,IAAmB4B,GAAG,CAAC5B,CAAJ,KAAU,MAAhC,EAAwC2B,SAAS,IAAIE,KAAb;AACxC,YAAG5H,CAAC,GAAGkH,IAAI,CAACrH,MAAL,GAAc,CAArB,EAAwB6H,SAAS,IAAI,IAAb;AACzB;;AACD,aAAO7B,gBAAgB,CAACJ,OAAO,CAACrG,IAAI,GAAG,GAAP,GAAasI,SAAb,GAAyB,GAA1B,CAAR,CAAvB;AACD,KAvGH;AAAA,QAwGEG,OAAO,GAAG,SAAVA,OAAU,CAASlB,GAAT,EAAc;AACtB,UAAGhB,kBAAkB,CAACkC,OAAtB,EAA+B;AAC7B,YAAItB,GAAG,GAAGZ,kBAAkB,CAACkC,OAAnB,CAA2BlB,GAA3B,CAAV;AACA,YAAGJ,GAAH,EAAQ,OAAOA,GAAP;AACT;;AACD,UAAG,OAAOI,GAAP,KAAe,SAAlB,EAA6B,OAAO,MAAP;AAC7B,UAAG,OAAOA,GAAP,KAAe,QAAlB,EAA4B,OAAO,KAAP;AAC5B,aAAO,KAAP;AACD,KAhHH;;AAqHA,SAAK1E,QAAL,GAAgB,UAAS6F,KAAT,EAAgBC,EAAhB,EAAoBC,EAApB,EAAwBC,EAAxB,EAA4B7J,CAA5B,EAA+B;AAC7C0J,WAAK,GAAGjD,eAAe,CAACiD,KAAD,EAAQG,EAAR,CAAvB;AACA,UAAG1D,eAAe,CAACuD,KAAD,CAAlB,EAA2B,OAAOtD,mBAAmB,CAACsD,KAAD,EAAQC,EAAR,CAA1B;;AAE3B,UAAGrD,gBAAgB,CAACoD,KAAD,CAAnB,EAA4B;AAC1B,YAAIZ,IAAI,GAAGtC,SAAS,CAACkD,KAAD,CAApB;;AACA,YAAGZ,IAAI,CAACrH,MAAL,IAAeqH,IAAI,CAAC,CAAD,CAAJ,CAAQrH,MAAvB,IAAiC,CAACqI,KAAK,CAAChB,IAAI,CAAC,CAAD,CAAL,CAA1C,EAAqD;AAAE,gBAAM7B,YAAN;AAAqB;;AAC5E,YAAGyC,KAAK,KAAK,QAAb,EAAuB,MAAMtC,YAAN;AACvB,YAAG,UAAUkB,IAAV,CAAeoB,KAAf,KAAyBC,EAAE,CAACI,QAAH,KAAgB,CAA5C,EAA+CJ,EAAE,GAAGA,EAAE,CAACK,YAAR;;AAC/C,YAAM7B,IAAG,GAAGd,OAAO,CAACqC,KAAD,EAAQC,EAAR,CAAnB;;AACA,YAAGE,EAAE,KAAKrG,WAAW,CAACkE,WAAnB,KACAS,IAAG,CAAC5G,UAAJ,KAAmBiC,WAAW,CAACuE,4BAA/B,IACAI,IAAG,CAAC5G,UAAJ,KAAmBiC,WAAW,CAACuE,4BAF/B,CAAH,EAEiE;AAC/D,cAAIQ,GAAG,GAAGK,QAAQ,CAACT,IAAG,CAACvH,WAAJ,GAAkBoH,WAAnB,CAAlB;AACA,iBAAO;AACLzG,sBAAU,EAAEiC,WAAW,CAACkE,WADnB;AAELE,uBAAW,EAAEW,GAFR;AAGLN,uBAAW,EAAEM;AAHR,WAAP;AAKD;;AACD,eAAOJ,IAAP;AACD;;AAED,UAAI0B,EAAE,GAAG,CAAL,IAAU,CAACH,KAAK,CAACnF,UAAN,CAAiB,WAAjB,CAAZ,IACD,qBAAqB+D,IAArB,CAA0BoB,KAA1B,CADF,EACoC;AAElC,YAAGA,KAAK,CAACnF,UAAN,CAAiB,QAAjB,CAAH,EAA+B;AAC7B,cAAGmF,KAAK,CAAC7J,OAAN,CAAc,GAAd,IAAqB,CAAxB,EAA2B,MAAMsH,aAAN;AAC3B,cAAGuC,KAAK,KAAK,SAAb,EAAwB,MAAMtC,YAAN;AACxB,cAAG,CAAC0C,KAAK,CAAC,WAAWG,IAAX,CAAgBP,KAAhB,EAAuB,CAAvB,CAAD,CAAT,EAAsC,MAAMzC,YAAN;AACvC;;AACD,YAAGyC,KAAK,CAACnF,UAAN,CAAiB,UAAjB,CAAH,EAAiC;AAC/B,cAAGmF,KAAK,KAAK,WAAb,EAA0B,MAAMtC,YAAN;AAC1B,cAAI8C,KAAK,GAAGR,KAAK,CAACS,SAAN,CAAgB,CAAhB,EAAmBT,KAAK,CAAC7J,OAAN,CAAc,GAAd,CAAnB,EAAuCE,KAAvC,CAA6C,GAA7C,CAAZ;AACA,cAAGmK,KAAK,CAACzI,MAAN,GAAe,CAAlB,EAAqB,MAAM0F,aAAN;AACtB;;AACD,YAAGuC,KAAK,KAAK,GAAb,EAAkBC,EAAE,GAAGA,EAAE,CAACS,aAAH,IAAoBT,EAAzB;AAClB,eAAOtC,OAAO,CAACqC,KAAD,EAAQC,EAAR,CAAd;AACD;;AAED,UAAGE,EAAE,KAAKrG,WAAW,CAACqE,YAAnB,IAAmC6B,KAAK,CAAC7J,OAAN,CAAc,GAAd,IAAqB,CAAxD,IACC6J,KAAK,CAAC7J,OAAN,CAAc,GAAd,IAAqB,CADtB,IAC2B6J,KAAK,CAAC7J,OAAN,CAAc,GAAd,IAAqB,CADhD,IAEC6J,KAAK,CAAC7J,OAAN,CAAc,IAAd,IAAsB,CAF1B,EAE6B;AAC3B6J,aAAK,GAAGA,KAAK,CAAClE,OAAN,CAAc,aAAd,EAA6B,EAA7B,CAAR;AACAkE,aAAK,GAAGA,KAAK,CAAClE,OAAN,CAAc,SAAd,EAAyB,IAAzB,CAAR;AACAkE,aAAK,GAAGA,KAAK,CAAClE,OAAN,CAAc,SAAd,EAAyB,IAAzB,CAAR;AACAkE,aAAK,GAAG,yBAAuBA,KAAvB,GAA6B,GAArC;AACD;;AAED,UAAGG,EAAE,KAAKrG,WAAW,CAACkE,WAAnB,IAAkCgC,KAAK,CAAC7J,OAAN,CAAc,eAAd,IAAiC,CAAtE,EAAyE;AACvE6J,aAAK,GAAGA,KAAK,CAAClE,OAAN,CAAc,aAAd,EAA6B,EAA7B,CAAR;AACD;;AAED,UAAI5D,CAAJ;AAAA,UAAOyI,GAAP;AAAA,UAAYC,KAAK,GAAG,CAAC;AAAE3C,SAAC,EAAC,MAAJ;AAAY4C,cAAM,EAAC;AAAnB,OAAD,CAApB;AAAA,UACEC,IAAI,GAAG,SAAPA,IAAO,GAAW;AAAE,eAAOF,KAAK,CAACA,KAAK,CAAC7I,MAAN,GAAa,CAAd,CAAZ;AAA+B,OADrD;AAAA,UAEEgJ,GAAG,GAAG,SAANA,GAAM,CAASC,OAAT,EAAkB;AAAE,cAAM,IAAIxD,KAAJ,CAAU,CAACwD,OAAO,IAAE,EAAV,IAAgB,UAAhB,GAA6BC,IAAI,CAACC,SAAL,CAAeN,KAAf,CAA7B,GAAqD,SAArD,GAAiEK,IAAI,CAACC,SAAL,CAAeP,GAAf,CAAjE,GAAuF,GAAjG,CAAN;AAA8G,OAF1I;AAAA,UAGEQ,UAAU,GAAG,SAAbA,UAAa,GAAW;AAAER,WAAG,GAAG;AAAE1C,WAAC,EAAC,GAAJ;AAAShH,WAAC,EAAC;AAAX,SAAN;AAAwB,OAHpD;AAAA,UAIEmK,MAAM,GAAG,SAATA,MAAS,CAASnD,CAAT,EAAY;AACnB6C,YAAI,GAAGD,MAAP,CAAc1J,IAAd,CAAmB;AAAE8G,WAAC,EAAC,IAAJ;AAAUhH,WAAC,EAACgH;AAAZ,SAAnB;AACAkD,kBAAU;AACX,OAPH;AAAA,UAQEE,MAAM,GAAG,SAATA,MAAS,CAASC,GAAT,EAAcC,EAAd,EAAkBC,GAAlB,EAAuB;AAC9B,YAAG3D,kBAAkB,CAAC4D,WAAtB,EAAmC;AACjC,cAAIhD,GAAG,GAAGZ,kBAAkB,CAAC4D,WAAnB,CAA+BV,GAA/B,EAAoCO,GAApC,EAAyCC,EAAzC,EAA6CC,GAA7C,CAAV;;AACA,cAAG/C,GAAG,IAAIA,GAAG,CAACR,CAAJ,KAAU,UAApB,EAAgC;AAC9BqD,eAAG,GAAG7C,GAAG,CAAC6C,GAAV;AAAeC,cAAE,GAAG9C,GAAG,CAAC8C,EAAT;AAAaC,eAAG,GAAG/C,GAAG,CAAC+C,GAAV;AAAe/C,eAAG,GAAG,IAAN;AAC5C;;AAED,cAAG,OAAOA,GAAP,KAAe,WAAf,IAA8BA,GAAG,KAAK,IAAzC,EAA+C,OAAOA,GAAP;AAChD;;AACD,eAAO9B,eAAe,CAAC2E,GAAD,EAAMC,EAAN,EAAUC,GAAV,EAAelJ,MAAf,CAAtB;AACD,OAlBH;AAAA,UAmBEoJ,QAAQ,GAAG,SAAXA,QAAW,CAASb,MAAT,EAAiBc,OAAjB,EAA0B;AACnC,YAAIlD,GAAG,GAAG4C,MAAM,CACZR,MAAM,CAACc,OAAO,GAAG,CAAX,CADM,EAEZd,MAAM,CAACc,OAAD,CAFM,EAGZd,MAAM,CAACc,OAAO,GAAG,CAAX,CAHM,CAAhB;;AAKA,YAAG,OAAOlD,GAAP,KAAe,WAAf,IAA8BA,GAAG,KAAK,IAAzC,EAA+C;AAC7CoC,gBAAM,CAACe,MAAP,CAAcD,OAAd,EAAuB,CAAvB;AACAd,gBAAM,CAACc,OAAO,GAAG,CAAX,CAAN,GAAsB;AAAE1D,aAAC,EAAC8B,OAAO,CAACtB,GAAD,CAAX;AAAkBxH,aAAC,EAACwH;AAApB,WAAtB;AACD;AACF,OA7BH;AAAA,UA8BEoD,SAAS,GAAG,SAAZA,SAAY,GAAW;AAErB,YAAI3J,CAAJ,EAAO4J,CAAP,EAAUC,GAAV,EAAelB,MAAf;AACAA,cAAM,GAAGC,IAAI,GAAGD,MAAhB;;AACA,aAAIiB,CAAC,GAAC9E,aAAa,CAACjF,MAAd,GAAqB,CAA3B,EAA8B+J,CAAC,IAAE,CAAjC,EAAoC,EAAEA,CAAtC,EAAyC;AACvCC,aAAG,GAAG/E,aAAa,CAAC8E,CAAD,CAAnB;AACA5J,WAAC,GAAG,CAAJ;;AACA,iBAAMA,CAAC,GAAG2I,MAAM,CAAC9I,MAAP,GAAc,CAAxB,EAA2B;AACzB,gBAAG8I,MAAM,CAAC3I,CAAD,CAAN,CAAU+F,CAAV,KAAgB,IAAhB,IAAwB8D,GAAG,CAAC5L,OAAJ,CAAY0K,MAAM,CAAC3I,CAAD,CAAN,CAAUjB,CAAtB,MAA6B,CAAC,CAAzD,EAA4D;AAC1DyK,sBAAQ,CAACb,MAAD,EAAS3I,CAAT,CAAR;AACD,aAFD,MAEO,EAAEA,CAAF;AACR;AACF;AACF,OA3CH;AAAA,UA4CE8J,eAAe,GAAG,SAAlBA,eAAkB,GAAW;AAC3B,YAAIC,IAAI,GAAGtB,GAAG,CAAC1J,CAAf;AACA,YAAIiL,SAAJ;;AACA,YAAG,CAAC,UAAD,EAAaC,QAAb,CAAsBrB,IAAI,GAAG7J,CAA7B,CAAH,EAAoC;AAClCiL,mBAAS,GAAGvE,OAAO,CAACsE,IAAD,CAAnB;AACD,SAFD,MAEO;AACL,cAAG9B,EAAE,GAAG,CAAL,IAAWQ,GAAG,CAAC1J,CAAJ,CAAMd,OAAN,CAAc,aAAd,KAAgC,CAAhC,IACZyK,KAAK,CAAC7I,MAAN,KAAiB,CADL,IACU,CAAC,oBAAoB6G,IAApB,CAAyB+B,GAAG,CAAC1J,CAA7B,CADzB,EAC2D;AACzDiL,qBAAS,GAAGnL,OAAO,CAAC4G,OAAO,CAACsE,IAAD,CAAR,CAAnB;AACD,WAHD,MAGO;AACL,gBAAGA,IAAI,CAACpH,UAAL,CAAgB,GAAhB,CAAH,EAAyB;AACvBqH,uBAAS,GAAGD,IAAZ;AACD,aAFD,MAEO;AACLC,uBAAS,GAAGnE,gBAAgB,CAACJ,OAAO,CAACsE,IAAD,CAAR,CAA5B;AACD;AACF;AACF;;AACDnB,YAAI,GAAGD,MAAP,CAAc1J,IAAd,CAAmB+K,SAAnB;AACAf,kBAAU;AACX,OA/DH;AAAA,UAgEEiB,QAAQ,GAAG,SAAXA,QAAW,GAAW;AACpB,eAAOpC,KAAK,CAACqC,MAAN,CAAanK,CAAC,GAAC,CAAf,CAAP;AACD,OAlEH;AAAA,UAmEEoK,WAAW,GAAG,SAAdA,WAAc,GAAW;AACvB3B,WAAG,CAAC1J,CAAJ,GAAQsL,UAAU,CAAC5B,GAAG,CAAC7H,MAAL,CAAlB;AACAgI,YAAI,GAAGD,MAAP,CAAc1J,IAAd,CAAmBwJ,GAAnB;AACAQ,kBAAU;AACX,OAvEH;AAAA,UAwEEqB,SAAS,GAAG,SAAZA,SAAY,GAAW;AACrB,YAAIC,MAAM,GAAG3B,IAAI,GAAGD,MAApB;AACA,eAAO4B,MAAM,CAACA,MAAM,CAAC1K,MAAP,GAAgB,CAAjB,CAAb;AACD,OA3EH;AAAA,UA4EE2K,KAAK,GAAG,SAARA,KAAQ,CAASC,CAAT,EAAY;AAClB,eAAOA,CAAC,IAAI,GAAL,IAAYA,CAAC,IAAI,GAAxB;AACD,OA9EH;;AAgFAxB,gBAAU;;AAEV,WAAIjJ,CAAC,GAAC,CAAN,EAASA,CAAC,GAAC8H,KAAK,CAACjI,MAAjB,EAAyB,EAAEG,CAA3B,EAA8B;AAC5B,YAAIyK,CAAC,GAAG3C,KAAK,CAACqC,MAAN,CAAanK,CAAb,CAAR;;AACA,YAAGyI,GAAG,CAACiC,EAAP,EAAW;AACTjC,aAAG,CAAC1J,CAAJ,IAAS0L,CAAT;AACA,cAAGA,CAAC,KAAK,GAAT,EAAc,EAAEhC,GAAG,CAACiC,EAAN,CAAd,KACK,IAAGD,CAAC,KAAK,GAAT,EAAc,EAAEhC,GAAG,CAACiC,EAAN;AACnB;AACD;;AACD,YAAGjC,GAAG,CAAC1C,CAAJ,KAAU,KAAb,EAAoB;AAClB,cAAG0E,CAAC,KAAKhC,GAAG,CAACb,KAAb,EAAoB;AAClBgB,gBAAI,GAAGD,MAAP,CAAc1J,IAAd,CAAmBwJ,GAAnB;AACAQ,sBAAU;AACX,WAHD,MAGOR,GAAG,CAAC1J,CAAJ,IAAS0L,CAAT;;AACP;AACD;;AACD,YAAGhC,GAAG,CAAC1C,CAAJ,KAAU,KAAb,EAAoB;AAClB,cAAGhB,KAAK,CAAC2B,IAAN,CAAW+D,CAAX,KAAiB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgBR,QAAhB,CAAyBQ,CAAzB,CAAjB,IACEA,CAAC,KAAK,GAAN,IAAa3C,KAAK,CAAC9H,CAAC,GAAC,CAAH,CAAL,KAAe,GADjC,EACuC;AACrCyI,eAAG,CAAC7H,MAAJ,IAAc6J,CAAd;AACA;AACD,WAJD,MAIO,IAAGA,CAAC,KAAK,GAAN,IAAahC,GAAG,CAAC7H,MAAJ,KAAe,GAA/B,EAAoC;AACzC;AACD,WAFM,MAEA,IAAG6J,CAAC,KAAK,GAAN,IAAa,CAAChC,GAAG,CAACkC,OAArB,EAA8B;AACnClC,eAAG,CAACkC,OAAJ,GAAc,CAAd;AACAlC,eAAG,CAAC7H,MAAJ,IAAc6J,CAAd;AACD,WAHM,MAGAL,WAAW;AACnB;;AACD,YAAGI,KAAK,CAACC,CAAD,CAAR,EAAa;AACX,cAAGhC,GAAG,CAAC1J,CAAJ,KAAU,EAAb,EAAiB;AACf0J,eAAG,GAAG;AAAE1C,eAAC,EAAC,KAAJ;AAAWnF,oBAAM,EAAC6J;AAAlB,aAAN;AACD,WAFD,MAEOhC,GAAG,CAAC1J,CAAJ,IAAS0L,CAAT;AACR,SAJD,MAIO,QAAOA,CAAP;AACL,eAAK,GAAL;AACA,eAAK,GAAL;AACE,gBAAGhC,GAAG,CAAC1J,CAAJ,KAAU,EAAb,EAAiB;AACf0J,iBAAG,GAAG;AAAE1C,iBAAC,EAAC,KAAJ;AAAW6B,qBAAK,EAAC6C,CAAjB;AAAoB1L,iBAAC,EAAC;AAAtB,eAAN;AACD,aAFD,MAEO8J,GAAG,CAAC,6BAA6B4B,CAA9B,CAAH;;AACP;;AACF,eAAK,GAAL;AACEhC,eAAG,CAAC1C,CAAJ,GAAQ,IAAR;AACA0C,eAAG,CAACE,MAAJ,GAAa,EAAb;AACAD,iBAAK,CAACzJ,IAAN,CAAWwJ,GAAX;;AACA,gBAAGA,GAAG,CAAC1J,CAAJ,KAAU,MAAb,EAAqB;AACnBkK,wBAAU;AACVR,iBAAG,CAAC1J,CAAJ,GAAQ,GAAR;AACA+K,6BAAe;AAChB;;AACDb,sBAAU;AAEV;;AACF,eAAK,GAAL;AACE,gBAAGiB,QAAQ,OAAO,GAAlB,EAAuB;AAErB,kBAAIU,IAAI,GAAGlC,KAAK,CAACmC,GAAN,EAAX;AACAD,kBAAI,CAAC7L,CAAL,GAAS6L,IAAI,CAAC7L,CAAL,GAAS,GAAT,GAAe0J,GAAG,CAAC1J,CAAnB,GAAuB0L,CAAhC;AACAG,kBAAI,CAAC7E,CAAL,GAAS,GAAT;AACA0C,iBAAG,GAAGmC,IAAN;AACA;AACD;;AAED,gBAAGnC,GAAG,CAAC1J,CAAJ,KAAU,EAAb,EAAiB+K,eAAe;AAChCH,qBAAS;AACTlB,eAAG,GAAGC,KAAK,CAACmC,GAAN,EAAN;AACA,gBAAGpC,GAAG,CAAC1C,CAAJ,KAAU,IAAb,EAAmB8C,GAAG;;AACtB,gBAAGJ,GAAG,CAAC1J,CAAP,EAAU;AACR,kBAAI+L,kBAAkB,GAAG7C,EAAzB;;AACA,kBAAGA,EAAE,KAAKrG,WAAW,CAACqE,YAAtB,EAAoC;AAClC,oBAAGhB,kBAAkB,CAACyB,IAAnB,CAAwBoB,KAAxB,KAAkC,CAAC3C,qBAAqB,CAACuB,IAAtB,CAA2BoB,KAA3B,CAAtC,EAAyEgD,kBAAkB,GAAGlJ,WAAW,CAACkE,WAAjC;AACzE,oBAAGZ,kBAAkB,CAACwB,IAAnB,CAAwBoB,KAAxB,CAAH,EAAmCgD,kBAAkB,GAAGlJ,WAAW,CAACqE,YAAjC;;AACnC,oBAAGb,UAAU,CAACsB,IAAX,CAAgBoB,KAAhB,KAA0BW,GAAG,CAAC1C,CAAJ,KAAU,IAApC,IAA4C,qBAAqBW,IAArB,CAA0B+B,GAAG,CAAC1J,CAA9B,CAA/C,EAAiF;AAC/E+L,oCAAkB,GAAGlJ,WAAW,CAAC6E,WAAjC;AACD;AACF;;AACD,kBAAIF,GAAG,GAAGU,MAAM,CAACwB,GAAG,CAAC1J,CAAL,EAAQ0J,GAAG,CAACE,MAAZ,EAAoBmC,kBAApB,CAAhB;AACA,kBAAGrC,GAAG,CAAC1J,CAAJ,KAAU,MAAV,IAAoBwH,GAAG,CAACR,CAAJ,KAAU,KAA9B,IAAuCQ,GAAG,CAACxH,CAAJ,CAAMc,MAAN,GAAe,CAAzD,EACE0G,GAAG,CAACxH,CAAJ,GAAQ,CAACwH,GAAG,CAACxH,CAAJ,CAAM,CAAN,CAAD,CAAR;AACF6J,kBAAI,GAAGD,MAAP,CAAc1J,IAAd,CAAmBsH,GAAnB;AACD,aAbD,MAaO;AACL,kBAAGkC,GAAG,CAACE,MAAJ,CAAW9I,MAAX,KAAsB,CAAzB,EAA4BgJ,GAAG;AAC/BD,kBAAI,GAAGD,MAAP,CAAc1J,IAAd,CAAmBwJ,GAAG,CAACE,MAAJ,CAAW,CAAX,CAAnB;AACD;;AACDM,sBAAU;AACV;;AACF,eAAK,GAAL;AACE,gBAAGR,GAAG,CAAC1J,CAAJ,KAAU,EAAb,EAAiB+K,eAAe;AAChC,gBAAGlB,IAAI,GAAG7C,CAAP,KAAa,IAAhB,EAAsB8C,GAAG;AACzB;;AACF,eAAK,GAAL;AACE,gBAAG4B,CAAC,KAAK,GAAN,KAAchC,GAAG,CAAC1J,CAAJ,KAAU,EAAV,IAAgB6J,IAAI,GAAGD,MAAP,CAAc9I,MAAd,KAAyB,CAAvD,CAAH,EAA8D;AAC5D4I,iBAAG,CAAC1J,CAAJ,IAAS0L,CAAT;AACA,kBAAGhC,GAAG,CAAC1J,CAAJ,KAAU,KAAb,EAAoB+K,eAAe;AACpC,aAHD,MAGO,IAAGrB,GAAG,CAAC1J,CAAJ,KAAU,EAAV,KACP,CAAC,GAAD,EAAM,EAAN,EAAUkL,QAAV,CAAmBC,QAAQ,EAA3B,KACDpC,KAAK,CAACS,SAAN,CAAgBvI,CAAC,GAAC,CAAlB,EAAqB+K,IAArB,OAAgC,GAFxB,CAAH,EAEiC;AACtCtC,iBAAG,CAAC1J,CAAJ,GAAQ0L,CAAR;AACAX,6BAAe;AAChB,aALM,MAKA;AACLZ,oBAAM,CAACuB,CAAD,CAAN;AACD;;AACD;;AACF,eAAK,GAAL;AACE,gBAAIO,IAAI,GAAGV,SAAS,EAApB;;AACA,gBAAG7B,GAAG,CAAC1J,CAAJ,KAAU,EAAV,IAAgBmL,QAAQ,OAAO,GAA/B,IAAsCpC,KAAK,CAACqC,MAAN,CAAanK,CAAC,GAAC,CAAf,MAAsB,GAA/D,EAAoE;AAElEyI,iBAAG,CAAC1J,CAAJ,IAAS0L,CAAT;AACD,aAHD,MAGO,IAAI7B,IAAI,GAAGD,MAAP,CAAc9I,MAAd,KAAyB,CAAzB,IAA8B4I,GAAG,CAAC1J,CAAJ,KAAU,EAAzC,IACPiM,IAAI,IAAIA,IAAI,CAACjF,CAAL,KAAW,IADZ,IAGPiF,IAAI,IAAIA,IAAI,CAACjF,CAAL,KAAW,KAAnB,IAA4B2C,KAAK,CAAC7I,MAAN,GAAe,CAA3C,IAAgD6I,KAAK,CAAC,CAAD,CAAL,CAAS3C,CAAT,KAAe,IAHxD,IAKPiF,IAAI,IAAIA,IAAI,CAACjF,CAAL,KAAW,KAAnB,IAA4ByE,KAAK,CAACN,QAAQ,EAAT,CAL7B,EAK4C;AAEjDzB,iBAAG,GAAG;AAAE1C,iBAAC,EAAC,KAAJ;AAAWnF,sBAAM,EAAC;AAAlB,eAAN;AACD,aARM,MAQA;AACL,kBAAG6H,GAAG,CAAC1J,CAAJ,KAAU,EAAb,EAAiB;AACf,oBAAG,CAACgG,KAAK,CAAC2B,IAAN,CAAW+B,GAAG,CAAC1J,CAAf,CAAD,IAAsB+I,KAAK,CAAC9H,CAAC,GAAC,CAAH,CAAL,KAAe,GAAxC,EAA6C,MAAMqF,YAAN;AAC7CuD,oBAAI,GAAGD,MAAP,CAAc1J,IAAd,CAAmBwJ,GAAnB;AACD;;AACDS,oBAAM,CAACuB,CAAD,CAAN;AACD;;AACD;;AACF,eAAK,GAAL;AACE,gBAAGhC,GAAG,CAAC1J,CAAJ,KAAU,GAAV,IAAiB0J,GAAG,CAAC1J,CAAJ,KAAU,MAA3B,IACC0J,GAAG,CAAC1J,CAAJ,KAAU,GADX,IACkB0J,GAAG,CAAC1J,CAAJ,KAAU,MAD5B,IACsC0J,GAAG,CAAC1J,CAAJ,KAAU,GADnD,EACwD;AACtD0J,iBAAG,CAAC1J,CAAJ,IAAS0L,CAAT;;AACA,sBAAOhC,GAAG,CAAC1J,CAAX;AACE,qBAAK,IAAL;AAAW,qBAAK,OAAL;AAAcmK,wBAAM,CAAC,IAAD,CAAN;AAAc;;AACvC,qBAAK,IAAL;AAAW,qBAAK,OAAL;AAAcA,wBAAM,CAAC,IAAD,CAAN;AAAc;;AACvC,qBAAK,IAAL;AAAyBA,wBAAM,CAAC,IAAD,CAAN;AAAc;AAHzC;AAKD,aARD,MAQO;AACL,kBAAGT,GAAG,CAAC1J,CAAP,EAAU+K,eAAe;AACzBZ,oBAAM,CAACuB,CAAD,CAAN;AACD;;AACD;;AACF,eAAK,GAAL;AACE,oBAAOhC,GAAG,CAAC1J,CAAX;AACE,mBAAK,KAAL;AAAY0J,mBAAG,CAAC1J,CAAJ,GAAQ,EAAR;AAAY0L,iBAAC,GAAG,GAAJ;AAAS;;AACjC,mBAAK,KAAL;AAAYhC,mBAAG,CAAC1J,CAAJ,GAAQ,EAAR;AAAY0L,iBAAC,GAAG,GAAJ;AAAS;;AACjC;AAAShC,mBAAG,CAAC1J,CAAJ,IAAS0L,CAAT;AAAY;AAHvB;;AAMF,eAAK,GAAL;AACA,eAAK,GAAL;AACE,gBAAGhC,GAAG,CAAC1J,CAAP,EAAU+K,eAAe;;AACzB,gBAAGI,QAAQ,OAAO,GAAlB,EAAuB;AACrBzB,iBAAG,CAAC1J,CAAJ,GAAQ0L,CAAR;AAAW;AACZ;;AAEH,eAAK,GAAL;AACEvB,kBAAM,CAACuB,CAAD,CAAN;AACA;;AACF,eAAK,GAAL;AACE,oBAAOhC,GAAG,CAAC1J,CAAX;AACE,mBAAK,EAAL;AAAS;;AACT,mBAAK,KAAL;AAAYmK,sBAAM,CAAC,GAAD,CAAN;AAAa;;AACzB,mBAAK,KAAL;AAAYA,sBAAM,CAAC,GAAD,CAAN;AAAa;;AACzB,mBAAK,KAAL;AAAYA,sBAAM,CAAC,GAAD,CAAN;AAAa;;AACzB,mBAAK,IAAL;AAAYA,sBAAM,CAAC,GAAD,CAAN;AAAa;;AACzB;AAAS;AACP,sBAAIG,EAAE,GAAGZ,GAAG,CAAC1J,CAAJ,CAAMkM,WAAN,EAAT;AACA,sBAAG,qBAAqBvE,IAArB,CAA0B2C,EAA1B,CAAH,EAAkC,MAAMhE,YAAN;AAClC,sBAAG,CAACL,aAAa,CAAC0B,IAAd,CAAmB+B,GAAG,CAAC1J,CAAvB,CAAJ,EAA+B+K,eAAe;AAC/C;AAVH;;AAYA;;AACF,eAAK,GAAL;AACErB,eAAG,CAACiC,EAAJ,GAAS,CAACjC,GAAG,CAACiC,EAAJ,IAAU,CAAX,IAAgB,CAAzB;;AAEF,eAAK,GAAL;AACE,gBAAGjC,GAAG,CAAC1J,CAAJ,KAAU,EAAV,IAAgBmL,QAAQ,OAAO,GAAlC,EAAuC;AACrCzB,iBAAG,CAAC1J,CAAJ,GAAQ0L,CAAR;AACAX,6BAAe;AACf;AACD;;AACD,gBAAGrB,GAAG,CAAC1J,CAAJ,KAAU,EAAV,IAAgByL,KAAK,CAACN,QAAQ,EAAT,CAAxB,EAAsC;AACpCzB,iBAAG,GAAG;AAAE1C,iBAAC,EAAC,KAAJ;AAAWnF,sBAAM,EAAC6J;AAAlB,eAAN;AACA;AACD;;AAEH;AACEhC,eAAG,CAAC1J,CAAJ,IAAS0L,CAAT;AAtJG;AAwJR;;AACD,UAAGhC,GAAG,CAAC1C,CAAJ,KAAU,KAAb,EAAoBqE,WAAW;AAC/B,UAAG3B,GAAG,CAAC1C,CAAJ,KAAU,GAAV,IAAiB0C,GAAG,CAAC1J,CAAJ,KAAU,EAA9B,EAAkC+K,eAAe;AACjD,UAAGrB,GAAG,CAAC1C,CAAJ,KAAU,GAAV,IAAiB0C,GAAG,CAAC1J,CAAJ,KAAU,EAA3B,IAAkC0J,GAAG,CAACE,MAAJ,IAAcF,GAAG,CAACE,MAAJ,CAAW9I,MAA9D,EAAuEgJ,GAAG,CAAC,6BAAD,CAAH;AACvE,UAAGH,KAAK,CAAC7I,MAAN,GAAe,CAAlB,EAAqBgJ,GAAG,CAAC,sBAAD,CAAH;AACrB,UAAGH,KAAK,CAAC,CAAD,CAAL,CAAS3C,CAAT,KAAe,MAAlB,EAA0B8C,GAAG,CAAC,uBAAD,CAAH;AAC1B,UAAGH,KAAK,CAAC,CAAD,CAAL,CAASC,MAAT,CAAgB9I,MAAhB,KAA2B,CAA9B,EAAiCgJ,GAAG,CAAC,YAAD,CAAH;AACjC,UAAGH,KAAK,CAAC,CAAD,CAAL,CAASC,MAAT,CAAgB9I,MAAhB,IAA0B,CAA7B,EAAgC8J,SAAS;AACzC,UAAGjB,KAAK,CAAC,CAAD,CAAL,CAASC,MAAT,CAAgB9I,MAAhB,GAAyB,CAA5B,EAA+BgJ,GAAG,CAAC,kBAAD,CAAH;AAC/B,aAAOvC,gBAAgB,CAACoC,KAAK,CAAC,CAAD,CAAL,CAASC,MAAT,CAAgB,CAAhB,CAAD,EAAqBV,EAArB,CAAvB;AACD,KAxUD;AAyUD,GA/bD;;AAicAzJ,QAAM,CAACC,OAAP,GAAiByB,sBAAjB;;;;;;;;;;;;;;;;;ACneA,MAAIgL,SAAS,GAAG,UAAhB;AACA,MAAIC,MAAM,GAAG,KAAb;;AAWA,WAAS7G,OAAT,CAAiB8G,KAAjB,EAAwBC,IAAxB,EAA8B;AAC5B,QAAIC,GAAJ;AACA,QAAInM,MAAM,GAAG,EAAb;;AAEA,QAAG,OAAOkM,IAAP,KAAgB,WAAnB,EAA+B;AAC7B,UAAG,CAAChE,MAAM,CAACkE,SAAP,CAAiBF,IAAjB,CAAJ,EAA4B;AAC1B,cAAM,IAAI/F,KAAJ,CAAU,0CAAV,CAAN;AACD;;AACD,UAAIkG,GAAG,GAAG,IAAIC,MAAJ,CAAWJ,IAAX,CAAV;AACAC,SAAG,GAAGE,GAAG,CAACE,SAAJ,CAAcC,IAAd,CAAmBH,GAAnB,CAAN;AACD,KAND,MAMO;AACLF,SAAG,GAAGhN,IAAI,CAACsN,MAAX;AACD;;AAED,SAAK,IAAI5L,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoL,KAAK,CAACvL,MAA1B,EAAkC,EAAEG,CAApC,EAAuC;AACrC,UAAI4J,CAAC,GAAGtL,IAAI,CAAC8F,KAAL,CAAWkH,GAAG,MAAMtL,CAAC,GAAG,CAAV,CAAd,CAAR;;AACA,UAAG4J,CAAC,KAAK5J,CAAT,EAAY;AACVb,cAAM,CAACa,CAAD,CAAN,GAAYb,MAAM,CAACyK,CAAD,CAAlB;AACD;;AACDzK,YAAM,CAACyK,CAAD,CAAN,GAAYwB,KAAK,CAACpL,CAAD,CAAjB;AACD;;AACD,WAAOb,MAAP;AACD;;AAQD,WAASsM,MAAT,CAAgBJ,IAAhB,EAAsB;AAClB,SAAKQ,KAAL,GAAaR,IAAI,GAAGH,SAApB;;AACH,QAAG,KAAKW,KAAL,IAAc,CAAjB,EAAoB;AACnB,WAAKA,KAAL,IAAeX,SAAS,GAAG,CAA3B;AACA;AACD;;AAKDO,QAAM,CAACnI,SAAP,CAAiBwI,IAAjB,GAAwB,YAAY;AAClC,SAAKD,KAAL,GAAa,KAAKA,KAAL,GAAaV,MAAb,GAAsBD,SAAnC;AACA,WAAO,KAAKW,KAAZ;AACD,GAHD;;AAQAJ,QAAM,CAACnI,SAAP,CAAiBoI,SAAjB,GAA6B,YAAY;AAErC,WAAO,CAAC,KAAKI,IAAL,KAAc,CAAf,KAAqBZ,SAAS,GAAG,CAAjC,CAAP;AACH,GAHD;;AAKA1M,QAAM,CAACC,OAAP,GAAiB6F,OAAjB;;;;;;;;;;;;;;;;;iBCjEyBrE,mBAAO,CAAC,CAAD,C;MAA3BX,gB,YAAAA,gB;;AAEL,WAASyM,SAAT,CAAmBjE,KAAnB,EAA0BC,EAA1B,EAA8B;AAC5B,QAAIiE,IAAI,GAAGlE,KAAK,CAACS,SAAN,CAAgB,EAAhB,CAAX;AACA,QAAI0D,WAAW,GAAG,EAAlB;AACA,QAAIC,MAAM,GAAG,EAAb;;AACA,QAAGnE,EAAE,CAACoE,UAAN,EAAkB;AAChB,WAAI,IAAIC,EAAE,GAAC,CAAX,EAAcA,EAAE,GAACrE,EAAE,CAACoE,UAAH,CAActM,MAA/B,EAAuCuM,EAAE,EAAzC,EAA6C;AAC3C,YAAIC,KAAK,GAAGtE,EAAE,CAACoE,UAAH,CAAcC,EAAd,CAAZ;AACA,YAAIE,KAAK,GAAGD,KAAK,CAACjE,YAAN,CAAmBmE,gBAAnB,CAAoCF,KAAK,CAACjN,IAA1C,CAAZ;;AACA,YAAGkN,KAAK,CAACE,QAAN,KAAmB,WAASR,IAA/B,EAAqC;AACnCE,gBAAM,CAACjN,IAAP,CAAYqN,KAAZ;AACAL,qBAAW,CAAChN,IAAZ,CAAiB;AACfuN,oBAAQ,EAAE,YADK;AAEfC,qBAAS,EAAET,IAFI;AAGfU,wBAAY,EAAEJ,KAAK,CAACK;AAHL,WAAjB;AAKD;AACF;AACF;;AACD,WAAOrN,gBAAgB,CAAC2M,WAAD,CAAvB;AACD;;AAED,WAASW,aAAT,CAAuB7E,EAAvB,EAA2B;AACzB,QAAI8E,UAAU,GAAG,EAAjB;AACA,QAAIC,aAAa,GAAG,EAApB;AACA,QAAIC,KAAK,GAAG,EAAZ;AACA,QAAIrK,IAAI,GAAGqF,EAAX;;AACA,WAAMrF,IAAN,EAAY;AACV,UAAGA,IAAI,CAACyJ,UAAR,EAAoB;AAClB,aAAI,IAAIvC,CAAC,GAAC,CAAV,EAAaA,CAAC,GAAClH,IAAI,CAACyJ,UAAL,CAAgBtM,MAA/B,EAAuC+J,CAAC,EAAxC,EAA4C;AAC1C,cAAIoD,IAAI,GAAGtK,IAAI,CAACyJ,UAAL,CAAgBvC,CAAhB,CAAX;AACA,cAAIqD,IAAI,GAAGD,IAAI,CAAC5E,YAAL,CAAkBmE,gBAAlB,CAAmCS,IAAI,CAAC5N,IAAxC,CAAX;;AACA,cAAG6N,IAAI,CAACT,QAAL,CAAc7J,UAAd,CAAyB,OAAzB,KAAqC,CAACmK,aAAa,CAACG,IAAI,CAACT,QAAN,CAAtD,EAAuE;AACrE,gBAAIU,KAAK,GAAGD,IAAI,CAACT,QAAL,CAAcrO,KAAd,CAAoB,GAApB,CAAZ;AACA2O,yBAAa,CAACG,IAAI,CAACT,QAAN,CAAb,GAA+BS,IAAI,CAACT,QAApC;;AACA,gBAAGS,IAAI,CAACN,SAAL,CAAe9M,MAAlB,EAA0B;AACxBkN,mBAAK,CAAC9N,IAAN,CAAWgO,IAAX;AACAJ,wBAAU,CAAC5N,IAAX,CAAgB;AACduN,wBAAQ,EAAE,YADI;AAEdC,yBAAS,EAAES,KAAK,CAACrN,MAAN,GAAe,CAAf,GAAmBqN,KAAK,CAAC,CAAD,CAAxB,GAA8B,EAF3B;AAGdR,4BAAY,EAAEO,IAAI,CAACN;AAHL,eAAhB;AAKD;AACF;AACF;AACF;;AACDjK,UAAI,GAAGqF,EAAE,CAACI,QAAH,KAAgB,CAAhB,GAAoBzF,IAAI,CAACyK,UAAzB,GAAsC,IAA7C;AACD;;AACD,QAAGN,UAAU,CAAChN,MAAX,GAAoB,CAApB,IAAyB,CAACiN,aAAa,CAACM,KAA3C,EAAkD;AAChDP,gBAAU,CAAC5N,IAAX,CAAgB;AAACuN,gBAAQ,EAAE,YAAX;AAAyBC,iBAAS,EAAE,OAApC;AAA6CC,oBAAY,EAAE;AAA3D,OAAhB;AACD;;AACD,QAAGG,UAAU,CAAChN,MAAX,GAAoB,CAApB,IAAyB,CAACiN,aAAa,CAACO,GAA3C,EAAgD;AAC9CR,gBAAU,CAAC5N,IAAX,CAAgB;AAACuN,gBAAQ,EAAE,YAAX;AAAyBC,iBAAS,EAAE,KAApC;AAA2CC,oBAAY,EAAE;AAAzD,OAAhB;AACD;;AACDG,cAAU,GAAGA,UAAU,CAACS,IAAX,CAAgB,UAASC,EAAT,EAAaC,EAAb,EAAgB;AAC3C,UAAGD,EAAE,CAACd,SAAH,GAAee,EAAE,CAACf,SAArB,EAA+B;AAAE,eAAO,CAAC,CAAR;AAAW;;AAC5C,UAAGc,EAAE,CAACd,SAAH,GAAee,EAAE,CAACf,SAArB,EAA+B;AAAE,eAAO,CAAP;AAAU;;AAC3C,aAAO,CAAP;AACD,KAJY,CAAb;AAKA,WAAOnN,gBAAgB,CAACuN,UAAD,EAAa,CAAb,EAAgBE,KAAK,CAAC,CAAD,CAArB,CAAvB;AACD;;AAED,WAASxI,eAAT,CAAyBuD,KAAzB,EAAgC;AAC9B,WAAO,wCAAwCpB,IAAxC,CAA6CoB,KAA7C,KACF,eAAepB,IAAf,CAAoBoB,KAApB,CADL;AAED;;AAED,WAAStD,mBAAT,CAA6BsD,KAA7B,EAAoCC,EAApC,EAAwC;AACtC,QAAG,wCAAwCrB,IAAxC,CAA6CoB,KAA7C,CAAH,EAAwD;AACtD,aAAO8E,aAAa,CAAC7E,EAAD,CAApB;AACD;;AAED,QAAG,eAAerB,IAAf,CAAoBoB,KAApB,CAAH,EAA+B;AAC7B,aAAOiE,SAAS,CAACjE,KAAD,EAAQC,EAAR,CAAhB;AACD;AACF;;AAEDvJ,QAAM,CAACC,OAAP,GAAiB;AACf8F,mBAAe,EAAfA,eADe;AAEfC,uBAAmB,EAAnBA;AAFe,GAAjB;;;;;;;;;;;;;;;;;iBC9EmBvE,mBAAO,CAAC,CAAD,C;MAArBpC,U,YAAAA,U;;AAEL,WAAS4P,QAAT,CAAkBC,KAAlB,EAAyB;AACvB,QAAG,OAAOA,KAAP,KAAiB,QAApB,EAA8B;AAC5B,UAAIC,GAAG,GAAGD,KAAK,CAAC9J,OAAN,CAAc,OAAd,EAAuB,EAAvB,CAAV;AAEA,aAAO+J,GAAG,CAAC5C,IAAJ,GAAWlL,MAAX,IAAqB,CAACqI,KAAK,CAACyF,GAAG,CAAC5C,IAAJ,EAAD,CAAlC;AACD;;AACD,WAAO,OAAO2C,KAAP,KAAiB,QAAxB;AACD;;AAED,WAASjJ,eAAT,CAAyB2E,GAAzB,EAA8BC,EAA9B,EAAkCC,GAAlC,EAAuClJ,MAAvC,EAA+C;AAE7C,QAAGiJ,EAAE,CAACtK,CAAH,KAAS,GAAT,IAAgB0O,QAAQ,CAACrE,GAAG,CAACrK,CAAL,CAAxB,IAAmC0O,QAAQ,CAACnE,GAAG,CAACvK,CAAL,CAA9C,EAAuD;AACrDqK,SAAG,CAACrK,CAAJ,GAAQsI,MAAM,CAAC+B,GAAG,CAACrK,CAAL,CAAd;AACAuK,SAAG,CAACvK,CAAJ,GAAQsI,MAAM,CAACiC,GAAG,CAACvK,CAAL,CAAd;AACD;;AAGD,QAAGqK,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBqD,GAAG,CAACrK,CAAJ,CAAMc,MAAN,KAAiB,CAApC,IAAyCyJ,GAAG,CAACvD,CAAJ,KAAU,KAAtD,EAA6D;AAC3D,UAAI,+BAA+BW,IAA/B,CAAoC0C,GAAG,CAACrK,CAAJ,CAAM,CAAN,CAApC,CAAJ,EAAmD;AACjDqK,WAAG,GAAG;AAACrD,WAAC,EAAE,KAAJ;AAAWhH,WAAC,EAAElB,UAAU,CAACuL,GAAG,CAACrK,CAAJ,CAAM,CAAN,CAAD,EAAW,KAAX;AAAxB,SAAN;AACD;AACF;;AACD,QAAGuK,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvK,CAAJ,CAAMc,MAAN,KAAiB,CAApC,IAAyCuJ,GAAG,CAACrD,CAAJ,KAAU,KAAtD,EAA6D;AAC3D,UAAI,+BAA+BW,IAA/B,CAAoC4C,GAAG,CAACvK,CAAJ,CAAM,CAAN,CAApC,CAAJ,EAAmD;AACjDuK,WAAG,GAAG;AAACvD,WAAC,EAAE,KAAJ;AAAWhH,WAAC,EAAElB,UAAU,CAACyL,GAAG,CAACvK,CAAJ,CAAM,CAAN,CAAD,EAAW,KAAX;AAAxB,SAAN;AACD;AACF;;AAED,QAAGqK,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBqD,GAAG,CAACrK,CAAJ,CAAMc,MAAN,KAAiB,CAApC,IAAyCyJ,GAAG,CAACvD,CAAJ,KAAU,KAAtD,EAA6D;AAC3DqD,SAAG,GAAG;AAACrD,SAAC,EAAE,KAAJ;AAAWhH,SAAC,EAAEqK,GAAG,CAACrK,CAAJ,CAAM,CAAN;AAAd,OAAN;AACD;;AACD,QAAGuK,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvK,CAAJ,CAAMc,MAAN,KAAiB,CAApC,IAAyCuJ,GAAG,CAACrD,CAAJ,KAAU,KAAtD,EAA6D;AAC3DuD,SAAG,GAAG;AAACvD,SAAC,EAAE,KAAJ;AAAWhH,SAAC,EAAEuK,GAAG,CAACvK,CAAJ,CAAM,CAAN;AAAd,OAAN;AACD;;AACD,QAAGuK,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvK,CAAJ,CAAMc,MAAN,KAAiB,CAApC,IACDuJ,GAAG,CAACrD,CAAJ,KAAU,KADT,IACkBqD,GAAG,CAACrK,CAAJ,CAAMc,MAAN,KAAiB,CADtC,EACyC;AACvCuJ,SAAG,GAAG;AAACrD,SAAC,EAAE,KAAJ;AAAWhH,SAAC,EAAEqK,GAAG,CAACrK,CAAJ,CAAM,CAAN;AAAd,OAAN;AACAuK,SAAG,GAAG;AAACvD,SAAC,EAAE,KAAJ;AAAWhH,SAAC,EAAEuK,GAAG,CAACvK,CAAJ,CAAM,CAAN;AAAd,OAAN;AACD;;AAED,QAAGqK,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmB,4BAA4BW,IAA5B,CAAiC0C,GAAG,CAACrK,CAArC,CAAtB,EAA+D;AAC7DqK,SAAG,GAAG;AAACrD,SAAC,EAAE,KAAJ;AAAWhH,SAAC,EAAElB,UAAU,CAACuL,GAAG,CAACrK,CAAL,EAAQ,KAAR;AAAxB,OAAN;AACD;;AAED,QAAGuK,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmB,4BAA4BW,IAA5B,CAAiC4C,GAAG,CAACvK,CAArC,CAAtB,EAA+D;AAC7DuK,SAAG,GAAG;AAACvD,SAAC,EAAE,KAAJ;AAAWhH,SAAC,EAAElB,UAAU,CAACyL,GAAG,CAACvK,CAAL,EAAQ,KAAR;AAAxB,OAAN;AACD;;AAED,QAAGsK,EAAE,CAACtK,CAAH,KAAS,GAAT,KAAiBmJ,KAAK,CAACkB,GAAG,CAACrK,CAAL,CAAL,IAAgBmJ,KAAK,CAACoB,GAAG,CAACvK,CAAL,CAAtC,CAAH,EAAmD;AACjD,aAAO6O,GAAP;AACD;;AAED,QAAG,WAAWlH,IAAX,CAAgB2C,EAAE,CAACtK,CAAnB,CAAH,EAA0B;AACxB,UAAGqK,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvD,CAAJ,KAAU,MAAhC,EAAwC;AACtC,YAAGqD,GAAG,CAACrK,CAAJ,CAAMc,MAAN,GAAe,CAAf,IAAoBuJ,GAAG,CAACrK,CAAJ,KAAU,GAAjC,EAAsC;AACpCqK,aAAG,GAAG;AAACrD,aAAC,EAAE,MAAJ;AAAYhH,aAAC,EAAE;AAAf,WAAN;AACD,SAFD,MAEO,IAAGqK,GAAG,CAACrK,CAAJ,KAAU,EAAb,EAAiB;AACtBqK,aAAG,GAAG;AAACrD,aAAC,EAAE,MAAJ;AAAYhH,aAAC,EAAE;AAAf,WAAN;AACD,SAFM,MAEA;AACLqK,aAAG,GAAG;AAACrD,aAAC,EAAE,MAAJ;AAAYhH,aAAC,EAAE8O;AAAf,WAAN;AACD;AACF;;AACD,UAAGvE,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmBqD,GAAG,CAACrD,CAAJ,KAAU,MAAhC,EAAwC;AACtC,YAAGuD,GAAG,CAACvK,CAAJ,CAAMc,MAAN,GAAe,CAAf,IAAoByJ,GAAG,CAACvK,CAAJ,KAAU,GAAjC,EAAsC;AACpCuK,aAAG,GAAG;AAACvD,aAAC,EAAE,MAAJ;AAAYhH,aAAC,EAAE;AAAf,WAAN;AACD,SAFD,MAEO,IAAGuK,GAAG,CAACvK,CAAJ,KAAU,EAAb,EAAiB;AACtBuK,aAAG,GAAG;AAACvD,aAAC,EAAE,MAAJ;AAAYhH,aAAC,EAAE;AAAf,WAAN;AACD,SAFM,MAEA;AACLuK,aAAG,GAAG;AAACvD,aAAC,EAAE,MAAJ;AAAYhH,aAAC,EAAE8O;AAAf,WAAN;AACD;AACF;;AAED,UAAGzE,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvD,CAAJ,KAAU,MAAhC,EAAwC;AACtCqD,WAAG,GAAG;AAACrD,WAAC,EAAE,MAAJ;AAAYhH,WAAC,EAAE+O,OAAO,CAAC1E,GAAG,CAACrK,CAAL;AAAtB,SAAN;AACD;;AACD,UAAGuK,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmBqD,GAAG,CAACrD,CAAJ,KAAU,MAAhC,EAAwC;AACtCuD,WAAG,GAAG;AAACvD,WAAC,EAAE,MAAJ;AAAYhH,WAAC,EAAE+O,OAAO,CAACxE,GAAG,CAACvK,CAAL;AAAtB,SAAN;AACD;AACF;;AAED,YAAOsK,EAAE,CAACtK,CAAV;AACE,WAAK,GAAL;AAAW,eAAOqK,GAAG,CAACrK,CAAJ,GAAQuK,GAAG,CAACvK,CAAnB;;AACX,WAAK,GAAL;AAAW,eAAOqK,GAAG,CAACrK,CAAJ,GAAQuK,GAAG,CAACvK,CAAnB;;AACX,WAAK,GAAL;AAAW,eAAOqK,GAAG,CAACrK,CAAJ,GAAQuK,GAAG,CAACvK,CAAnB;;AACX,WAAK,GAAL;AAAW,eAAOqK,GAAG,CAACrK,CAAJ,GAAQuK,GAAG,CAACvK,CAAnB;;AACX,WAAK,GAAL;AAAW,eAAOqK,GAAG,CAACrK,CAAJ,GAAQuK,GAAG,CAACvK,CAAnB;;AACX,WAAK,GAAL;AACE,YAAG,cAAc2H,IAAd,CAAmB0C,GAAG,CAACrD,CAAvB,KAA6BuD,GAAG,CAACvD,CAAJ,KAAU,KAA1C,EAAiD;AAAC,iBAAOuD,GAAG,CAACvK,CAAJ,CAAMkL,QAAN,CAAeb,GAAG,CAACxI,MAAJ,IAAcwI,GAAG,CAACrK,CAAjC,CAAP;AAA4C;;AAC9F,YAAG,cAAc2H,IAAd,CAAmB4C,GAAG,CAACvD,CAAvB,KAA6BqD,GAAG,CAACrD,CAAJ,KAAU,KAA1C,EAAiD;AAAC,iBAAOqD,GAAG,CAACrK,CAAJ,CAAMkL,QAAN,CAAeX,GAAG,CAAC1I,MAAJ,IAAc0I,GAAG,CAACvK,CAAjC,CAAP;AAA4C;;AAC9F,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,MAAV,IAAoBuD,GAAG,CAACvD,CAAJ,KAAU,KAAjC,EAAwC;AAAC,iBAAOqD,GAAG,CAACrK,CAAJ,KAAUuK,GAAG,CAACvK,CAAJ,CAAMc,MAAN,GAAe,CAAhC;AAAmC;;AAC5E,YAAGyJ,GAAG,CAACvD,CAAJ,KAAU,MAAV,IAAoBqD,GAAG,CAACrD,CAAJ,KAAU,KAAjC,EAAwC;AAAC,iBAAOuD,GAAG,CAACvK,CAAJ,KAAUqK,GAAG,CAACrK,CAAJ,CAAMc,MAAN,GAAe,CAAhC;AAAmC;;AAE5E,eAAOuJ,GAAG,CAACrK,CAAJ,IAASuK,GAAG,CAACvK,CAApB;;AACF,WAAK,GAAL;AACE,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,MAAb,EAAqB;AACnB,cAAGqD,GAAG,CAACrK,CAAJ,KAAU,KAAV,IAAmBuK,GAAG,CAACvD,CAAJ,KAAU,KAA7B,IAAsCuD,GAAG,CAACvK,CAAJ,CAAMc,MAAN,GAAe,CAAxD,EAA2D,OAAO,IAAP;AAC3D,cAAGuJ,GAAG,CAACrK,CAAJ,KAAU,IAAV,IAAkBuK,GAAG,CAACvD,CAAJ,KAAU,KAA/B,EAAsC,OAAO,IAAIuD,GAAG,CAACvK,CAAf;AACtC,cAAGqK,GAAG,CAACrK,CAAJ,KAAU,KAAV,IAAmBuK,GAAG,CAACvD,CAAJ,KAAU,KAAhC,EAAuC,OAAO,IAAIuD,GAAG,CAACvK,CAAf;AACvC,cAAGqK,GAAG,CAACrK,CAAJ,KAAU,KAAV,IAAmBuK,GAAG,CAACvD,CAAJ,KAAU,MAAhC,EAAwC,OAAOuD,GAAG,CAACvK,CAAJ,KAAU,IAAjB;AACxC,iBAAO,KAAP;AACD;;AACD,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,MAAb,EAAqB;AACnB,cAAGuD,GAAG,CAACvK,CAAJ,KAAU,IAAV,IAAkBqK,GAAG,CAACrD,CAAJ,KAAU,KAA5B,IAAqCqD,GAAG,CAACrK,CAAJ,CAAMc,MAAN,KAAiB,CAAzD,EAA4D,OAAO,IAAP;AAC5D,cAAGyJ,GAAG,CAACvK,CAAJ,KAAU,IAAV,IAAkBqK,GAAG,CAACrD,CAAJ,KAAU,KAA5B,IAAqCqD,GAAG,CAACrK,CAAJ,GAAQ,CAAhD,EAAmD,OAAO,IAAP;AACnD,iBAAO,KAAP;AACD;;AAED,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBqD,GAAG,CAACrK,CAAJ,CAAMc,MAAN,GAAe,CAArC,EAAwC;AACtC,eAAI,IAAIkO,GAAG,GAAC,CAAZ,EAAcA,GAAG,GAAC3E,GAAG,CAACrK,CAAJ,CAAMc,MAAxB,EAA+BkO,GAAG,EAAlC,EAAsC;AACpC,gBAAG1G,MAAM,CAAC+B,GAAG,CAACrK,CAAJ,CAAMgP,GAAN,CAAD,CAAN,GAAqBzE,GAAG,CAACvK,CAA5B,EAA+B,OAAO,IAAP;AAChC;;AACD,iBAAO,KAAP;AACD;;AACD,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvK,CAAJ,CAAMc,MAAN,GAAe,CAArC,EAAwC;AACtC,eAAI,IAAImO,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC1E,GAAG,CAACvK,CAAJ,CAAMc,MAApB,EAA2BmO,CAAC,EAA5B,EAAgC;AAC9B,gBAAG5E,GAAG,CAACrK,CAAJ,GAAQsI,MAAM,CAACiC,GAAG,CAACvK,CAAJ,CAAMiP,CAAN,CAAD,CAAjB,EAA6B,OAAO,IAAP;AAC9B;;AACD,iBAAO,KAAP;AACD;;AACD,YAAG5E,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBqD,GAAG,CAACrK,CAAJ,CAAMc,MAAN,KAAe,CAArC,EAAwCuJ,GAAG,GAAE;AAACrD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACxC,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvK,CAAJ,CAAMc,MAAN,KAAe,CAArC,EAAwCyJ,GAAG,GAAE;AAACvD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACxC,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvD,CAAJ,KAAU,KAA7B,IAAsC3F,MAAM,CAAC1B,qBAAhD,EAAuE,OAAO0K,GAAG,CAACrK,CAAJ,GAAQuK,GAAG,CAACvK,CAAnB;AACvE,YAAG,CAAC0O,QAAQ,CAACrE,GAAG,CAACrK,CAAL,CAAT,IAAoB,CAAC0O,QAAQ,CAACnE,GAAG,CAACvK,CAAL,CAAhC,EAAyC,OAAO,KAAP;AACzC,eAAOqK,GAAG,CAACrK,CAAJ,GAAQuK,GAAG,CAACvK,CAAnB;;AACF,WAAK,GAAL;AACE,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,MAAb,EAAqB;AACnB,cAAGqD,GAAG,CAACrK,CAAJ,KAAU,IAAV,IAAkBuK,GAAG,CAACvD,CAAJ,KAAU,KAA5B,IAAqCuD,GAAG,CAACvK,CAAJ,CAAMc,MAAN,KAAiB,CAAzD,EAA4D,OAAO,IAAP;AAC5D,cAAGuJ,GAAG,CAACrK,CAAJ,KAAU,IAAV,IAAkBuK,GAAG,CAACvD,CAAJ,KAAU,KAA/B,EAAsC,OAAO,IAAIuD,GAAG,CAACvK,CAAf;AACtC,cAAGqK,GAAG,CAACrK,CAAJ,KAAU,IAAV,IAAkBuK,GAAG,CAACvD,CAAJ,KAAU,MAA/B,EAAuC,OAAO,KAAKuD,GAAG,CAACvK,CAAJ,KAAU,IAAV,GAAkB,CAAlB,GAAsB,CAA3B,CAAP;AACvC,iBAAO,KAAP;AACD;;AACD,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,MAAb,EAAqB;AACnB,cAAGuD,GAAG,CAACvK,CAAJ,KAAU,KAAV,IAAmBqK,GAAG,CAACrD,CAAJ,KAAU,KAA7B,IAAsCqD,GAAG,CAACrK,CAAJ,CAAMc,MAAN,GAAe,CAAxD,EAA2D,OAAO,IAAP;AAC3D,cAAGyJ,GAAG,CAACvK,CAAJ,KAAU,KAAV,IAAmBqK,GAAG,CAACrD,CAAJ,KAAU,KAAhC,EAAuC,OAAOqD,GAAG,CAACrK,CAAJ,GAAQ,CAAf;AACvC,cAAGuK,GAAG,CAACvK,CAAJ,KAAU,IAAV,IAAkBqK,GAAG,CAACrD,CAAJ,KAAU,KAA/B,EAAsC,OAAOqD,GAAG,CAACrK,CAAJ,GAAQ,CAAf;AACtC,cAAGqK,GAAG,CAACrD,CAAJ,KAAU,KAAb,EAAoB,OAAOqD,GAAG,CAACrK,CAAJ,GAAQuK,GAAG,CAACvK,CAAZ,KAAkB,IAAlB,GAAyB,CAAzB,GAA6B,CAApC;AACpB,iBAAO,KAAP;AACD;;AAED,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBqD,GAAG,CAACrK,CAAJ,CAAMc,MAAN,GAAe,CAArC,EAAwC;AACtC,eAAI,IAAI+J,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACR,GAAG,CAACrK,CAAJ,CAAMc,MAApB,EAA2B+J,CAAC,EAA5B,EAAgC;AAC9B,gBAAGvC,MAAM,CAAC+B,GAAG,CAACrK,CAAJ,CAAM6K,CAAN,CAAD,CAAN,GAAmBN,GAAG,CAACvK,CAA1B,EAA6B,OAAO,IAAP;AAC9B;;AACD,iBAAO,KAAP;AACD;;AACD,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvK,CAAJ,CAAMc,MAAN,GAAe,CAArC,EAAwC;AACtC,eAAI,IAAIoO,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC3E,GAAG,CAACvK,CAAJ,CAAMc,MAApB,EAA2BoO,CAAC,EAA5B,EAAgC;AAC9B,gBAAG7E,GAAG,CAACrK,CAAJ,GAAQsI,MAAM,CAACiC,GAAG,CAACvK,CAAJ,CAAMkP,CAAN,CAAD,CAAjB,EAA6B,OAAO,IAAP;AAC9B;;AACD,iBAAO,KAAP;AACD;;AAED,YAAG7E,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBqD,GAAG,CAACrK,CAAJ,CAAMc,MAAN,KAAe,CAArC,EAAwCuJ,GAAG,GAAE;AAACrD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACxC,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,MAAV,IAAoBqD,GAAG,CAACrK,CAAJ,KAAU,IAAjC,EAAuCqK,GAAG,GAAE;AAACrD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACvC,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,MAAV,IAAoBqD,GAAG,CAACrK,CAAJ,KAAU,KAAjC,EAAwCqK,GAAG,GAAE;AAACrD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACxC,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvK,CAAJ,CAAMc,MAAN,KAAe,CAArC,EAAwCyJ,GAAG,GAAE;AAACvD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACxC,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,MAAV,IAAoBuD,GAAG,CAACvK,CAAJ,KAAU,IAAjC,EAAuCuK,GAAG,GAAE;AAACvD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACvC,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,MAAV,IAAoBuD,GAAG,CAACvK,CAAJ,KAAU,KAAjC,EAAwCuK,GAAG,GAAE;AAACvD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACxC,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvD,CAAJ,KAAU,KAA7B,IAAsC3F,MAAM,CAAC1B,qBAAhD,EAAuE,OAAO0K,GAAG,CAACrK,CAAJ,GAAQuK,GAAG,CAACvK,CAAnB;AACvE,YAAG,CAAC0O,QAAQ,CAACrE,GAAG,CAACrK,CAAL,CAAT,IAAoB,CAAC0O,QAAQ,CAACnE,GAAG,CAACvK,CAAL,CAAhC,EAAyC,OAAO,KAAP;AACzC,eAAOqK,GAAG,CAACrK,CAAJ,GAAQuK,GAAG,CAACvK,CAAnB;;AACF,WAAK,IAAL;AACE,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvK,CAAJ,CAAMc,MAAN,KAAe,CAAlC,IAAuCuJ,GAAG,CAACxI,MAA3C,IAAqDwI,GAAG,CAACxI,MAAJ,CAAWf,MAAX,GAAkB,CAA1E,EAA6E,OAAO,KAAP;AAC7E,YAAGuJ,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBqD,GAAG,CAACrK,CAAJ,CAAMc,MAAN,KAAe,CAAlC,IAAuCyJ,GAAG,CAAC1I,MAA3C,IAAqD0I,GAAG,CAAC1I,MAAJ,CAAWf,MAAX,GAAkB,CAA1E,EAA6E,OAAO,KAAP;AAC7E,YAAGyJ,GAAG,CAACvD,CAAJ,KAAU,MAAV,IAAoBuD,GAAG,CAACvK,CAAJ,KAAU,KAA9B,IAAuCqK,GAAG,CAACrD,CAAJ,KAAU,KAAjD,IAA0DqD,GAAG,CAACrK,CAAJ,CAAMc,MAAN,GAAe,CAA5E,EAA+E,OAAO,KAAP;AAC/E,YAAGuJ,GAAG,CAACrD,CAAJ,KAAU,MAAb,EAAqBqD,GAAG,GAAG;AAACrD,WAAC,EAAE,KAAJ;AAAWhH,WAAC,EAAEqK,GAAG,CAACrK,CAAJ,KAAU,IAAV,GAAiB,CAAjB,GAAqB,CAAnC;AAAsC6B,gBAAM,EAAEwI,GAAG,CAACrK,CAAJ,KAAU,IAAV,GAAiB,GAAjB,GAAuB;AAArE,SAAN;AACrB,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,MAAb,EAAqBuD,GAAG,GAAG;AAACvD,WAAC,EAAE,KAAJ;AAAWhH,WAAC,EAAEuK,GAAG,CAACvK,CAAJ,KAAU,IAAV,GAAiB,CAAjB,GAAqB,CAAnC;AAAsC6B,gBAAM,EAAEwI,GAAG,CAACrK,CAAJ,KAAU,IAAV,GAAiB,GAAjB,GAAuB;AAArE,SAAN;;AAErB,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBqD,GAAG,CAACrK,CAAJ,CAAMc,MAAN,GAAe,CAArC,EAAwC;AACtC,eAAI,IAAIqO,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC9E,GAAG,CAACrK,CAAJ,CAAMc,MAApB,EAA2BqO,CAAC,EAA5B,EAAgC;AAC9B,gBAAG7G,MAAM,CAAC+B,GAAG,CAACrK,CAAJ,CAAMmP,CAAN,CAAD,CAAN,IAAoB5E,GAAG,CAACvK,CAA3B,EAA8B,OAAO,IAAP;AAC/B;;AACD,iBAAO,KAAP;AACD;;AACD,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvK,CAAJ,CAAMc,MAAN,GAAe,CAArC,EAAwC;AACtC,eAAI,IAAIsO,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAC7E,GAAG,CAACvK,CAAJ,CAAMc,MAApB,EAA2BsO,CAAC,EAA5B,EAAgC;AAC9B,gBAAG/E,GAAG,CAACrK,CAAJ,IAASsI,MAAM,CAACiC,GAAG,CAACvK,CAAJ,CAAMoP,CAAN,CAAD,CAAlB,EAA8B,OAAO,IAAP;AAC/B;;AACD,iBAAO,KAAP;AACD;;AAED,YAAG7E,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvK,CAAJ,CAAMc,MAAN,KAAe,CAArC,EAAwCyJ,GAAG,GAAE;AAACvD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACxC,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBqD,GAAG,CAACrK,CAAJ,CAAMc,MAAN,KAAe,CAArC,EAAwCuJ,GAAG,GAAE;AAACrD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACxC,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,MAAV,IAAoBqD,GAAG,CAACrK,CAAJ,KAAU,IAAjC,EAAuCqK,GAAG,GAAE;AAACrD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACvC,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,MAAV,IAAoBqD,GAAG,CAACrK,CAAJ,KAAU,KAAjC,EAAwCqK,GAAG,GAAE;AAACrD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACxC,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,MAAV,IAAoBuD,GAAG,CAACvK,CAAJ,KAAU,IAAjC,EAAuCuK,GAAG,GAAE;AAACvD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACvC,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,MAAV,IAAoBuD,GAAG,CAACvK,CAAJ,KAAU,KAAjC,EAAwCuK,GAAG,GAAE;AAACvD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACxC,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvD,CAAJ,KAAU,KAA7B,IAAsC3F,MAAM,CAAC1B,qBAAhD,EAAuE,OAAO0K,GAAG,CAACrK,CAAJ,IAASuK,GAAG,CAACvK,CAApB;AACvE,YAAG,CAAC0O,QAAQ,CAACrE,GAAG,CAACrK,CAAL,CAAT,IAAoB,CAAC0O,QAAQ,CAACnE,GAAG,CAACvK,CAAL,CAAhC,EAAyC,OAAO,KAAP;AACzC,eAAOqK,GAAG,CAACrK,CAAJ,IAASuK,GAAG,CAACvK,CAApB;;AACF,WAAK,IAAL;AAEE,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvK,CAAJ,CAAMc,MAAN,KAAe,CAAlC,IAAuCuJ,GAAG,CAACxI,MAA3C,IAAqDwI,GAAG,CAACxI,MAAJ,CAAWf,MAAX,GAAkB,CAA1E,EAA6E,OAAO,KAAP;AAC7E,YAAGyJ,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvK,CAAJ,CAAMc,MAAN,GAAe,CAAlC,IAAuCuJ,GAAG,CAACrK,CAAJ,KAAU,KAApD,EAA2D,OAAO,KAAP;;AAC3D,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBqD,GAAG,CAACrK,CAAJ,CAAMc,MAAN,KAAe,CAArC,EAAwC;AACtC,cAAGyJ,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvK,CAAJ,KAAU,EAAhC,EAAoC,OAAO,KAAP;AACpC,cAAGuK,GAAG,CAACvD,CAAJ,KAAU,KAAb,EAAoB,OAAOuD,GAAG,CAACvK,CAAJ,CAAMc,MAAN,IAAgB,CAAvB;AACpB,iBAAQyJ,GAAG,CAACvK,CAAJ,CAAMc,MAAN,IAAgB,CAAhB,IAAqByJ,GAAG,CAACvK,CAAJ,KAAU,KAAvC;AACD;;AAED,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,MAAb,EAAqBqD,GAAG,GAAG;AAACrD,WAAC,EAAE,KAAJ;AAAWhH,WAAC,EAAEqK,GAAG,CAACrK,CAAJ,KAAU,IAAV,GAAiB,CAAjB,GAAqB,CAAnC;AAAsC6B,gBAAM,EAAEwI,GAAG,CAACrK,CAAJ,KAAU,IAAV,GAAiB,GAAjB,GAAuB;AAArE,SAAN;AACrB,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,MAAb,EAAqBuD,GAAG,GAAG;AAACvD,WAAC,EAAE,KAAJ;AAAWhH,WAAC,EAAEuK,GAAG,CAACvK,CAAJ,KAAU,IAAV,GAAiB,CAAjB,GAAqB,CAAnC;AAAsC6B,gBAAM,EAAEwI,GAAG,CAACrK,CAAJ,KAAU,IAAV,GAAiB,GAAjB,GAAuB;AAArE,SAAN;;AAErB,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBqD,GAAG,CAACrK,CAAJ,CAAMc,MAAN,GAAa,CAAnC,EAAsC;AACpC,eAAI,IAAIuO,CAAC,GAAC,CAAV,EAAYA,CAAC,GAAChF,GAAG,CAACrK,CAAJ,CAAMc,MAApB,EAA2BuO,CAAC,EAA5B,EAAgC;AAC9B,gBAAG/G,MAAM,CAAC+B,GAAG,CAACrK,CAAJ,CAAMqP,CAAN,CAAD,CAAN,IAAoB9E,GAAG,CAACvK,CAA3B,EAA8B,OAAO,IAAP;AAC/B;;AACD,iBAAO,KAAP;AACD;;AAED,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvK,CAAJ,CAAMc,MAAN,GAAa,CAAnC,EAAsC;AACpC,eAAI,IAAIzB,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACkL,GAAG,CAACvK,CAAJ,CAAMc,MAApB,EAA2BzB,CAAC,EAA5B,EAAgC;AAC9B,gBAAGgL,GAAG,CAACrK,CAAJ,IAASsI,MAAM,CAACiC,GAAG,CAACvK,CAAJ,CAAMX,CAAN,CAAD,CAAlB,EAA8B,OAAO,IAAP;AAC/B;;AACD,iBAAO,KAAP;AACD;;AAED,YAAGgL,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBqD,GAAG,CAACrK,CAAJ,CAAMc,MAAN,KAAe,CAArC,EAAwCuJ,GAAG,GAAE;AAACrD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACxC,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,MAAV,IAAoBqD,GAAG,CAACrK,CAAJ,KAAU,IAAjC,EAAuCqK,GAAG,GAAE;AAACrD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACvC,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,MAAV,IAAoBqD,GAAG,CAACrK,CAAJ,KAAU,KAAjC,EAAwCqK,GAAG,GAAE;AAACrD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACxC,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvK,CAAJ,CAAMc,MAAN,KAAe,CAArC,EAAwCyJ,GAAG,GAAE;AAACvD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACxC,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,MAAV,IAAoBuD,GAAG,CAACvK,CAAJ,KAAU,IAAjC,EAAuCuK,GAAG,GAAE;AAACvD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AACvC,YAAGuK,GAAG,CAACvD,CAAJ,KAAU,MAAV,IAAoBuD,GAAG,CAACvK,CAAJ,KAAU,KAAjC,EAAwCuK,GAAG,GAAE;AAACvD,WAAC,EAAE,KAAJ;AAAWnF,gBAAM,EAAE,GAAnB;AAAwB7B,WAAC,EAAE;AAA3B,SAAL;AAExC,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvD,CAAJ,KAAU,KAA7B,IAAsC3F,MAAM,CAAC1B,qBAAhD,EAAuE,OAAO0K,GAAG,CAACrK,CAAJ,IAASuK,GAAG,CAACvK,CAApB;AACvE,YAAG,CAAC0O,QAAQ,CAACrE,GAAG,CAACrK,CAAL,CAAT,IAAoB,CAAC0O,QAAQ,CAACnE,GAAG,CAACvK,CAAL,CAAhC,EAAyC,OAAO,KAAP;AACzC,eAAOqK,GAAG,CAACrK,CAAJ,IAASuK,GAAG,CAACvK,CAApB;;AAEF,WAAK,IAAL;AACE,YAAGqK,GAAG,CAACrD,CAAJ,KAAU,MAAV,IAAoBuD,GAAG,CAACvD,CAAJ,KAAU,KAAjC,EAAwC;AAAC,iBAAOqD,GAAG,CAACrK,CAAJ,KAAUuK,GAAG,CAACvK,CAAJ,CAAMc,MAAN,GAAe,CAAhC;AAAmC;;AAC5E,YAAGyJ,GAAG,CAACvD,CAAJ,KAAU,MAAV,IAAoBqD,GAAG,CAACrD,CAAJ,KAAU,KAAjC,EAAwC;AAAC,iBAAOuD,GAAG,CAACvK,CAAJ,KAAUqK,GAAG,CAACrK,CAAJ,CAAMc,MAAN,GAAe,CAAhC;AAAmC;;AAE5E,eAAOuJ,GAAG,CAACrK,CAAJ,IAASuK,GAAG,CAACvK,CAApB;;AACF,WAAK,GAAL;AAAW,eAAO+O,OAAO,CAAC1E,GAAG,CAACrK,CAAJ,IAASuK,GAAG,CAACvK,CAAd,CAAd;;AACX,WAAK,GAAL;AAAW,eAAO+O,OAAO,CAAC1E,GAAG,CAACrK,CAAJ,IAASuK,GAAG,CAACvK,CAAd,CAAd;AA1Jb;AA4JD;;AAEDP,QAAM,CAACC,OAAP,GAAiB;AACfgG,mBAAe,EAAfA;AADe,GAAjB;;;;;;;;;;;;;;;;;iBChPgCxE,mBAAO,CAAC,CAAD,C;MAAlCrC,W,YAAAA,W;MAAaC,U,YAAAA,U;;AAElB,MAAI0H,aAAa,GAAG,IAAID,KAAJ,CAAU,eAAV,CAApB;AACA,MAAIE,YAAY,GAAG,IAAIF,KAAJ,CAAU,cAAV,CAAnB;AACA,MAAID,YAAY,GAAG,IAAIC,KAAJ,CAAU,cAAV,CAAnB;AAEA,MAAI+I,WAAW,GAAG,qOAAlB;;AAEA,WAAS3J,gBAAT,CAA0BoD,KAA1B,EAAiC;AAC/B,WAAOuG,WAAW,CAAC3H,IAAZ,CAAiBoB,KAAjB,CAAP;AACD;;AAED,WAASwG,eAAT,CAAyBpH,IAAzB,EAA+BqH,GAA/B,EAAoCC,GAApC,EAAyC;AACvC,QAAGD,GAAG,IAAI,IAAP,IAAerH,IAAI,CAACrH,MAAL,GAAc0O,GAAhC,EAAqC,MAAM/I,YAAN;AACrC,QAAGgJ,GAAG,IAAI,IAAP,IAAetH,IAAI,CAACrH,MAAL,GAAc2O,GAAhC,EAAqC,MAAMjJ,aAAN;AACtC;;AAED,WAASkJ,aAAT,CAAuBrP,IAAvB,EAA6B8H,IAA7B,EAAmC;AACjC,QAAG9H,IAAI,KAAK,MAAZ,EAAoB;AAClBkP,qBAAe,CAACpH,IAAD,EAAO,IAAP,EAAa,CAAb,CAAf;AACD,KAFD,MAEO,IAAG,sCAAsCR,IAAtC,CAA2CtH,IAA3C,CAAH,EAAqD;AAC1DkP,qBAAe,CAACpH,IAAD,EAAO,CAAP,EAAU,CAAV,CAAf;AACD,KAFM,MAEA,IAAG,kDAAkDR,IAAlD,CAAuDtH,IAAvD,CAAH,EAAiE;AACtEkP,qBAAe,CAACpH,IAAD,EAAO,IAAP,EAAa,CAAb,CAAf;AACD,KAFM,MAEA,IAAG9H,IAAI,KAAK,WAAZ,EAAyB;AAC9BkP,qBAAe,CAACpH,IAAD,EAAO,CAAP,EAAU,CAAV,CAAf;AACD,KAFM,MAEA,IAAG,4DAA4DR,IAA5D,CAAiEtH,IAAjE,CAAH,EAA2E;AAChFkP,qBAAe,CAACpH,IAAD,EAAO,CAAP,EAAU,CAAV,CAAf;AACD,KAFM,MAEA,IAAG9H,IAAI,KAAK,WAAZ,EAAyB;AAC9BkP,qBAAe,CAACpH,IAAD,EAAO,CAAP,EAAU,CAAV,CAAf;AACD;AACF;;AAED,WAASvC,oBAAT,CAA8BvF,IAA9B,EAAoC8H,IAApC,EAA0C;AACxC,QAAG9H,IAAI,KAAK,QAAT,IAAqB8H,IAAI,CAACrH,MAA7B,EAAqC;AACnC,UAAGqH,IAAI,CAAC,CAAD,CAAJ,CAAQnB,CAAR,KAAc,KAAjB,EAAwB;AACtBmB,YAAI,GAAG,CAAC;AAACnB,WAAC,EAAE,KAAJ;AAAWhH,WAAC,EAAEmI,IAAI,CAAC,CAAD,CAAJ,CAAQnI,CAAR,CAAU,CAAV;AAAd,SAAD,CAAP;AACD,OAFD,MAEO,IAAGmI,IAAI,CAAC,CAAD,CAAJ,CAAQnB,CAAR,KAAc,KAAd,IAAuBnI,WAAW,CAAC8I,IAAZ,CAAiBQ,IAAI,CAAC,CAAD,CAAJ,CAAQnI,CAAzB,CAA1B,EAAuD;AAC5DmI,YAAI,GAAG,CAAC;AAACnB,WAAC,EAAE,KAAJ;AAAWhH,WAAC,EAAElB,UAAU,CAACqJ,IAAI,CAAC,CAAD,CAAJ,CAAQnI,CAAT;AAAxB,SAAD,CAAP;AACD,OAFM,MAEA,IAAGmI,IAAI,CAAC,CAAD,CAAJ,CAAQnB,CAAR,KAAc,KAAd,IAAuBmB,IAAI,CAAC,CAAD,CAAJ,CAAQnI,CAAR,CAAUyE,QAAV,GAAqBvF,OAArB,CAA6B,IAA7B,IAAqC,CAA/D,EAAkE;AACvEiJ,YAAI,GAAG,CAAC;AAACnB,WAAC,EAAE,KAAJ;AAAWhH,WAAC,EAAE;AAAd,SAAD,CAAP;AACD;AACF;;AACD,QAAGK,IAAI,KAAK,MAAT,IAAmB8H,IAAI,CAACrH,MAAL,GAAc,CAApC,EAAuC,MAAM2F,YAAN;;AACvC,QAAGpG,IAAI,KAAK,eAAZ,EAA6B;AAC3B,UAAG8H,IAAI,CAACrH,MAAL,GAAc,CAAjB,EAAoB,MAAM0F,aAAN;AACpB,UAAG2B,IAAI,CAACrH,MAAL,KAAgB,CAAnB,EAAsB,MAAM2F,YAAN;AACtB,UAAG0B,IAAI,CAACrH,MAAL,KAAgB,CAAhB,IAAqB,CAACqI,KAAK,CAAChB,IAAI,CAAC,CAAD,CAAJ,CAAQnI,CAAT,CAA9B,EAA2C,MAAMsG,YAAN;AAC5C;;AACD,QAAGjG,IAAI,KAAK,YAAZ,EAA0B;AACxB,UAAG8H,IAAI,CAACrH,MAAL,GAAc,CAAjB,EAAoB,MAAM0F,aAAN;AACpB,UAAG2B,IAAI,CAACrH,MAAL,KAAgB,CAAhB,IAAqB,CAACqI,KAAK,CAAChB,IAAI,CAAC,CAAD,CAAJ,CAAQnI,CAAT,CAA9B,EAA2C,MAAMsG,YAAN;AAC5C;;AAED,QAAGjG,IAAI,KAAK,WAAT,IAAwB8H,IAAI,CAACrH,MAAL,GAAc,CAAtC,IAA2CqH,IAAI,CAAC,CAAD,CAAJ,CAAQnI,CAAR,KAAcsI,MAAM,CAACE,iBAAhE,IAAqFL,IAAI,CAAC,CAAD,CAAJ,CAAQnI,CAAR,KAAcsI,MAAM,CAACC,iBAA7G,EAAgI;AAC9HJ,UAAI,CAAC,CAAD,CAAJ,CAAQnI,CAAR,GAAY,EAAZ;AACD;;AAED,QAAGK,IAAI,KAAK,WAAT,IAAwB8H,IAAI,CAACrH,MAAL,GAAc,CAAtC,IAA2CqH,IAAI,CAAC,CAAD,CAAJ,CAAQnI,CAAR,GAAY,CAA1D,EAA6D;AAC3DmI,UAAI,CAAC,CAAD,CAAJ,CAAQnI,CAAR,GAAY,CAAZ;AACD;;AACD,QAAGK,IAAI,KAAK,WAAT,IAAwB8H,IAAI,CAACrH,MAAL,GAAc,CAAtC,IAA2CqH,IAAI,CAAC,CAAD,CAAJ,CAAQnI,CAAR,KAAcsI,MAAM,CAACC,iBAAnE,EAAsF;AACpFJ,UAAI,CAAC,CAAD,CAAJ,CAAQnI,CAAR,GAAYmI,IAAI,CAAC,CAAD,CAAJ,CAAQnI,CAAR,CAAUc,MAAV,GAAmB,CAA/B;AACD;;AACD4O,iBAAa,CAACrP,IAAD,EAAO8H,IAAP,CAAb;AACA,WAAOA,IAAP;AACD;;AAED1I,QAAM,CAACC,OAAP,GAAiB;AACfiG,oBAAgB,EAAhBA,gBADe;AAEfC,wBAAoB,EAApBA;AAFe,GAAjB;;;;;;;;;;;;;;;;;ACpEA,WAAS+J,WAAT,CAAqB5G,KAArB,EAA4BG,EAA5B,EAAgC;AAC9B,WAAOA,EAAE,KAAKrG,WAAW,CAACkE,WAAnB,IACLgC,KAAK,CAAC7J,OAAN,CAAc,GAAd,IAAqB,CADhB,IAEF,CAAC6J,KAAK,CAACnF,UAAN,CAAiB,GAAjB,CAFN;AAGD;;AAED,MAAIgM,UAAU,GAAG,iBAAjB;;AAEA,WAAS/J,SAAT,CAAmBkD,KAAnB,EAA0B;AACxB,QAAIoG,CAAC,GAAGpG,KAAK,CAAC8G,KAAN,CAAYD,UAAZ,CAAR;AACA,WAAOT,CAAC,GAAGA,CAAC,CAAC,CAAD,CAAD,CAAK/P,KAAL,CAAW,GAAX,CAAH,GAAqB,EAA7B;AACD;;AAED,WAAS0G,eAAT,CAAyBiD,KAAzB,EAAgCG,EAAhC,EAAoC;AAClC,QAAGyG,WAAW,CAAC5G,KAAD,EAAQG,EAAR,CAAd,EAA2B;AACzBH,WAAK,GAAGA,KAAK,CAAClE,OAAN,CAAc,IAAd,EAAoB,EAApB,CAAR;;AACA,UAAGkE,KAAK,CAAC7J,OAAN,CAAc,KAAd,IAAuB,CAA1B,EAA6B;AAC3B6J,aAAK,GAAGA,KAAK,CAAClE,OAAN,CAAc,KAAd,EAAqB,OAArB,CAAR;AACD;;AACD,UAAGkE,KAAK,CAAC7J,OAAN,CAAc,KAAd,IAAuB,CAA1B,EAA6B;AAC3B6J,aAAK,GAAGA,KAAK,CAAClE,OAAN,CAAc,KAAd,EAAqB,OAArB,CAAR;AACD;AACF;;AAED,QAAGkE,KAAK,KAAK,2BAAb,EAA0C;AACxCA,WAAK,GAAGA,KAAK,CAAClE,OAAN,CAAc,mBAAd,EAAmC,mBAAnC,CAAR;AACD;;AACD,WAAOkE,KAAP;AACD;;AAEDtJ,QAAM,CAACC,OAAP,GAAiB;AACfmG,aAAS,EAATA,SADe;AAEfC,mBAAe,EAAfA;AAFe,GAAjB;;;;;;;;;;;;;;;;;;;iBC9ByC5E,mBAAO,CAAC,EAAD,C;MAAzC4O,K,YAAAA,I;MAAMC,S,YAAAA,Q;MAAUC,c,YAAAA,c;;kBACN9O,mBAAO,CAAC,EAAD,C;MAAjB+O,O,aAAAA,M;;kBACe/O,mBAAO,CAAC,EAAD,C;MAAtBgP,W,aAAAA,W;;AAEP,MAAIC,yBAAyB,GAAG,SAA5BA,yBAA4B,CAAS9O,MAAT,EAAiB;AAC/C,QACImF,aAAa,GAAG,IAAID,KAAJ,CAAU,eAAV,CADpB;AAAA,QAEIE,YAAY,GAAG,IAAIF,KAAJ,CAAU,cAAV,CAFnB;AAAA,QAGI6J,cAAc,GAAG,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAHtC;AAAA,QAIIC,UAAU,GAAG,yBAJjB;AAAA,QAKIxR,WAAW,GAAG,+EALlB;AAAA,QAMI+C,GAAG,GAAG;AACJpB,WAAK,EAAE,eAASoH,GAAT,EAAc;AAAE,eAAO;AAAEZ,WAAC,EAAC,OAAJ;AAAahH,WAAC,EAAC4H;AAAf,SAAP;AAA8B,OADjD;AAEJ,iBAAS,iBAASA,GAAT,EAAc;AAAE,eAAO;AAAEZ,WAAC,EAAC,MAAJ;AAAYhH,WAAC,EAAC4H;AAAd,SAAP;AAA6B,OAFlD;AAGJ7F,YAAM,EAAE,gBAAS6F,GAAT,EAAc;AAAE,eAAO;AAAEZ,WAAC,EAAC,KAAJ;AAAWhH,WAAC,EAAC4H;AAAb,SAAP;AAA4B,OAHhD;AAIJ/F,YAAM,EAAE,gBAAS+F,GAAT,EAAc;AAAE,eAAO;AAAEZ,WAAC,EAAC,KAAJ;AAAWhH,WAAC,EAAC4H;AAAb,SAAP;AAA4B,OAJhD;AAKJ1F,UAAI,EAAE,cAAS0F,GAAT,EAAc;AAClB,YAAG,EAAEA,GAAG,YAAYzI,IAAjB,CAAH,EAA2B,MAAM,IAAIoH,KAAJ,CAAU,6BAA6BqB,GAA7B,GAAmC,IAAnC,WAAkDA,GAAlD,IAAyD,GAAnE,CAAN;AAC3B,eAAO;AAAEZ,WAAC,EAAC,MAAJ;AAAYhH,WAAC,EAAC4H;AAAd,SAAP;AACD;AARG,KANV;AAAA,QAgBI0I,QAAQ,GAAG,SAAXA,QAAW,CAASvQ,CAAT,EAAYwQ,GAAZ,EAAiB;AAC1BA,SAAG,GAAGA,GAAG,IAAI,CAAb;AACAxQ,OAAC,GAAGA,CAAC,CAAC0E,QAAF,EAAJ;;AACA,aAAM1E,CAAC,CAACe,MAAF,GAAWyP,GAAjB;AAAsBxQ,SAAC,GAAG,MAAMA,CAAV;AAAtB;;AACA,aAAOA,CAAP;AACD,KArBL;AAAA,QAsBIyQ,IAAI,GAAG,SAAPA,IAAO,CAASnR,CAAT,EAAY;AAAE,aAAOE,IAAI,CAACC,KAAL,CAAWiR,MAAM,CAACpR,CAAD,CAAjB,CAAP;AAA+B,KAtBxD;AAAA,QAuBIoR,MAAM,GAAG,SAATA,MAAS,CAASpR,CAAT,EAAY;AAAE,aAAOA,CAAC,CAAC2H,CAAF,KAAQ,KAAR,GAAe3H,CAAC,CAACW,CAAjB,GAAoBsL,UAAU,CAACoF,IAAI,CAACrR,CAAD,CAAL,CAArC;AAAiD,KAvB5E;AAAA,QAwBIqR,IAAI,GAAG,SAAPA,IAAO,CAASrR,CAAT,EAAY;AACjB,aAAOA,CAAC,CAAC2H,CAAF,KAAQ,KAAR,GACA3H,CAAC,CAACW,CAAF,CAAIc,MAAJ,GAAazB,CAAC,CAACW,CAAF,CAAI,CAAJ,EAAOyE,QAAP,EAAb,GAAiC,EADjC,GAEHpF,CAAC,CAACW,CAAF,CAAIyE,QAAJ,EAFJ;AAGD,KA5BL;AAAA,QA6BIkM,aAAa,GAAG,SAAhBA,aAAgB,CAAS5R,CAAT,EAAY;AACtB,aAAOA,CAAC,CAAC6R,WAAF,KAAkB,GAAlB,GAAwBN,QAAQ,CAACvR,CAAC,CAAC8R,QAAF,KAAa,CAAd,CAAhC,GAAmD,GAAnD,GACHP,QAAQ,CAACvR,CAAC,CAAC+R,OAAF,EAAD,CADZ;AAEL,KAhCL;AAAA,QAiCIC,MAAM,GAAG,SAATA,MAAS,CAASC,GAAT,EAAc;AACrB,UAAGA,GAAG,GAAG,CAAT,EAAY;AACV,eAAO,CAACzR,IAAI,CAACC,KAAL,CAAW,CAACwR,GAAZ,CAAR;AACD;;AACD,aAAOzR,IAAI,CAACC,KAAL,CAAWwR,GAAX,CAAP;AACD,KAtCL;AAAA,QAuCIC,UAAU,GAAG,SAAbA,UAAa,CAASvF,CAAT,EAAY;AACvB,UAAIrM,CAAC,GAAGE,IAAI,CAACsN,MAAL,KAAc,EAAd,GAAiB,CAAzB;AAAA,UACI7M,CAAC,GAAG0L,CAAC,IAAI,GAAL,GAAWrM,CAAX,GAAeA,CAAC,GAAC,GAAF,GAAM,GAD7B;AAEA,aAAOW,CAAC,CAACyE,QAAF,CAAW,EAAX,CAAP;AACD,KA3CL;AAAA,QA4CIyM,KAAK,GAAG,SAARA,KAAQ,CAASC,EAAT,EAAaC,QAAb,EAAuB;AAC7B,UAAInS,IAAJ,EAAU+H,CAAV;;AACA,UAAGmK,EAAE,CAACnR,CAAH,YAAgBb,IAAnB,EAAyB;AACvB,eAAO,IAAIA,IAAJ,CAASgS,EAAE,CAACnR,CAAZ,CAAP;AACD;;AACDmR,QAAE,GAAGT,IAAI,CAACS,EAAD,CAAT;;AACA,UAAGd,UAAU,CAAC1I,IAAX,CAAgBwJ,EAAhB,CAAH,EAAwB;AAEtBlS,YAAI,GAAG,IAAIE,IAAJ,CAAS,IAAT,EAAe,CAAf,EAAkB,CAAlB,CAAP;AACAF,YAAI,CAACoS,OAAL,CAAa,IAAIpJ,QAAQ,CAACkJ,EAAD,EAAK,EAAL,CAAzB;AACA,eAAOlS,IAAP;AACD,OALD,MAKO,IAAGJ,WAAW,CAAC8I,IAAZ,CAAiBwJ,EAAjB,CAAH,EAAyB;AAC9B,YAAGC,QAAQ,IAAID,EAAE,CAACjS,OAAH,CAAW,GAAX,IAAgB,CAA/B,EAAkC,OAAO,IAAIC,IAAJ,CAASgS,EAAT,CAAP;AAClCnK,SAAC,GAAGmK,EAAE,CAACjS,OAAH,CAAW,GAAX,CAAJ;AACA,YAAG8H,CAAC,KAAK,CAAC,CAAV,EAAamK,EAAE,GAAGA,EAAE,CAAC3H,SAAH,CAAa,CAAb,EAAgBxC,CAAhB,CAAL;AACb/H,YAAI,GAAGkS,EAAE,CAAC/R,KAAH,CAAS,GAAT,CAAP;AACAH,YAAI,GAAG,IAAIE,IAAJ,CAASF,IAAI,CAAC,CAAD,CAAb,EAAkBA,IAAI,CAAC,CAAD,CAAJ,GAAQ,CAA1B,EAA6BA,IAAI,CAAC,CAAD,CAAjC,CAAP;AACA,eAAOA,IAAP;AACD;;AACD,UAAIF,CAAC,GAAG,IAAII,IAAJ,CAASgS,EAAT,CAAR;AACA,aAAOpS,CAAC,IAAI,cAAL,GAAsB,IAAtB,GAA6BA,CAApC;AACD,KAjEL;AAAA,QAkEIuS,kBAAkB,GAAG,SAArBA,kBAAqB,CAASH,EAAT,EAAa1Q,EAAb,EAAiB;AACpC,UAAGA,EAAE,KAAKoC,WAAW,CAACqE,YAAtB,EAAoC;AAClC,YAAG,CAACiK,EAAJ,EAAQ,OAAOvP,GAAG,WAAH,CAAY,KAAZ,CAAP;AACR,eAAOA,GAAG,WAAH,CAAY,CAACuH,KAAK,CAAC,IAAIhK,IAAJ,CAASgS,EAAT,EAAa7R,OAAb,EAAD,CAAlB,CAAP;AACD;;AACD,UAAGmB,EAAE,KAAKoC,WAAW,CAACkE,WAAtB,EAAmC;AACjC,YAAG,CAACoK,EAAJ,EAAQ,OAAOvP,GAAG,CAACG,MAAJ,CAAW,CAAX,CAAP;AACR,eAAOH,GAAG,CAACG,MAAJ,CAAY,IAAI5C,IAAJ,CAASgS,EAAT,EAAa7R,OAAb,EAAD,IAA4B,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAA7C,CAAX,CAAP;AACD;;AACD,UAAGmB,EAAE,KAAKoC,WAAW,CAAC6E,WAAtB,EAAmC;AACjC,YAAG,CAACyJ,EAAJ,EAAQ,OAAOvP,GAAG,CAACC,MAAJ,CAAW,cAAX,CAAP;AACR,eAAOD,GAAG,CAACC,MAAJ,CAAW,IAAI1C,IAAJ,CAASgS,EAAT,EAAa3M,gBAAb,EAAX,CAAP;AACD;;AACD,UAAG,CAAC2M,EAAJ,EAAQ,OAAOvP,GAAG,CAACC,MAAJ,CAAW,cAAX,CAAP;AACR,aAAOD,GAAG,CAACM,IAAJ,CAASiP,EAAT,CAAP;AACD,KAjFL;AAAA,QAkFII,KAAI,GAAG,SAAPA,IAAO,GAAW;AACd,aAAO,uCACE1M,OADF,CACU,OADV,EACmBoM,UADnB,CAAP;AAEH,KArFL;AAAA,QAsFI/O,IAAI,GAAG,SAAPA,IAAO,CAASiP,EAAT,EAAa1Q,EAAb,EAAiB;AACtB0Q,QAAE,GAAGD,KAAK,CAACC,EAAD,CAAV;AACA,aAAOG,kBAAkB,CAACH,EAAD,EAAK1Q,EAAL,CAAzB;AACD,KAzFL;AAAA,QA0FI+Q,WAAW,GAAG,SAAdA,WAAc,CAAStP,IAAT,EAAeuP,MAAf,EAAuB;AACnCvP,UAAI,GAAGgP,KAAK,CAAChP,IAAD,EAAO,IAAP,CAAZ;AACA,UAAG,CAACuP,MAAJ,EAAY,OAAO,EAAP;AACZA,YAAM,GAAGf,IAAI,CAACe,MAAD,CAAb;AACA,UAAG,CAACvP,IAAJ,EAAU,OAAO,cAAP;AACV,UAAIwJ,CAAJ;AAAA,UAAOzK,CAAP;AAAA,UAAUyQ,EAAE,GAAG,EAAf;AAAA,UAAmBC,CAAC,GAAG;AACrBC,YAAI,EAAE,OAAO1P,IAAI,CAAC2P,OAAL,EADQ;AAErBC,aAAK,EAAE,IAAI5P,IAAI,CAAC2O,QAAL,EAFU;AAGrBkB,WAAG,EAAE7P,IAAI,CAAC4O,OAAL,EAHgB;AAIrBkB,YAAI,EAAE9P,IAAI,CAAC+P,QAAL,EAJe;AAKrBC,cAAM,EAAEhQ,IAAI,CAACiQ,UAAL,EALa;AAMrBC,cAAM,EAAElQ,IAAI,CAACmQ,UAAL,EANa;AAOrBC,cAAM,EAAEpQ,IAAI,CAACqQ,eAAL,EAPa;AAQrBC,gBAAQ,EAAEtQ,IAAI,CAAC5C,OAAL,EARW;AASrBmT,WAAG,EAAE,IAAIvQ,IAAI,CAACwQ,MAAL;AATY,OAAvB;AAWA,UAAIC,MAAM,GAAGjQ,MAAM,GAAGA,MAAM,CAACkQ,gBAAV,GAA6B9D,SAAhD;;AAEA,WAAI7N,CAAC,GAAC,CAAN,EAASA,CAAC,GAACwQ,MAAM,CAAC3Q,MAAlB,EAA0B,EAAEG,CAA5B,EAA+B;AAC7ByK,SAAC,GAAG+F,MAAM,CAACrG,MAAP,CAAcnK,CAAd,CAAJ;;AAEA,YAAIyK,CAAC,KAAK,GAAV,EAAe;AACb,cAAG,EAAEzK,CAAF,IAAOwQ,MAAM,CAAC3Q,MAAjB,EAAyB;AACvB,kBAAM,IAAIyF,KAAJ,CAAU,gCAAV,CAAN;AACD;;AACDmF,WAAC,GAAG+F,MAAM,CAACrG,MAAP,CAAcnK,CAAd,CAAJ;;AAEA,cAAIyK,CAAC,KAAK,GAAV,EAAe;AACbgG,cAAE,IAAI,GAAN;AACD,WAFD,MAEO,IAAIhG,CAAC,KAAK,GAAV,EAAe;AACpBgG,cAAE,IAAIpB,QAAQ,CAACqB,CAAC,CAACC,IAAH,EAAS,CAAT,CAAd;AACD,WAFM,MAEA,IAAIlG,CAAC,KAAK,GAAV,EAAe;AACpBgG,cAAE,IAAIpB,QAAQ,CAACqB,CAAC,CAACC,IAAH,EAAS,CAAT,CAAR,CAAoBpI,SAApB,CAA8B,CAA9B,CAAN;AACD,WAFM,MAEA,IAAIkC,CAAC,KAAK,GAAV,EAAe;AACpBgG,cAAE,IAAIpB,QAAQ,CAACqB,CAAC,CAACG,KAAH,EAAU,CAAV,CAAd;AACD,WAFM,MAEA,IAAIpG,CAAC,KAAK,GAAV,EAAe;AACpBgG,cAAE,IAAIC,CAAC,CAACG,KAAR;AACD,WAFM,MAEA,IAAIpG,CAAC,KAAK,GAAV,EAAe;AACpBgG,cAAE,IAAIxP,IAAI,CAAC2Q,kBAAL,CAAyBF,MAAzB,EAAiC;AAAEb,mBAAK,EAAE;AAAT,aAAjC,CAAN;AACD,WAFM,MAEA,IAAIpG,CAAC,KAAK,GAAV,EAAe;AACpBgG,cAAE,IAAIpB,QAAQ,CAACqB,CAAC,CAACI,GAAH,EAAQ,CAAR,CAAd;AACD,WAFM,MAEA,IAAIrG,CAAC,KAAK,GAAV,EAAe;AACpBgG,cAAE,IAAIC,CAAC,CAACI,GAAR;AACD,WAFM,MAEA,IAAIrG,CAAC,KAAK,GAAV,EAAe;AACpBgG,cAAE,IAAIpB,QAAQ,CAACqB,CAAC,CAACK,IAAH,EAAS,CAAT,CAAd;AACD,WAFM,MAEA,IAAItG,CAAC,KAAK,GAAV,EAAe;AACpBgG,cAAE,IAAIC,CAAC,CAACK,IAAR;AACD,WAFM,MAEA,IAAItG,CAAC,KAAK,GAAV,EAAe;AACpBgG,cAAE,IAAIpB,QAAQ,CAACqB,CAAC,CAACO,MAAH,EAAW,CAAX,CAAd;AACD,WAFM,MAEA,IAAIxG,CAAC,KAAK,GAAV,EAAe;AACpBgG,cAAE,IAAIpB,QAAQ,CAACqB,CAAC,CAACS,MAAH,EAAW,CAAX,CAAd;AACD,WAFM,MAEA,IAAI1G,CAAC,KAAK,GAAV,EAAe;AAEpBgG,cAAE,IAAIpB,QAAQ,CAACqB,CAAC,CAACW,MAAH,EAAW,CAAX,CAAd;AACD,WAHM,MAGA,IAAI5G,CAAC,KAAK,GAAV,EAAe;AACpBgG,cAAE,IAAIxP,IAAI,CAAC2Q,kBAAL,CAAyBF,MAAzB,EAAiC;AAAEG,qBAAO,EAAE;AAAX,aAAjC,CAAN;AACD,WAFM,MAEA,IAAIpH,CAAC,KAAK,GAAN,IAAaA,CAAC,KAAK,GAAnB,IAA0BA,CAAC,KAAK,GAApC,EAAyC;AAC9C,kBAAM,IAAInF,KAAJ,CAAU,gDAAgDmF,CAAhD,GAAoD,GAA9D,CAAN;AACD,WAFM,MAEA;AACL,kBAAM,IAAInF,KAAJ,CAAU,iDAAiDmF,CAAjD,GAAqD,GAA/D,CAAN;AACD;AACF,SAxCD,MAwCO;AACLgG,YAAE,IAAIhG,CAAN;AACD;AACF;;AAED,aAAOgG,EAAP;AACD,KA7JL;AAAA,QA8JIrP,IA9JJ;AAAA,QA8JUwE,OA9JV;AAAA,QA8JmBkM,GAAG,GAAG,EA9JzB;AAAA,QA+JIC,aAAa,GAAG,SAAhBA,aAAgB,CAASvS,EAAT,EAAawS,SAAb,EAAwB;AACtC,aAAO3B,kBAAkB,CAACyB,GAAG,CAACG,IAAJ,CAASD,SAAT,CAAD,EAAsBxS,EAAtB,CAAzB;AACD,KAjKL;;AAmKA4B,QAAI,GAAG;AACLiD,SAAG,EAAE,aAASjG,CAAT,EAAY;AAAE,eAAOuC,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAAC+F,GAAL,CAASjG,CAAC,CAACW,CAAX,CAAX,CAAP;AAAmC,OADjD;AAELmT,UAAI,EAAE,cAAS9T,CAAT,EAAY;AAAE,eAAOuC,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAAC4T,IAAL,CAAU9T,CAAC,CAACW,CAAZ,CAAX,CAAP;AAAoC,OAFnD;AAGLoT,UAAI,EAAE,cAAS/T,CAAT,EAAY;AAAE,eAAOuC,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAAC6T,IAAL,CAAU/T,CAAC,CAACW,CAAZ,CAAX,CAAP;AAAoC,OAHnD;AAILqT,UAAI,EAAE,cAAShU,CAAT,EAAY;AAAE,eAAOuC,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAAC8T,IAAL,CAAUhU,CAAC,CAACW,CAAZ,CAAX,CAAP;AAAoC,OAJnD;AAKLsT,WAAK,EAAE,eAASjU,CAAT,EAAY;AACjB,YAAG4E,SAAS,CAACnD,MAAV,GAAiB,CAApB,EAAuB;AACrB,cAAIyS,CAAC,GAAGtP,SAAS,CAAC,CAAD,CAAT,CAAajE,CAArB;AACA,cAAIoF,CAAC,GAAGnB,SAAS,CAAC,CAAD,CAAT,CAAajE,CAArB;AACA,iBAAO4B,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAAC+T,KAAL,CAAWC,CAAX,EAAcnO,CAAd,CAAX,CAAP;AACD;;AACD,eAAOxD,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAAC+T,KAAL,CAAWjU,CAAC,CAACW,CAAb,CAAX,CAAP;AACD,OAZI;AAaL,6BAAuB,2BAAS6B,MAAT,EAAiB;AACtCA,cAAM,GAAG6O,IAAI,CAAC7O,MAAD,CAAb;AACA,eAAOD,GAAG,WAAH,CAAYC,MAAM,KAAK,GAAX,IAAkBA,MAAM,KAAK,MAAzC,CAAP;AACD,OAhBI;AAiBLiO,UAAI,EAAE,cAASzQ,CAAT,EAAY;AAChB,YAAG4E,SAAS,CAACnD,MAAV,KAAqB,CAAxB,EAA2B,MAAM2F,YAAN;AAC3B,eAAOuJ,cAAc,CAACpO,GAAG,CAACG,MAAL,EAAa+N,KAAb,EAAmBzQ,CAAnB,CAArB;AACH,OApBM;AAqBLmU,eAAS,EAAE,mBAAShE,GAAT,EAAcC,GAAd,EAAmB;AAC5B,YAAIxO,CAAJ;AAAA,YAAO4J,CAAP;AAAA,YAAU4I,KAAK,GAAG,CAAlB;AACAjE,WAAG,GAAGA,GAAG,CAACxP,CAAV;AACAyP,WAAG,GAAGA,GAAG,CAACzP,CAAV;;AACA,aAAKiB,CAAC,GAAC,CAAP,EAASA,CAAC,GAAGgD,SAAS,CAACnD,MAAvB,EAA8BG,CAAC,EAA/B,EAAmC;AACjC,cAAI2H,GAAG,GAAG3E,SAAS,CAAChD,CAAD,CAAnB;;AACA,cAAI2H,GAAG,CAAC5B,CAAJ,KAAU,MAAV,IAAoB+H,OAAO,CAACnG,GAAG,CAAC5I,CAAL,CAA/B,EAAwC;AACtCyT,iBAAK;AACN,WAFD,MAEO,IAAI7K,GAAG,CAAC5B,CAAJ,KAAU,KAAd,EAAqB;AAC1B,iBAAI6D,CAAC,GAAC,CAAN,EAAQA,CAAC,GAACjC,GAAG,CAAC5I,CAAJ,CAAMc,MAAhB,EAAuB+J,CAAC,EAAxB,EAA4B;AAC1B,kBAAGkE,OAAO,CAACnG,GAAG,CAAC5I,CAAJ,CAAM6K,CAAN,CAAD,CAAV,EAAsB4I,KAAK;AAC5B;AACF;AACF;;AACD,eAAO7R,GAAG,WAAH,CAAY,CAAC4N,GAAG,GAAG,CAAN,IAAWiE,KAAK,IAAIjE,GAArB,MAA8BC,GAAG,GAAG,CAAN,IAAWgE,KAAK,IAAIhE,GAAlD,CAAZ,CAAP;AACD,OApCI;AAqCLiE,cAAQ,EAAE,kBAASC,CAAT,EAAYC,CAAZ,EAAe;AAAE,eAAOhS,GAAG,CAACC,MAAJ,CAAW6O,IAAI,CAACiD,CAAD,CAAJ,IAAWjD,IAAI,CAACkD,CAAD,CAA1B,CAAP;AAAwC,OArC9D;AAsCLC,YAAM,EAAE,kBAAW;AACjB,YAAIC,GAAG,GAAG,EAAV;;AACA,aAAK,IAAIjJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG5G,SAAS,CAACnD,MAA9B,EAAsC+J,CAAC,EAAvC,EAA0C;AACxC,cAAG5G,SAAS,CAAC4G,CAAD,CAAT,CAAa7D,CAAb,KAAmB,KAAtB,EAA6B;AAC3B8M,eAAG,CAAC5T,IAAJ,CAAS+D,SAAS,CAAC4G,CAAD,CAAT,CAAa7K,CAAb,CAAe+T,IAAf,CAAoB,EAApB,CAAT;AACD,WAFD,MAEO;AACLD,eAAG,CAAC5T,IAAJ,CAAS+D,SAAS,CAAC4G,CAAD,CAAT,CAAa7K,CAAtB;AACD;AACF;;AACD,eAAO4B,GAAG,CAACC,MAAJ,CAAWiS,GAAG,CAACC,IAAJ,CAAS,EAAT,CAAX,CAAP;AACD,OAhDI;AAiDLC,SAAG,EAAE,aAAS3U,CAAT,EAAY;AAAE,eAAOuC,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAACyU,GAAL,CAAS3U,CAAC,CAACW,CAAX,CAAX,CAAP;AAAmC,OAjDjD;AAkDL,yBAAmB,uBAASX,CAAT,EAAY;AAC7B,YAAG4E,SAAS,CAACnD,MAAV,KAAqB,CAArB,IAA0BzB,CAAC,CAAC2H,CAAF,KAAQ,KAArC,EAA4C,MAAMP,YAAN;AAC5C,YAAIwN,OAAO,GAAG,CAAd;;AACA,aAAK,IAAIpJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGxL,CAAC,CAACW,CAAF,CAAIc,MAAxB,EAAgC+J,CAAC,EAAjC,EAAoC;AAClCoJ,iBAAO,IAAI5U,CAAC,CAACW,CAAF,CAAI6K,CAAJ,MAAW,EAAX,GAAgB,CAAhB,GAAoB,CAA/B;AACD;;AACD,eAAOjJ,GAAG,CAACG,MAAJ,CAAWkS,OAAX,CAAP;AACD,OAzDI;AA0DL,wBAAkB,uBAASC,CAAT,EAAY;AAC5B,YAAIC,KAAK,GAAGzD,IAAI,CAACwD,CAAD,CAAJ,CAAQ9U,KAAR,CAAc,GAAd,CAAZ;AAAA,YACI6B,CAAC,GAAGkT,KAAK,CAACrT,MADd;AAAA,YAEIsT,KAAK,GAAG,CAFZ;;AAGA,eAAM,EAAEnT,CAAF,IAAO,CAAb;AAAgB,cAAGkT,KAAK,CAAClT,CAAD,CAAL,CAASH,MAAZ,EAAoB,EAAEsT,KAAF;AAApC;;AACA,eAAOxS,GAAG,CAACG,MAAJ,CAAWqS,KAAX,CAAP;AACD,OAhEI;AAiELlS,UAAI,EAAE,cAASiP,EAAT,EAAa1Q,EAAb,EAAiB;AACrB0Q,UAAE,GAAGD,KAAK,CAACC,EAAD,CAAV;AACA,eAAOG,kBAAkB,CAACH,EAAD,EAAK1Q,EAAL,CAAzB;AACD,OApEI;AAqEL,sBAAgB,qBAASyB,IAAT,EAAe;AAC7B,YAAG+B,SAAS,CAACnD,MAAV,GAAmB,CAAtB,EAAyB,MAAM0F,aAAN;AACzB,YAAIgB,GAAG,GAAGrI,IAAI,CAACkV,KAAL,CAAW3D,IAAI,CAACxO,IAAD,CAAf,IAAyBkO,cAAnC;AACA,eAAOxO,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAACC,KAAL,CAAWgI,GAAG,GAAG,IAAjB,IAAuB,IAAlC,CAAP;AACD,OAzEI;AA0EL,sBAAgB,qBAASnI,CAAT,EAAY;AAC1B,YAAG4E,SAAS,CAACnD,MAAV,GAAmB,CAAtB,EAAyB,MAAM0F,aAAN;AACzB,YAAGnH,CAAC,CAAC2H,CAAF,KAAQ,KAAX,EAAkB,OAAOpF,GAAG,CAACG,MAAJ,CAAW8M,GAAX,CAAP;AAClB,YAAIyF,IAAI,GAAGjV,CAAC,CAACW,CAAb;AAGA,YAAImP,CAAC,GAAGmF,IAAI,CAACzE,KAAL,CAAW,wDAAX,CAAR;AACA,YAAI0E,SAAS,GAAG,IAAhB;AACA,YAAIC,GAAJ;;AACA,YAAIrF,CAAC,IACHA,CAAC,CAAC,CAAD,CAAD,GAAO,EADL,IACWA,CAAC,CAAC,CAAD,CAAD,IAAQ,CADnB,IAEFA,CAAC,CAAC,CAAD,CAAD,GAAO,EAFL,IAEWA,CAAC,CAAC,CAAD,CAAD,IAAQ,CAFnB,IAGFA,CAAC,CAAC,CAAD,CAAD,GAAO,EAHL,IAGWA,CAAC,CAAC,CAAD,CAAD,IAAQ,CAHnB,IAIFA,CAAC,CAAC,CAAD,CAAD,GAAO,EAJL,IAIWA,CAAC,CAAC,CAAD,CAAD,IAAQ,CAJnB,IAKFA,CAAC,CAAC,CAAD,CAAD,GAAO,EALL,IAKWA,CAAC,CAAC,CAAD,CAAD,IAAQ,CALvB,EAME;AACA,gBAAIhK,IAAI,GAAG,SAAPA,IAAO,CAASC,CAAT,EAAY;AAAE,qBAAQA,CAAC,GAAG,EAAL,GAAW,MAAMA,CAAjB,GAAqBA,CAA5B;AAAgC,aAAzD;;AACA,gBAAIqP,KAAK,GAAG,IAAItV,IAAJ,EAAZ;AACA,gBAAIJ,CAAC,GAAG,IAAII,IAAJ,CAASsV,KAAK,CAAC7D,WAAN,KAAsB,GAAtB,GAA4BzL,IAAI,CAACsP,KAAK,CAAC5D,QAAN,KAAmB,CAApB,CAAhC,GAAyD,GAAzD,GAA+D1L,IAAI,CAACsP,KAAK,CAAC3D,OAAN,EAAD,CAAnE,GAAuF,GAAvF,GAA6FwD,IAAtG,CAAR;;AACA,gBAAGvV,CAAC,CAAC0F,QAAF,OAAiB,cAApB,EAAmC;AACjC+P,iBAAG,GAAG3F,GAAN;AACD,aAFD,MAEO;AACL2F,iBAAG,GAAGjV,IAAI,CAACC,KAAL,CAAW,CAACT,CAAC,CAACsT,UAAF,KAAe,IAAf,GAAsBtT,CAAC,CAACoT,UAAF,KAAe,EAArC,GAA0CpT,CAAC,CAACkT,QAAF,EAA3C,IAA2DsC,SAA3D,GAAqE,EAAhF,IAAsFA,SAA5F;AACD;AACF,WAfD,MAeO;AACLC,aAAG,GAAG3F,GAAN;AACD;;AACD,eAAOjN,GAAG,CAACG,MAAJ,CAAWyS,GAAX,CAAP;AACD,OAtGI;AAuGLvE,YAAM,EAAE,gBAASyE,GAAT,EAAcC,IAAd,EAAoBC,QAApB,EAA8B;AACpC,eAAOhT,GAAG,CAACC,MAAJ,CAAWoO,OAAM,CAACyE,GAAD,EAAMC,IAAN,EAAYC,QAAZ,CAAjB,CAAP;AACD,OAzGI;AA0GL7E,cAAQ,EAAE,kBAAS1Q,CAAT,EAAY;AACpB,YAAG4E,SAAS,CAACnD,MAAV,KAAqB,CAAxB,EAA2B,MAAM2F,YAAN;AAC3B,eAAOuJ,cAAc,CAACpO,GAAG,CAACG,MAAL,EAAagO,SAAb,EAAuB1Q,CAAvB,CAArB;AACD,OA7GI;AA8GLwV,SAAG,EAAE,aAASxV,CAAT,EAAY;AAAE,eAAOuC,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAACsV,GAAL,CAASxV,CAAC,CAACW,CAAX,CAAX,CAAP;AAAmC,OA9GjD;AA+GL8U,WAAK,EAAE,eAASzV,CAAT,EAAY;AAAE,eAAOuC,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAACwV,GAAL,CAAS,EAAT,EAAa1V,CAAC,CAACW,CAAf,CAAX,CAAP;AAAuC,OA/GvD;AAgHL,eAAS,gBAASS,EAAT,EAAa;AACpB,YAAGA,EAAE,KAAKoC,WAAW,CAACkE,WAAtB,EAAmC,OAAOnF,GAAG,CAACG,MAAJ,CAAW,CAAX,CAAP;AACnC,YAAGkC,SAAS,CAACnD,MAAV,GAAiB,CAApB,EAAuB,MAAM0F,aAAN;AACvB,eAAO5E,GAAG,WAAH,CAAY,KAAZ,CAAP;AACD,OApHI;AAqHL,qBAAe,oBAASM,IAAT,EAAeuP,MAAf,EAAuB;AACpC,eAAO7P,GAAG,CAACC,MAAJ,CAAW2P,WAAW,CAACtP,IAAD,EAAOuP,MAAP,CAAtB,CAAP;AAA+C,OAtH5C;AAuHL,YAAM,aAASuD,GAAT,EAAcrB,CAAd,EAAiBC,CAAjB,EAAoB;AACxB,YAAGoB,GAAG,CAAChO,CAAJ,KAAU,MAAb,EAAqB,OAAOpF,GAAG,CAACC,MAAJ,CAAWkN,OAAO,CAACiG,GAAG,CAAChV,CAAL,CAAP,GAAiB2T,CAAC,CAAC3T,CAAnB,GAAuB4T,CAAC,CAAC5T,CAApC,CAAP;;AACrB,YAAGgV,GAAG,CAAChO,CAAJ,KAAU,KAAb,EAAoB;AAClB,cAAIiO,MAAM,GAAGD,GAAG,CAAChV,CAAJ,CAAMc,MAAN,IAAgBkU,GAAG,CAAChV,CAAJ,CAAM,CAAN,MAAa,IAA1C;AACA,iBAAO4B,GAAG,CAACC,MAAJ,CAAWoT,MAAM,GAAGtB,CAAC,CAAC3T,CAAL,GAAS4T,CAAC,CAAC5T,CAA5B,CAAP;AACD;;AACD,eAAO4B,GAAG,CAACC,MAAJ,CAAW+R,CAAC,CAAC5T,CAAb,CAAP;AACD,OA9HI;AA+HL,mBAAa,kBAAS2T,CAAT,EAAYC,CAAZ,EAAe;AAC1B,YAAG3P,SAAS,CAACnD,MAAV,GAAmB,CAAtB,EAAyB,MAAM0F,aAAN;AACzB,YAAGvC,SAAS,CAACnD,MAAV,GAAmB,CAAtB,EAAyB,MAAM2F,YAAN;AACzB,eAAO7E,GAAG,WAAH,CAAY+R,CAAC,CAAC3T,CAAF,CAAIkV,QAAJ,CAAatB,CAAC,CAAC5T,CAAf,CAAZ,CAAP;AACD,OAnII;AAoIL,aAAK,aAASA,CAAT,EAAY;AACf,YAAGA,CAAC,CAACgH,CAAF,KAAQ,KAAR,IAAiBhH,CAAC,CAACA,CAAF,CAAId,OAAJ,CAAY,IAAZ,IAAkB,CAAtC,EAAyC,OAAO0C,GAAG,CAACG,MAAJ,CAAW8M,GAAX,CAAP;AACzC7O,SAAC,GAAG0Q,IAAI,CAAC1Q,CAAD,CAAR;AACA,YAAGA,CAAC,CAACd,OAAF,CAAU,IAAV,IAAgB,CAAnB,EAAsB,OAAO0C,GAAG,CAACG,MAAJ,CAAW,CAAX,CAAP;AACtB,eAAOH,GAAG,CAACG,MAAJ,CAAWkG,QAAQ,CAACjI,CAAD,EAAI,EAAJ,CAAnB,CAAP;AACD,OAzII;AA0IL+T,UAAI,EAAE,gBAAW;AACf,YAAIoB,KAAK,GAAGlR,SAAS,CAAC,CAAD,CAArB;AACA,YAAGA,SAAS,CAACnD,MAAV,GAAiB,CAApB,EAAuB,OAAOc,GAAG,CAACC,MAAJ,CAAW,EAAX,CAAP;;AACvB,YAAGoC,SAAS,CAACnD,MAAV,GAAiB,CAApB,EAAuB;AACrB,cAAIgT,GAAG,GAAG,EAAV;;AACA,eAAK,IAAI7S,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgD,SAAS,CAACnD,MAA9B,EAAsCG,CAAC,EAAvC,EAA0C;AACxC6S,eAAG,CAAC5T,IAAJ,CAAS+D,SAAS,CAAChD,CAAD,CAAT,CAAajB,CAAtB;AACD;;AACD,iBAAO4B,GAAG,CAACC,MAAJ,CAAWiS,GAAG,CAACC,IAAJ,CAASrD,IAAI,CAACyE,KAAD,CAAb,CAAX,CAAP;AACD;;AACD,eAAOvT,GAAG,CAACC,MAAJ,CAAWoC,SAAS,CAAC,CAAD,CAAT,CAAajE,CAAb,CAAe+T,IAAf,CAAoBrD,IAAI,CAACyE,KAAD,CAAxB,CAAX,CAAP;AACD,OArJI;AAsJLC,SAAG,EAAE,aAAS/V,CAAT,EAAY;AAAE,eAAOuC,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAAC6V,GAAL,CAAS/V,CAAC,CAACW,CAAX,CAAX,CAAP;AAAmC,OAtJjD;AAuJLqV,WAAK,EAAE,eAAShW,CAAT,EAAY;AAAE,eAAOuC,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAAC8V,KAAL,CAAWhW,CAAC,CAACW,CAAb,CAAX,CAAP;AAAqC,OAvJrD;AAwJLyP,SAAG,EAAE,eAAW;AACd,YAAGxL,SAAS,CAACnD,MAAV,GAAmB,CAAtB,EAAyB;AACvB,cAAIgT,GAAG,GAAG,EAAV;;AACA,eAAK,IAAIjJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG5G,SAAS,CAACnD,MAA9B,EAAsC+J,CAAC,EAAvC,EAA0C;AACxCiJ,eAAG,CAAC5T,IAAJ,CAAS+D,SAAS,CAAC4G,CAAD,CAAT,CAAa7K,CAAtB;AACD;;AACD,iBAAO4B,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAACkQ,GAAL,CAASzL,KAAT,CAAe,IAAf,EAAqB8P,GAArB,CAAX,CAAP;AACD;;AACD,YAAIrE,GAAJ,EAASxO,CAAT;AACA,YAAI5B,CAAC,GAAG4E,SAAS,CAAC,CAAD,CAAT,CAAajE,CAArB;AACA,YAAG,EAAEiB,CAAC,GAAC5B,CAAC,CAACyB,MAAN,CAAH,EAAkB,OAAOc,GAAG,CAACG,MAAJ,CAAW8M,GAAX,CAAP;AAClBY,WAAG,GAAGnE,UAAU,CAACjM,CAAC,CAAC,CAAD,CAAF,CAAhB;;AACA,eAAM,EAAE4B,CAAR;AAAWwO,aAAG,GAAGlQ,IAAI,CAACkQ,GAAL,CAASA,GAAT,EAAcnE,UAAU,CAACjM,CAAC,CAAC4B,CAAD,CAAF,CAAxB,CAAN;AAAX;;AACA,eAAOW,GAAG,CAACG,MAAJ,CAAW0N,GAAX,CAAP;AACD,OAtKI;AAuKLD,SAAG,EAAE,eAAW;AACd,YAAGvL,SAAS,CAACnD,MAAV,GAAmB,CAAtB,EAAyB;AACvB,cAAIgT,GAAG,GAAG,EAAV;;AACA,eAAK,IAAIjJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG5G,SAAS,CAACnD,MAA9B,EAAsC+J,CAAC,EAAvC,EAA0C;AACxCiJ,eAAG,CAAC5T,IAAJ,CAAS+D,SAAS,CAAC4G,CAAD,CAAT,CAAa7K,CAAtB;AACD;;AACD,iBAAO4B,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAACiQ,GAAL,CAASxL,KAAT,CAAe,IAAf,EAAqB8P,GAArB,CAAX,CAAP;AACD;;AACD,YAAItE,GAAJ,EAASvO,CAAT;AACA,YAAI5B,CAAC,GAAG4E,SAAS,CAAC,CAAD,CAAT,CAAajE,CAArB;AACA,YAAG,EAAEiB,CAAC,GAAC5B,CAAC,CAACyB,MAAN,CAAH,EAAkB,OAAOc,GAAG,CAACG,MAAJ,CAAW8M,GAAX,CAAP;AAClBW,WAAG,GAAGlE,UAAU,CAACjM,CAAC,CAAC,CAAD,CAAF,CAAhB;;AACA,eAAM,EAAE4B,CAAR;AAAWuO,aAAG,GAAGjQ,IAAI,CAACiQ,GAAL,CAASA,GAAT,EAAclE,UAAU,CAACjM,CAAC,CAAC4B,CAAD,CAAF,CAAxB,CAAN;AAAX;;AACA,eAAOW,GAAG,CAACG,MAAJ,CAAWyN,GAAX,CAAP;AACD,OArLI;AA8LL8F,SAAG,EAAE,aAASjW,CAAT,EAAY;AACf,YAAG4E,SAAS,CAACnD,MAAV,KAAqB,CAAxB,EAA2B,MAAM2F,YAAN;AAC3B,YAAGxC,SAAS,CAACnD,MAAV,GAAmB,CAAtB,EAAyB,MAAM0F,aAAN;AACzB,eAAO5E,GAAG,WAAH,CAAY,CAACvC,CAAC,CAACW,CAAf,CAAP;AACD,OAlMI;AAmMLuV,SAAG,EAAE,aAAS9U,EAAT,EAAa;AAChB,eAAOuS,aAAa,CAACvS,EAAD,CAApB;AACD,OArMI;AAsMLgU,WAAK,EAAE,eAAShU,EAAT,EAAa;AAClB,YAAIpB,CAAC,GAAG2T,aAAa,CAACvS,EAAD,EAAK,CAACY,MAAM,CAACxB,yBAAb,CAArB;;AACA,YAAGY,EAAE,KAAKoC,WAAW,CAAC6E,WAAnB,IAAkC,CAACrG,MAAM,CAACzB,yBAA7C,EAAwE;AACtEP,WAAC,CAACW,CAAF,GAAMX,CAAC,CAACW,CAAF,CAAIZ,KAAJ,CAAU,GAAV,EAAe,CAAf,CAAN;AACD;;AACD,eAAOC,CAAP;AACD,OA5MI;AAmNLmW,UAAI,EAAE,cAAS7R,IAAT,EAAetE,CAAf,EAAkB;AACtB,YAAGsE,IAAI,CAAC3D,CAAL,CAAOc,MAAP,IAAiB6C,IAAI,CAAC3D,CAAL,CAAO,CAAP,EAAUc,MAA9B,EAAsC;AACpC,iBAAOc,GAAG,CAACC,MAAJ,CAAW8B,IAAI,CAAC3D,CAAL,CAAO,CAAP,CAAX,CAAP;AACD;;AACD,YAAGX,CAAC,CAACW,CAAF,IAAOyV,QAAV,EAAoB,OAAO7T,GAAG,CAACC,MAAJ,CAAW,EAAX,CAAP;AACpB,YAAGxC,CAAC,CAAC2H,CAAF,KAAQ,KAAR,IAAiB3H,CAAC,CAACW,CAAF,KAAQ,CAA5B,EAA+B,OAAO4B,GAAG,CAACC,MAAJ,CAAW,EAAX,CAAP;AAC/B,eAAOD,GAAG,CAACC,MAAJ,CAAWxC,CAAC,CAACW,CAAb,CAAP;AACD,OA1NI;AA2NL0V,QAAE,EAAE,cAAW;AAAE,eAAO9T,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAACoW,EAAhB,CAAP;AAA6B,OA3NzC;AA4NLC,cAAQ,EAAE,kBAASvW,CAAT,EAAY;AACpB,YAAIuW,QAAQ,GAAG,CAAf;;AACA,YAAGvW,CAAH,EAAM;AACJ,cAAIsE,IAAI,GAAGtE,CAAC,CAACY,WAAF,EAAX;AACA,cAAIwN,QAAQ,GAAG9J,IAAI,CAACkS,OAApB;;AACA,iBAAOlS,IAAI,CAACmS,sBAAL,IAA+BnS,IAAI,CAACmS,sBAAL,CAA4BD,OAA5B,KAAwCpI,QAA9E,EAAwF;AACtF9J,gBAAI,GAAGA,IAAI,CAACmS,sBAAZ;AACAF,oBAAQ;AACT;AACF;;AACD,eAAOhU,GAAG,CAACG,MAAJ,CAAW6T,QAAX,CAAP;AACD,OAvOI;AAwOLb,SAAG,EAAE,aAAS3P,CAAT,EAAYmO,CAAZ,EAAe;AAAE,eAAO3R,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAACwV,GAAL,CAAStE,MAAM,CAACrL,CAAD,CAAf,EAAoBqL,MAAM,CAAC8C,CAAD,CAA1B,CAAX,CAAP;AAAoD,OAxOrE;AAyOL1G,YAAM,EAAE,kBAAW;AAAE,eAAOjL,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAACsN,MAAL,EAAX,CAAP;AAAmC,OAzOnD;AA0OLkJ,eAAS,EAAE,mBAAS1W,CAAT,EAAY;AACrB,YAAG4E,SAAS,CAACnD,MAAV,KAAqB,CAAxB,EAA2B,MAAM2F,YAAN;AAC3B,YAAGxC,SAAS,CAACnD,MAAV,GAAmB,CAAtB,EAAyB,MAAM0F,aAAN;AAEzB,YAAI8F,IAAI,GAAGrI,SAAS,CAACnD,MAAV,GAAmB,CAAnB,GAAuBmD,SAAS,CAAC,CAAD,CAAhC,GAAsCA,SAAS,CAAC,CAAD,CAA1D;AACA,YAAIxD,EAAE,GAAGwD,SAAS,CAACA,SAAS,CAACnD,MAAV,GAAmB,CAApB,CAAlB;;AAEA,YAAGL,EAAE,KAAKoC,WAAW,CAACqE,YAAtB,EAAoC;AAClC,iBAAOtF,GAAG,WAAH,CAAYvC,CAAC,CAACW,CAAF,CAAIc,MAAJ,GAAa,CAAb,GAAiB,IAAjB,GAAwB,KAApC,CAAP;AACD;;AACD,YAAGL,EAAE,KAAKoC,WAAW,CAAC6E,WAAtB,EAAmC;AACjC,cAAIrI,CAAC,CAACW,CAAF,CAAIc,MAAJ,GAAa,CAAjB,EAAoB,OAAO,EAAP;AACpB,iBAAOc,GAAG,CAACC,MAAJ,CAAWxC,CAAC,CAACW,CAAF,CAAI,CAAJ,CAAX,CAAP;AACD;;AAED,YAAG+H,KAAK,CAACC,OAAN,CAAcsE,IAAd,KAAuBA,IAAI,CAACxL,MAA5B,IAAsCwL,IAAI,CAAC,CAAD,CAAJ,CAAQlD,QAAR,KAAqB,CAA9D,EAAiE;AAC/D,iBAAO,CAAC/J,CAAD,EAAI4I,QAAQ,CAACqE,IAAI,CAAC,CAAD,CAAJ,CAAQjF,WAAT,CAAZ,CAAP;AACD;;AACD,eAAO,CAAChI,CAAD,EAAIiN,IAAI,IAAIA,IAAI,CAACtM,CAAjB,CAAP;AACD,OA7PI;AA8PLgW,WAAK,EAAE,eAASC,QAAT,EAAmBC,OAAnB,EAA4B;AAC/B,eAAOtU,GAAG,WAAH,CAAY,IAAIuU,MAAJ,CAAWzF,IAAI,CAACwF,OAAD,CAAf,EAA0BvO,IAA1B,CAA+B+I,IAAI,CAACuF,QAAD,CAAnC,CAAZ,CAAP;AAAqE,OA/PpE;AAgQLzW,WAAK,EAAE,eAASuC,MAAT,EAAiBqU,UAAjB,EAA6B;AAClC,YAAGnS,SAAS,CAACnD,MAAV,KAAqB,CAAxB,EAA2B,MAAM2F,YAAN;AAC3B,YAAGxC,SAAS,CAACnD,MAAV,GAAmB,CAAtB,EAAyB,MAAM0F,aAAN;AACzBzE,cAAM,GAAG0O,MAAM,CAAC1O,MAAD,CAAf;;AACA,YAAG,CAACqU,UAAJ,EAAgB;AACd,iBAAOxU,GAAG,CAACG,MAAJ,CAAWgP,MAAM,CAAChP,MAAD,CAAjB,CAAP;AACD;;AACDqU,kBAAU,GAAG5F,IAAI,CAAC4F,UAAD,CAAjB;AACA,YAAIrB,GAAG,GAAGxV,IAAI,CAACwV,GAAL,CAAS,EAAT,EAAaxV,IAAI,CAAC+F,GAAL,CAAS8Q,UAAT,CAAb,CAAV;;AACA,YAAGA,UAAU,GAAG,CAAhB,EAAmB;AACjB,iBAAOxU,GAAG,CAACG,MAAJ,CAAWgP,MAAM,CAAChP,MAAM,GAAGgT,GAAV,CAAN,GAAuBA,GAAlC,CAAP;AACD,SAFD,MAEO;AACL,iBAAOnT,GAAG,CAACG,MAAJ,CAAWgT,GAAG,GAAGhE,MAAM,CAAChP,MAAM,GAAGgT,GAAV,CAAvB,CAAP;AACD;AACF,OA9QI;AA+QLsB,cAAQ,EAAE,kBAASJ,QAAT,EAAmBK,MAAnB,EAA2B;AACnC,eAAO1U,GAAG,WAAH,CAAY8O,IAAI,CAACuF,QAAD,CAAJ,CAAe7W,KAAf,CAAqB,GAArB,EAA0BF,OAA1B,CAAkCwR,IAAI,CAAC4F,MAAD,CAAJ,CAAatK,IAAb,EAAlC,MAA2D,CAAC,CAAxE,CAAP;AACD,OAjRI;AAkRL,qBAAe,oBAASuK,IAAT,EAAeC,KAAf,EAAsB;AACnC,YAAG,CAACA,KAAJ,EAAW,MAAM,IAAIjQ,KAAJ,CAAUyD,IAAI,CAACC,SAAL,CAAesM,IAAf,CAAV,CAAN;AACX,eAAO3U,GAAG,CAACC,MAAJ,CAAW6O,IAAI,CAAC6F,IAAD,CAAJ,CAAWnX,KAAX,CAAiB,GAAjB,EAAsBoR,IAAI,CAACgG,KAAD,CAA1B,KAAsC,EAAjD,CAAP;AACD,OArRI;AAsRLC,SAAG,EAAE,aAASpX,CAAT,EAAY;AAAE,eAAOuC,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAACkX,GAAL,CAASpX,CAAC,CAACW,CAAX,CAAX,CAAP;AAAmC,OAtRjD;AAuRL0W,UAAI,EAAE,cAASrX,CAAT,EAAY;AAAE,eAAOuC,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAACmX,IAAL,CAAUrX,CAAC,CAACW,CAAZ,CAAX,CAAP;AAAoC,OAvRnD;AAwRL2W,YAAM,EAAE,gBAAS9U,MAAT,EAAiB+U,UAAjB,EAA6BC,QAA7B,EAAuC;AAC7C,eAAOjV,GAAG,CAACC,MAAJ,CAAW6O,IAAI,CAAC7O,MAAD,CAAJ,CAAaiV,KAAb,CACdtG,IAAI,CAACoG,UAAD,CADU,EAEdC,QAAQ,IAAIrG,IAAI,CAACqG,QAAD,CAFF,CAAX,CAAP;AAGD,OA5RI;AA6RLE,SAAG,EAAE,aAAS1X,CAAT,EAAY;AACf,YAAG4E,SAAS,CAACnD,MAAV,GAAmB,CAAtB,EAAyB,MAAM0F,aAAN;AACzB,YAAIsN,GAAG,GAAG,CAAV;;AACA,aAAK,IAAI7S,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG5B,CAAC,CAACW,CAAF,CAAIc,MAAxB,EAAgCG,CAAC,EAAjC,EAAqC;AACnC,cAAG,CAACoP,UAAU,CAAC1I,IAAX,CAAgBtI,CAAC,CAACW,CAAF,CAAIiB,CAAJ,CAAhB,CAAJ,EAA6BW,GAAG,CAACG,MAAJ,CAAW8M,GAAX;AAC7BiF,aAAG,IAAI7L,QAAQ,CAAC5I,CAAC,CAACW,CAAF,CAAIiB,CAAJ,CAAD,EAAS,EAAT,CAAf;AACD;;AACD,eAAOW,GAAG,CAACG,MAAJ,CAAW+R,GAAX,CAAP;AACD,OArSI;AAsSLkD,SAAG,EAAE,aAAS3X,CAAT,EAAY;AAAE,eAAOuC,GAAG,CAACG,MAAJ,CAAWxC,IAAI,CAACyX,GAAL,CAAS3X,CAAC,CAACW,CAAX,CAAX,CAAP;AAAmC,OAtSjD;AAuSL,cAAQ,eAASS,EAAT,EAAa;AACnB,YAAGA,EAAE,KAAKoC,WAAW,CAACkE,WAAtB,EAAmC,OAAOnF,GAAG,CAACG,MAAJ,CAAW,CAAX,CAAP;AACnC,YAAGkC,SAAS,CAACnD,MAAV,GAAiB,CAApB,EAAuB,MAAM0F,aAAN;AACvB,eAAO5E,GAAG,WAAH,CAAY,IAAZ,CAAP;AACD,OA3SI;AA4SL2P,UAAI,EAAE,cAASlS,CAAT,EAAY;AAChB,YAAGA,CAAC,IAAIA,CAAC,CAACW,CAAV,EAAa,OAAO4B,GAAG,CAACC,MAAJ,CAAWqO,WAAW,CAAC7Q,CAAC,CAACW,CAAH,CAAtB,CAAP;AACb,eAAO4B,GAAG,CAACC,MAAJ,CAAW0P,KAAI,EAAf,CAAP;AACD,OA/SI;AAgTL,4BAAsB,2BAAS/B,GAAT,EAAcC,GAAd,EAAmB;AACvC,YAAIxO,CAAJ;AAAA,YAAOgW,MAAM,GAAG,EAAhB;AAAA,YAAoBC,OAAO,GAAG,EAA9B;AAAA,YAAkCC,aAAa,GAAG,CAAlD;AACA3H,WAAG,GAAGA,GAAG,CAACxP,CAAV;AACAyP,WAAG,GAAGA,GAAG,CAACzP,CAAV;;AACA,aAAKiB,CAAC,GAAC,CAAP,EAAWA,CAAC,GAAGgD,SAAS,CAACnD,MAAzB,EAAkCG,CAAC,GAACA,CAAC,GAAC,CAAtC,EAAyC;AACvC,cAAIjB,CAAC,GAAGiE,SAAS,CAAChD,CAAD,CAAjB;AACA,cAAImW,CAAC,GAAGnT,SAAS,CAAChD,CAAC,GAAC,CAAH,CAAjB;;AACA,cAAIjB,CAAC,IAAIoX,CAAT,EAAY;AAEVH,kBAAM,CAAC/W,IAAP,CAAYF,CAAC,CAACgH,CAAF,KAAQ,KAAR,GAAgBhH,CAAC,CAACA,CAAF,CAAI,CAAJ,CAAhB,GAAyBA,CAAC,CAACA,CAAvC;AACAkX,mBAAO,CAAChX,IAAR,CAAakX,CAAC,CAACpQ,CAAF,KAAQ,KAAR,GAAgBoQ,CAAC,CAACpX,CAAF,CAAI,CAAJ,CAAhB,GAAyBoX,CAAC,CAACpX,CAAxC;AACD;AACF;;AAED,aAAIiB,CAAC,GAAC,CAAN,EAASA,CAAC,GAAGgW,MAAM,CAACnW,MAApB,EAA4BG,CAAC,EAA7B,EAAiC;AAC/B,cAAG8N,OAAO,CAACkI,MAAM,CAAChW,CAAD,CAAP,CAAV,EAAuB;AACrBkW,yBAAa,IAAID,OAAO,CAACjW,CAAD,CAAxB;AACD;AACF;;AACD,eAAOW,GAAG,WAAH,CAAY,CAAC4N,GAAG,GAAG,CAAN,IAAW2H,aAAa,IAAI3H,GAA7B,MAAsCC,GAAG,GAAG,CAAN,IAAW0H,aAAa,IAAI1H,GAAlE,CAAZ,CAAP;AACD;AApUI,KAAP;AAwUApN,QAAI,CAAC,WAAD,CAAJ,GAAoBA,IAAI,CAACH,IAAzB;AACAG,QAAI,CAAC,mBAAD,CAAJ,GAA4BA,IAAI,CAAC,cAAD,CAAhC;AACAA,QAAI,CAAC,kBAAD,CAAJ,GAA2BA,IAAI,CAAC,aAAD,CAA/B;AAEAwE,WAAO,GAAG;AACNU,sBAAgB,EAAE,0BAASlI,CAAT,EAAY;AAC5B,YAAGA,CAAC,CAAC2H,CAAF,KAAQ,MAAX,EAAmB,OAAO;AACxBpG,oBAAU,EAACiC,WAAW,CAAC6E,WADC;AAQxBT,qBAAW,EAAC5H,CAAC,CAACW,CAAF,CAAIV,OAAJ,EARY;AASxBgI,qBAAW,EAACqJ,aAAa,CAACtR,CAAC,CAACW,CAAH;AATD,SAAP;AAWpB,OAbK;AAcN8I,aAAO,EAAE,iBAASlB,GAAT,EAAc;AACrB,YAAGA,GAAG,YAAYzI,IAAlB,EAAwB,OAAO,MAAP;AACzB,OAhBK;AAiBNqL,iBAAW,EAAE,qBAASV,GAAT,EAAcO,GAAd,EAAmBC,EAAnB,EAAuBC,GAAvB,EAA4B;AACvC,YAAGF,GAAG,CAACrD,CAAJ,KAAU,MAAV,IAAoBuD,GAAG,CAACvD,CAAJ,KAAU,MAAjC,EAAyC;AAGvC,cAAIsD,EAAE,CAACtK,CAAH,KAAS,GAAT,IACAsK,EAAE,CAACtK,CAAH,KAAS,GADT,IAEAsK,EAAE,CAACtK,CAAH,KAAS,GAFT,IAGAsK,EAAE,CAACtK,CAAH,KAAS,IAHT,IAIAsK,EAAE,CAACtK,CAAH,KAAS,IAJT,IAKAsK,EAAE,CAACtK,CAAH,KAAS,IALb,EAKmB;AACjB,gBAAGqK,GAAG,CAACrD,CAAJ,KAAU,KAAV,IAAmBqD,GAAG,CAACrD,CAAJ,KAAU,KAAhC,EAAuCqD,GAAG,GAAGnI,IAAI,CAACmI,GAAD,CAAV;AACvC,gBAAGE,GAAG,CAACvD,CAAJ,KAAU,KAAV,IAAmBuD,GAAG,CAACvD,CAAJ,KAAU,KAAhC,EAAuCuD,GAAG,GAAGrI,IAAI,CAACqI,GAAD,CAAV;;AACvC,gBAAGF,GAAG,CAACrD,CAAJ,KAAU,MAAV,IAAoBuD,GAAG,CAACvD,CAAJ,KAAU,MAAjC,EAAyC;AACvC,qBAAOsD,EAAE,CAACtK,CAAH,KAAS,IAAhB;AACD,aAFD,MAEO;AACLqK,iBAAG,GAAG;AAAErD,iBAAC,EAAC,KAAJ;AAAWhH,iBAAC,EAACqK,GAAG,CAACrK,CAAJ,CAAMV,OAAN;AAAb,eAAN;AACAiL,iBAAG,GAAG;AAAEvD,iBAAC,EAAC,KAAJ;AAAWhH,iBAAC,EAACuK,GAAG,CAACvK,CAAJ,CAAMV,OAAN;AAAb,eAAN;AACD;AACF,WAdD,MAcO,IAAGgL,EAAE,CAACtK,CAAH,KAAS,GAAT,IAAgBsK,EAAE,CAACtK,CAAH,KAAS,GAA5B,EAAiC;AAEtC,gBAAGqK,GAAG,CAACrD,CAAJ,KAAU,MAAV,IAAoBuD,GAAG,CAACvD,CAAJ,KAAU,MAAjC,EAAyC8C,GAAG;AAC5C,gBAAI/K,CAAC,GAAGsL,GAAG,CAACrD,CAAJ,KAAU,MAAV,GAAkBqD,GAAG,CAACrK,CAAtB,GAAyBuK,GAAG,CAACvK,CAArC;AAAA,gBACID,CAAC,GAAGsK,GAAG,CAACrD,CAAJ,KAAU,MAAV,GAAkBwJ,IAAI,CAACnG,GAAD,CAAtB,GAA6BmG,IAAI,CAACjG,GAAD,CADzC;AAAA,gBAEI/C,GAAG,GAAG,IAAIrI,IAAJ,CAASJ,CAAC,CAACO,OAAF,EAAT,CAFV;AAGA,gBAAGgL,EAAE,CAACtK,CAAH,KAAS,GAAZ,EAAiBD,CAAC,GAAG,CAACA,CAAL;AACjByH,eAAG,CAAC6J,OAAJ,CAAYtS,CAAC,CAAC+R,OAAF,KAAc/Q,CAA1B;AACA,mBAAOyH,GAAP;AACD;;AACD,iBAAO;AAAER,aAAC,EAAC,UAAJ;AAAgBqD,eAAG,EAACA,GAApB;AAAyBC,cAAE,EAACA,EAA5B;AAAgCC,eAAG,EAACA;AAApC,WAAP;AACD;AACF;AA/CK,KAAV;AAkDAwI,OAAG,CAAC1Q,IAAJ,GAAWA,IAAX;AACA0Q,OAAG,CAAClM,OAAJ,GAAcA,OAAd;AACAkM,OAAG,CAACnR,GAAJ,GAAUA,GAAV;;AACAmR,OAAG,CAACG,IAAJ,GAAW,UAASD,SAAT,EAAoB;AAC7B,UAAIjM,CAAC,GAAG,IAAI7H,IAAJ,EAAR;;AACA,UAAG8T,SAAH,EAAc;AACZ,eAAO,IAAI9T,IAAJ,CAAS6H,CAAC,CAAC4J,WAAF,EAAT,EAA0B5J,CAAC,CAAC6J,QAAF,EAA1B,EAAwC7J,CAAC,CAAC8J,OAAF,EAAxC,CAAP;AACD;;AACD,aAAO9J,CAAP;AACD,KAND;;AAQA,WAAO+L,GAAP;AACD,GA9iBD;;AAgjBAtT,QAAM,CAACC,OAAP,GAAiByQ,yBAAjB;;;;;;;;;;;;;;;;;ACpjBA,MAAIkH,8BAA8B,GAAG,OAArC;AACA,MAAI9C,SAAS,GAAG,GAAhB;;AAEA,WAAS+C,UAAT,CAAoBC,SAApB,EAA+B;AAC7B,WAAOA,SAAS,CAACC,GAAV,CAAc,UAAUC,QAAV,EAAoB;AACvC,aAAOA,QAAQ,CAACzL,IAAT,GAAgB5M,KAAhB,CAAsB,GAAtB,CAAP;AACD,KAFM,CAAP;AAGD;;AAGD,WAASsY,UAAT,CAAoBC,KAApB,EAA2B;AACzB,WAAOA,KAAK,GAAGpY,IAAI,CAACoW,EAAb,GAAkB,GAAzB;AACD;;AAGD,WAASiC,aAAT,CAAuBC,OAAvB,EAAgC;AAC9B,WAAOA,OAAO,CAACC,KAAR,CAAc,UAAUC,MAAV,EAAkB;AACrC,aACGA,MAAM,CAAC,CAAD,CAAN,KAAc,EAAd,IAAoBA,MAAM,CAAC,CAAD,CAAN,IAAa,CAAC,EAAlC,IAAwCA,MAAM,CAAC,CAAD,CAAN,IAAa,EAAtD,IACCA,MAAM,CAAC,CAAD,CAAN,KAAc,EAAd,IAAoBA,MAAM,CAAC,CAAD,CAAN,IAAa,CAAC,GAAlC,IAAyCA,MAAM,CAAC,CAAD,CAAN,IAAa,GADvD,KAEC,OAAOA,MAAM,CAAC,CAAD,CAAb,IAAoB,WAApB,IAAmC,CAAC5O,KAAK,CAAC4O,MAAM,CAAC,CAAD,CAAP,CAF1C,MAGC,OAAOA,MAAM,CAAC,CAAD,CAAb,IAAoB,WAApB,IAAoC,CAAC5O,KAAK,CAAC4O,MAAM,CAAC,CAAD,CAAP,CAAN,IAAqBA,MAAM,CAAC,CAAD,CAAN,IAAa,CAHvE,CADF;AAMD,KAPM,CAAP;AAQD;;AASD,WAASC,gBAAT,CAA0BC,EAA1B,EAA6BC,EAA7B,EAAiC;AAC/B,QAAIC,EAAE,GAAGT,UAAU,CAACO,EAAE,CAACG,GAAH,GAASF,EAAE,CAACE,GAAb,CAAnB;;AACA,QAAIC,EAAE,GAAGX,UAAU,CAACO,EAAE,CAACK,GAAJ,CAAnB;;AACA,QAAIC,EAAE,GAAGb,UAAU,CAACQ,EAAE,CAACI,GAAJ,CAAnB;;AACA,WAAO/Y,IAAI,CAAC4T,IAAL,CAAU5T,IAAI,CAACkX,GAAL,CAAS4B,EAAT,IAAe9Y,IAAI,CAACkX,GAAL,CAAS8B,EAAT,CAAf,GAA8BhZ,IAAI,CAACyU,GAAL,CAASqE,EAAT,IAAe9Y,IAAI,CAACyU,GAAL,CAASuE,EAAT,CAAf,GAA8BhZ,IAAI,CAACyU,GAAL,CAASmE,EAAT,CAAtE,IAAsFd,8BAA7F;AACD;;AAED,WAASrH,cAAT,CAAwBwI,GAAxB,EAA6BC,EAA7B,EAAiCpZ,CAAjC,EAAoC;AAClC,QAAIkY,SAAS,GAAG,EAAhB;AACA,QAAGlY,CAAC,CAAC2H,CAAF,KAAQ,KAAX,EAAkBuQ,SAAS,GAAGlY,CAAC,CAACW,CAAF,CAAIZ,KAAJ,CAAU,GAAV,CAAZ;;AAClB,QAAGC,CAAC,CAAC2H,CAAF,KAAQ,KAAX,EAAkB;AAChB,UAAG3H,CAAC,CAACW,CAAF,CAAIc,MAAJ,KAAe,CAAlB,EAAqByW,SAAS,GAAGlY,CAAC,CAACW,CAAF,CAAI,CAAJ,EAAOZ,KAAP,CAAa,GAAb,CAAZ,CAArB,KACKmY,SAAS,GAAGlY,CAAC,CAACW,CAAd;AACN;;AACD,WAAOwY,GAAG,CAACC,EAAE,CAAClB,SAAD,CAAH,CAAV;AACD;;AAKD,WAASzH,IAAT,CAAcyH,SAAd,EAAyB;AACvB,QAAIM,OAAO,GAAGP,UAAU,CAACC,SAAD,CAAxB;;AAEA,QAAI,CAACK,aAAa,CAACC,OAAD,CAAlB,EAA6B;AAC3B,aAAOvP,MAAM,CAACuG,GAAd;AACD;;AAED,QAAI6J,WAAW,GAAGb,OAAO,CAAC/W,MAA1B;AACA,QAAIgP,IAAI,GAAG,GAAX;;AAEA,QAAI4I,WAAW,GAAG,CAAlB,EAAqB;AACnB,WAAK,IAAIzX,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyX,WAApB,EAAiCzX,CAAC,EAAlC,EAAsC;AACpC,YAAIgX,EAAE,GAAG;AACPK,aAAG,EAAET,OAAO,CAAC5W,CAAD,CAAP,CAAW,CAAX,CADE;AAEPmX,aAAG,EAAEP,OAAO,CAAC5W,CAAD,CAAP,CAAW,CAAX;AAFE,SAAT;AAIA,YAAIiX,EAAE,GAAG;AACPI,aAAG,EAAET,OAAO,CAAC,CAAC5W,CAAC,GAAG,CAAL,IAAUyX,WAAX,CAAP,CAA+B,CAA/B,CADE;AAEPN,aAAG,EAAEP,OAAO,CAAC,CAAC5W,CAAC,GAAG,CAAL,IAAUyX,WAAX,CAAP,CAA+B,CAA/B;AAFE,SAAT;AAIA5I,YAAI,IAAI4H,UAAU,CAACQ,EAAE,CAACE,GAAH,GAASH,EAAE,CAACG,GAAb,CAAV,IACH,IAAI7Y,IAAI,CAACkX,GAAL,CAASiB,UAAU,CAACO,EAAE,CAACK,GAAJ,CAAnB,CAAJ,GAAmC/Y,IAAI,CAACkX,GAAL,CAASiB,UAAU,CAACQ,EAAE,CAACI,GAAJ,CAAnB,CADhC,CAAR;AAED;;AACDxI,UAAI,GAAGA,IAAI,GAAGuH,8BAAP,GAAwCA,8BAAxC,GAAyE,GAAhF;AACD;;AACD,WAAO9X,IAAI,CAAC+F,GAAL,CAAS/F,IAAI,CAACC,KAAL,CAAWsQ,IAAI,GAAGyE,SAAlB,CAAT,IAAyCA,SAAhD;AACD;;AAMD,WAASxE,QAAT,CAAkBwH,SAAlB,EAA6B;AAC3B,QAAIM,OAAO,GAAGP,UAAU,CAACC,SAAD,CAAxB;;AAEA,QAAI,CAACK,aAAa,CAACC,OAAD,CAAlB,EAA6B;AAC3B,aAAOvP,MAAM,CAACuG,GAAd;AACD;;AAED,QAAI6J,WAAW,GAAGb,OAAO,CAAC/W,MAA1B;AACA,QAAIiP,QAAQ,GAAG,GAAf;;AAEA,QAAI2I,WAAW,GAAG,CAAlB,EAAqB;AACnB,WAAK,IAAIzX,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyX,WAApB,EAAiCzX,CAAC,EAAlC,EAAsC;AACpC,YAAIgX,EAAE,GAAG;AACPK,aAAG,EAAET,OAAO,CAAC5W,CAAC,GAAG,CAAL,CAAP,CAAe,CAAf,CADE;AAEPmX,aAAG,EAAEP,OAAO,CAAC5W,CAAC,GAAG,CAAL,CAAP,CAAe,CAAf;AAFE,SAAT;AAIA,YAAIiX,EAAE,GAAG;AACPI,aAAG,EAAET,OAAO,CAAC5W,CAAD,CAAP,CAAW,CAAX,CADE;AAEPmX,aAAG,EAAEP,OAAO,CAAC5W,CAAD,CAAP,CAAW,CAAX;AAFE,SAAT;AAKA8O,gBAAQ,IAAIiI,gBAAgB,CAACC,EAAD,EAAKC,EAAL,CAA5B;AACD;AACF;;AAED,WAAO3Y,IAAI,CAAC+F,GAAL,CAAS/F,IAAI,CAACC,KAAL,CAAWuQ,QAAQ,GAAGwE,SAAtB,CAAT,IAA6CA,SAApD;AACD;;AAED9U,QAAM,CAACC,OAAP,GAAiB;AACfoQ,QAAI,EAAJA,IADe;AAEfE,kBAAc,EAAdA,cAFe;AAGfD,YAAQ,EAARA;AAHe,GAAjB;;;;;;;;;;;;;;;;;ACjHA,MAAM4I,KAAK,GAAGzX,mBAAO,CAAC,EAAD,CAArB;;AAEA,MAAM+O,MAAM,GAAG,SAATA,MAAS,CAAClG,OAAD,EAAU4K,IAAV,EAAgBC,QAAhB,EAA6B;AAC1C7K,WAAO,GAAGA,OAAO,CAAC/J,CAAlB;AACA2U,QAAI,GAAGA,IAAI,IAAIA,IAAI,CAAC3U,CAAb,IAAkB2U,IAAI,CAAC3U,CAAL,CAAOkM,WAAP,EAAzB;AACA0I,YAAQ,GAAIA,QAAQ,IAAIA,QAAQ,CAAC5U,CAArB,IAA0B4U,QAAQ,CAAC5U,CAAT,CAAWkM,WAAX,EAA3B,IAAwD,QAAnE;;AACA,QAAG,CAACyI,IAAD,IAAS,CAAC,wCAAwChN,IAAxC,CAA6CgN,IAA7C,CAAb,EAAiE;AAC/D,YAAM,IAAIpO,KAAJ,CAAU,eAAV,CAAN;AACD;;AACD,QAAG,CAAC,iBAAiBoB,IAAjB,CAAsBiN,QAAtB,CAAJ,EAAqC;AACnC,YAAM,IAAIrO,KAAJ,CAAU,mBAAV,CAAN;AACD;;AACD,QAAMqS,EAAE,GAAGD,KAAK,CAACC,EAAN,CAASjE,IAAI,CAAC9P,OAAL,CAAa,GAAb,EAAkB,EAAlB,CAAT,EAAgCgU,MAAhC,EAAX;AACAD,MAAE,CAACE,MAAH,CAAU/O,OAAV;AACA,QAAMgP,UAAU,GAAGH,EAAE,CAAC3I,MAAH,EAAnB;;AACA,QAAG,CAAC2E,QAAD,IAAaA,QAAQ,KAAK,QAA7B,EAAuC;AACrC,aAAO+D,KAAK,CAACK,IAAN,CAAWC,QAAX,CAAoBF,UAAU,CAACG,KAAX,EAApB,CAAP;AACD;;AACD,WAAON,EAAE,CAAC3I,MAAH,GAAYkJ,KAAZ,EAAP;AACD,GAjBD;;AAmBA1Z,QAAM,CAACC,OAAP,GAAiB;AACfuQ,UAAM,EAANA;AADe,GAAjB;;;;;;;ACrBA,iD;;;;;;;;;;;;;;;;ACAA,WAASmJ,cAAT,GAA0B;AACxB,WAAO7Z,IAAI,CAACsN,MAAL,GAAcpI,QAAd,CAAuB,EAAvB,EAA2B+E,SAA3B,CAAqC,CAArC,CAAP;AACD;;AAED,WAAS0G,WAAT,CAAqBpP,MAArB,EAA6B;AAC5B,QAAIuY,KAAK,GAAG9Z,IAAI,CAAC+Z,IAAL,CAAUxY,MAAM,GAAG,EAAnB,CAAZ;AACA,WAAO,IAAIiH,KAAJ,CAAUsR,KAAV,EACHE,IADG,CACEH,cADF,EAEHI,MAFG,CAEI,UAAC3X,MAAD,EAASQ,IAAT,EAAkB;AACxB,aAAOR,MAAM,GAAGQ,IAAI,EAApB;AACD,KAJG,EAID,EAJC,EAIGmH,SAJH,CAIa,CAJb,EAIgB1I,MAJhB,CAAP;AAKA;;AAEDrB,QAAM,CAACC,OAAP,GAAiB;AACfwQ,eAAW,EAAXA;AADe,GAAjB","file":"orxe.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"node-forge\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"orxe\", [\"node-forge\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"orxe\"] = factory(require(\"node-forge\"));\n\telse\n\t\troot[\"orxe\"] = factory(root[\"node-forge\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__15__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n","var DATE_STRING = /^\\d\\d\\d\\d-\\d{1,2}-\\d{1,2}(?:T\\d\\d:\\d\\d:\\d\\d\\.?\\d?\\d?(?:Z|[+-]\\d\\d:\\d\\d)|.*)?$/;\n\nfunction dateToDays(d, rounded) {\n  var temp = null;\n  if(d.indexOf('T') > 0) {\n    temp = new Date(d);\n  } else {\n    temp = d.split('-');\n    temp = new Date(temp[0], temp[1]-1, temp[2]);\n  }\n  var r = (temp.getTime()) / (1000 * 60 * 60 * 24);\n  return rounded === false ? r : Math.round(r*100000)/100000;\n}\n\nmodule.exports = {\n  DATE_STRING,\n  dateToDays\n};\n","module.exports = {\n  allowStringComparison: true,\n  includeTimeForTodayString: false,\n  returnCurrentTimeForToday: true\n};\n","function toNodes(r) {\n  var n, v = [];\n  while((n = r.iterateNext())) v.push(n);\n  return v;\n}\n\nfunction getNamespaceAtts(result) {\n  var v = [], n;\n  while((n = result.iterateNext())) {\n    if(n.name.indexOf(':')>0) v.unshift(n);\n  }\n  return v;\n}\n\nfunction toSnapshotResult(nodes, rt, singleItem) {\n  return function() {\n    var idx = 0;\n    return {\n      resultType: rt,\n      singleNodeValue: nodes.length ? singleItem || nodes[0] : null,\n      snapshotLength: nodes.length,\n      snapshotItem: function(i){return nodes[i];},\n      iterateNext: function(){return nodes.length > idx ? nodes[idx++] : null;}\n    };\n  }();\n}\n\nmodule.exports = {\n  getNamespaceAtts,\n  toNodes,\n  toSnapshotResult\n};\n","module.exports = require('./engine');\n","require('./date-extensions');\r\nvar ExtendedXpathEvaluator = require('./extended-xpath');\r\nvar openrosaExtensions = require('./openrosa-extensions');\r\nvar config = require('./config');\r\nvar extensions = openrosaExtensions(config);\r\n\r\nmodule.exports = (function(){\r\n\r\n  var module = {\r\n    extendedXpathEvaluator: ExtendedXpathEvaluator,\r\n    openrosaXpathExtensions: openrosaExtensions,\r\n    config: config,\r\n    customXPathFunction: {\r\n\t\t\ttype: {\r\n\t\t\t\tStringType: extensions.XPR.string,\r\n\t\t\t\tNumberType: extensions.XPR.number,\r\n\t\t\t\tBooleanType: extensions.XPR.boolean,\r\n\t\t\t\tDateType: extensions.XPR.date\r\n\t\t\t},\r\n\t\t\tadd: function(name, fnObj) {\r\n\t\t\t\textensions.func[name] = fnObj;\r\n\t\t\t},\r\n\t\t\tremove: function(name) {\r\n\t\t\t\tdelete extensions.func[name];\r\n\t\t\t},\r\n      all: function() {\r\n        return extensions.func;\r\n      }\r\n\t\t},\r\n\r\n    /**\r\n\t\t * Get the current list of DOM Level 3 XPath window and document objects\r\n\t\t * that are in use.\r\n\t\t *\r\n\t\t * @return {Object} List of DOM Level 3 XPath window and document objects\r\n\t\t *         that are currently in use.\r\n\t\t */\r\n\t\tgetCurrentDomLevel3XPathBindings: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\t'window': {\r\n\t\t\t\t\tXPathException: window.XPathException,\r\n\t\t\t\t\tXPathExpression: window.XPathExpression,\r\n\t\t\t\t\tXPathNSResolver: window.XPathNSResolver,\r\n\t\t\t\t\tXPathResult: window.XPathResult,\r\n\t\t\t\t\tXPathNamespace: window.XPathNamespace\r\n\t\t\t\t},\r\n\t\t\t\t'document': {\r\n\t\t\t\t\tcreateExpression: document.createExpression,\r\n\t\t\t\t\tcreateNSResolver: document.createNSResolver,\r\n\t\t\t\t\tevaluate: document.evaluate\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Get the list of DOM Level 3 XPath objects that are implemented by\r\n\t\t * the XPathJS module.\r\n\t\t *\r\n\t\t * @return {Object} List of DOM Level 3 XPath objects implemented by\r\n\t\t *         the XPathJS module.\r\n\t\t */\r\n\t\tcreateDomLevel3XPathBindings: function(options)\r\n\t\t{\r\n\t\t\tvar evaluator = new XPathEvaluator(options);\r\n\r\n\t\t\treturn {\r\n\t\t\t\t'document': {\r\n          evaluate: function(e, contextPath, namespaceResolver, resultType, result) {\r\n            var wrappedXpathEvaluator = function(v, node, rt) {\r\n              if(resultType < 7 || v.startsWith('//')) resultType = null;\r\n              var wrappedResultType = rt || resultType || XPathResult.ANY_TYPE;\r\n              return evaluator.evaluate(v, node || contextPath, namespaceResolver, wrappedResultType || XPathResult.ANY_TYPE, result);\r\n            };\r\n            var xevaluator = new ExtendedXpathEvaluator(wrappedXpathEvaluator, extensions);\r\n            return xevaluator.evaluate.apply(xevaluator, arguments);\r\n          }\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Bind DOM Level 3 XPath interfaces to the DOM.\r\n\t\t *\r\n\t\t * @param {Object} doc the document or (Document.prototype!) to bind the evaluator etc. to\r\n\t\t * @return List of original DOM Level 3 XPath objects that has been replaced\r\n\t\t */\r\n\t\tbindDomLevel3XPath: function(doc, bindings)\r\n\t\t{\r\n\t\t\tvar newBindings = (bindings || module.createDomLevel3XPathBindings()),\r\n\t\t\t\tcurrentBindings = module.getCurrentDomLevel3XPathBindings(),\r\n\t\t\t\ti\r\n\t\t\t;\r\n\r\n\t\t\tdoc = doc || document;\r\n\r\n\t\t\tfor(i in newBindings['document'])\r\n\t\t\t{\r\n\t\t\t\tdoc[i] = newBindings['document'][i];\r\n\t\t\t}\r\n\r\n\t\t\treturn currentBindings;\r\n\t\t}\r\n  };\r\n\treturn module;\r\n\r\n})();\r\n","/**\n * Converts a native Date UTC String to a RFC 3339-compliant date string with local offsets\n * used in ODK, so it replaces the Z in the ISOstring with a local offset\n * @return {string} a datetime string formatted according to RC3339 with local offset\n */\nDate.prototype.toISOLocalString = function() {\n  //2012-09-05T12:57:00.000-04:00 (ODK)\n\n  if(this.toString() === 'Invalid Date') {\n    return this.toString();\n  }\n\n  var dt = new Date(this.getTime() - (this.getTimezoneOffset() * 60 * 1000)).toISOString()\n      .replace('Z', this.getTimezoneOffsetAsTime());\n\n  if(dt.indexOf('T00:00:00.000') > 0) {\n    return dt.split('T')[0];\n  } else {\n    return dt;\n  }\n};\n\nDate.prototype.getTimezoneOffsetAsTime = function() {\n  var offsetMinutesTotal;\n  var hours;\n  var minutes;\n  var direction;\n  var pad2 = function(x) {\n    return (x < 10) ? '0' + x : x;\n  };\n\n  if(this.toString() === 'Invalid Date') {\n    return this.toString();\n  }\n\n  offsetMinutesTotal = this.getTimezoneOffset();\n\n  direction = (offsetMinutesTotal < 0) ? '+' : '-';\n  hours = pad2(Math.floor(Math.abs(offsetMinutesTotal / 60)));\n  minutes = pad2(Math.floor(Math.abs(offsetMinutesTotal % 60)));\n\n  return direction + hours + ':' + minutes;\n};\n","var config = require('./config');\nvar shuffle = require('./utils/shuffle');\nvar {isNamespaceExpr, handleNamespaceExpr} = require('./utils/ns');\nvar {handleOperation} = require('./utils/operation');\nvar {isNativeFunction, preprocessNativeArgs} = require('./utils/native');\nvar {DATE_STRING, dateToDays} = require('./utils/date');\nvar {toNodes, toSnapshotResult} = require('./utils/result');\nvar {inputArgs, preprocessInput} = require('./utils/input');\n\n/*\n * From http://www.w3.org/TR/xpath/#section-Expressions XPath infix\n * operator precedence is left-associative, and as follows:\n */\nvar OP_PRECEDENCE = [\n  ['|'],\n  ['&'],\n  ['=', '!='],\n  ['<', '<=', '>=', '>'],\n  ['+', '-'],\n  ['*', '/', '%']\n];\n\nvar DIGIT = /[0-9]/;\nvar FUNCTION_NAME = /^[a-z]/;\nvar NUMERIC_COMPARATOR = /(>|<)/;\nvar BOOLEAN_COMPARATOR = /(=)/;\nvar BOOLEAN_FN_COMPARATOR = /(true\\(\\)|false\\(\\))/;\nvar COMPARATOR = /(=|<|>)/;\n\nvar INVALID_ARGS = new Error('invalid args');\nvar TOO_MANY_ARGS = new Error('too many args');\nvar TOO_FEW_ARGS = new Error('too few args');\n\n// TODO remove all the checks for cur.t==='?' - what else woudl it be?\nvar ExtendedXpathEvaluator = function(wrapped, extensions) {\n  var\n    extendedFuncs = extensions.func || {},\n    extendedProcessors = extensions.process || {},\n    toInternalResult = function(r) {\n      var n, v;\n      if(r.resultType === XPathResult.NUMBER_TYPE) return { t:'num', v:r.numberValue };\n      if(r.resultType === XPathResult.BOOLEAN_TYPE) return {  t:'bool', v:r.booleanValue };\n      if(r.resultType === XPathResult.UNORDERED_NODE_ITERATOR_TYPE) {\n        v = [];\n        while((n = r.iterateNext())) v.push(n.textContent);\n        return { t:'arr', v:v };\n      }\n      return { t:'str', v:r.stringValue };\n    },\n    toExternalResult = function(r, rt) {\n      if(extendedProcessors.toExternalResult) {\n        var res = extendedProcessors.toExternalResult(r);\n        if(res) return res;\n      }\n\n      // returns promise\n      if(r.v && typeof r.v.then === 'function' && rt === XPathResult.STRING_TYPE) {\n        return {resultType: XPathResult.STRING_TYPE, stringValue: r.v};\n      }\n\n      if((r.t === 'arr' && rt === XPathResult.NUMBER_TYPE && DATE_STRING.test(r.v[0])) ||\n          (r.t === 'str' && rt === XPathResult.NUMBER_TYPE && DATE_STRING.test(r.v))) {\n        var val = r.t === 'arr' ? r.v[0] : r.v;\n        var days = dateToDays(val);\n        return {\n          resultType:XPathResult.NUMBER_TYPE,\n          numberValue:days,\n          stringValue:days\n        };\n      }\n\n      if(r.t === 'num') return { resultType:XPathResult.NUMBER_TYPE, numberValue:r.v, stringValue:r.v.toString() };\n      if(r.t === 'bool')return { resultType:XPathResult.BOOLEAN_TYPE, booleanValue:r.v, stringValue:r.v.toString() };\n\n      if(rt > 3) {\n        r = shuffle(r[0], r[1]);\n        return toSnapshotResult(r, XPathResult.UNORDERED_SNAPSHOT_TYPE);\n      }\n\n      if(!r.t && Array.isArray(r)) {\n        if(rt === XPathResult.NUMBER_TYPE) {\n          var v = parseInt(r[0].textContent);\n          return { resultType:XPathResult.NUMBER_TYPE, numberValue:v, stringValue:v.toString() };\n        } else if(rt === XPathResult.STRING_TYPE) {\n          return { resultType:XPathResult.STRING_TYPE, stringValue: r.length ? r[0] : '' };\n        }\n      }\n\n      return { resultType:XPathResult.STRING_TYPE, stringValue: r.v===null ? '' : r.v.toString() };\n    },\n    callFn = function(name, args, rt) {\n      if(extendedFuncs.hasOwnProperty(name)) {\n        // if(rt && (/^(date|true|false|now$|today$|randomize$)/.test(name))) args.push(rt);\n        if(rt && (/^(date|now$|today$|randomize$)/.test(name))) args.push(rt);\n        if(/^(true$|false$)/.test(name)) args.push(rt || XPathResult.BOOLEAN_TYPE);\n        return callExtended(name, args);\n      }\n\n      if(name === 'normalize-space' && args.length) {\n        var res = args[0].v;\n        res = res.replace(/\\f/g, '\\\\f');\n        res = res.replace(/\\r\\v/g, '\\v');\n        res = res.replace(/\\v/g, '\\\\v');\n        res = res.replace(/\\s+/g, ' ');\n        res = res.replace(/^\\s+|\\s+$/g, '');\n        res = res.replace(/\\\\v/g, '\\v');\n        res = res.replace(/\\\\f/g, '\\f');\n        return {t: 'str', v: res};\n      }\n\n      if(name === 'string' && args.length > 0 && (\n        args[0].v === Number.POSITIVE_INFINITY ||\n        args[0].v === Number.NEGATIVE_INFINITY ||\n        args[0].v !== args[0].v )) {//NaN\n        return { t:'str', v: args[0].v };\n      }\n      return callNative(name, preprocessNativeArgs(name, args));\n    },\n    callExtended = function(name, args) {\n      var argVals = [], res, i;\n      for(i=0; i<args.length; ++i) argVals.push(args[i]);\n      res = extendedFuncs[name].apply(null, argVals);\n      return res;\n    },\n    callNative = function(name, args) {\n      var argString = '', arg, quote, i;\n      for(i=0; i<args.length; ++i) {\n        arg = args[i];\n        if(arg.t !== 'num' && arg.t !== 'bool') {\n          quote = arg.v.indexOf('\"') === -1 ? '\"' : \"'\";\n          argString += quote;\n        }\n        argString += arg.v;\n        if(arg.t === 'bool') argString += '()';\n        if(arg.t !== 'num' && arg.t !== 'bool') argString += quote;\n        if(i < args.length - 1) argString += ', ';\n      }\n      return toInternalResult(wrapped(name + '(' + argString + ')'));\n    },\n    typefor = function(val) {\n      if(extendedProcessors.typefor) {\n        var res = extendedProcessors.typefor(val);\n        if(res) return res;\n      }\n      if(typeof val === 'boolean') return 'bool';\n      if(typeof val === 'number') return 'num';\n      return 'str';\n    };\n\n  /**\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/Document/evaluate\n   */\n  this.evaluate = function(input, cN, nR, rT, r) {\n    input = preprocessInput(input, rT);\n    if(isNamespaceExpr(input)) return handleNamespaceExpr(input, cN);\n\n    if(isNativeFunction(input)) {\n      var args = inputArgs(input);\n      if(args.length && args[0].length && !isNaN(args[0])) { throw INVALID_ARGS; }\n      if(input === 'lang()') throw TOO_FEW_ARGS;\n      if(/^lang\\(/.test(input) && cN.nodeType === 2) cN = cN.ownerElement;\n      const res = wrapped(input, cN);\n      if(rT === XPathResult.NUMBER_TYPE &&\n        (res.resultType === XPathResult.UNORDERED_NODE_ITERATOR_TYPE ||\n         res.resultType === XPathResult.UNORDERED_NODE_ITERATOR_TYPE)) {\n        var val = parseInt(res.iterateNext().textContent);\n        return {\n          resultType: XPathResult.NUMBER_TYPE,\n          numberValue: val,\n          stringValue: val\n        };\n      }\n      return res;\n    }\n\n    if((rT > 3 && !input.startsWith('randomize')) ||\n      /^count\\(|boolean\\(/.test(input)) {\n\n      if(input.startsWith('count(')) {\n        if(input.indexOf(',') > 0) throw TOO_MANY_ARGS;\n        if(input === 'count()') throw TOO_FEW_ARGS;\n        if(!isNaN(/\\((.*)\\)/.exec(input)[1])) throw INVALID_ARGS;//firefox\n      }\n      if(input.startsWith('boolean(')) { //firefox\n        if(input === 'boolean()') throw TOO_FEW_ARGS;\n        var bargs = input.substring(8, input.indexOf(')')).split(',');\n        if(bargs.length > 1) throw TOO_MANY_ARGS;\n      }\n      if(input === '/') cN = cN.ownerDocument || cN;\n      return wrapped(input, cN);\n    }\n\n    if(rT === XPathResult.BOOLEAN_TYPE && input.indexOf('(') < 0 &&\n        input.indexOf('/') < 0 && input.indexOf('=') < 0 &&\n        input.indexOf('!=') < 0) {\n      input = input.replace(/(\\n|\\r|\\t)/g, '');\n      input = input.replace(/\"(\\d)\"/g, '$1');\n      input = input.replace(/'(\\d)'/g, '$1');\n      input = \"boolean-from-string(\"+input+\")\";\n    }\n\n    if(rT === XPathResult.NUMBER_TYPE && input.indexOf('string-length') < 0) {\n      input = input.replace(/(\\n|\\r|\\t)/g, '');\n    }\n\n    var i, cur, stack = [{ t:'root', tokens:[] }],\n      peek = function() { return stack[stack.length-1]; },\n      err = function(message) { throw new Error((message||'') + ' [stack=' + JSON.stringify(stack) + '] [cur=' + JSON.stringify(cur) + ']'); },\n      newCurrent = function() { cur = { t:'?', v:'' }; },\n      pushOp = function(t) {\n        peek().tokens.push({ t:'op', v:t });\n        newCurrent();\n      },\n      evalOp = function(lhs, op, rhs) {\n        if(extendedProcessors.handleInfix) {\n          var res = extendedProcessors.handleInfix(err, lhs, op, rhs);\n          if(res && res.t === 'continue') {\n            lhs = res.lhs; op = res.op; rhs = res.rhs; res = null;\n          }\n\n          if(typeof res !== 'undefined' && res !== null) return res;\n        }\n        return handleOperation(lhs, op, rhs, config);\n      },\n      evalOpAt = function(tokens, opIndex) {\n        var res = evalOp(\n            tokens[opIndex - 1],\n            tokens[opIndex],\n            tokens[opIndex + 1]);\n\n        if(typeof res !== 'undefined' && res !== null) {\n          tokens.splice(opIndex, 2);\n          tokens[opIndex - 1] = { t:typefor(res), v:res };\n        }\n      },\n      backtrack = function() {\n        // handle infix operators\n        var i, j, ops, tokens;\n        tokens = peek().tokens;\n        for(j=OP_PRECEDENCE.length-1; j>=0; --j) {\n          ops = OP_PRECEDENCE[j];\n          i = 1;\n          while(i < tokens.length-1) {\n            if(tokens[i].t === 'op' && ops.indexOf(tokens[i].v) !== -1) {\n              evalOpAt(tokens, i);\n            } else ++i;\n          }\n        }\n      },\n      handleXpathExpr = function() {\n        var expr = cur.v;\n        var evaluated;\n        if(['position'].includes(peek().v)) {\n          evaluated = wrapped(expr);\n        } else {\n          if(rT > 3 || (cur.v.indexOf('position()=') >= 0 &&\n            stack.length === 1 && !/^[a-z]*[\\(|\\[]{1}/.test(cur.v))) {\n            evaluated = toNodes(wrapped(expr));\n          } else {\n            if(expr.startsWith('$')) {\n              evaluated = expr;\n            } else {\n              evaluated = toInternalResult(wrapped(expr));\n            }\n          }\n        }\n        peek().tokens.push(evaluated);\n        newCurrent();\n      },\n      nextChar = function() {\n        return input.charAt(i+1);\n      },\n      finaliseNum = function() {\n        cur.v = parseFloat(cur.string);\n        peek().tokens.push(cur);\n        newCurrent();\n      },\n      prevToken = function() {\n        var peeked = peek().tokens;\n        return peeked[peeked.length - 1];\n      },\n      isNum = function(c) {\n        return c >= '0' && c <= '9';\n      };\n\n    newCurrent();\n\n    for(i=0; i<input.length; ++i) {\n      var c = input.charAt(i);\n      if(cur.sq) {\n        cur.v += c;\n        if(c === ']') --cur.sq;\n        else if(c === '[') ++cur.sq;\n        continue;\n      }\n      if(cur.t === 'str') {\n        if(c === cur.quote) {\n          peek().tokens.push(cur);\n          newCurrent();\n        } else cur.v += c;\n        continue;\n      }\n      if(cur.t === 'num') {\n        if(DIGIT.test(c) || ['e', '\"', \"'\"].includes(c) ||\n            (c === '-' && input[i-1] === 'e')) {\n          cur.string += c;\n          continue;\n        } else if(c === ' ' && cur.string === '-') {\n          continue;\n        } else if(c === '.' && !cur.decimal) {\n          cur.decimal = 1;\n          cur.string += c;\n        } else finaliseNum();\n      }\n      if(isNum(c)) {\n        if(cur.v === '') {\n          cur = { t:'num', string:c };\n        } else cur.v += c;\n      } else switch(c) {\n        case \"'\":\n        case '\"':\n          if(cur.v === '') {\n            cur = { t:'str', quote:c, v:'' };\n          } else err('Not sure how to handle: ' + c);\n          break;\n        case '(':\n          cur.t = 'fn';\n          cur.tokens = [];\n          stack.push(cur);\n          if(cur.v === 'once') {\n            newCurrent();\n            cur.v = '.';\n            handleXpathExpr();\n          }\n          newCurrent();\n\n          break;\n        case ')':\n          if(nextChar() === '[') {\n            // collapse the stack, and let the native evaluator handle this...\n            var tail = stack.pop();\n            tail.v = tail.v + '(' + cur.v + c;\n            tail.t = '?';\n            cur = tail;\n            break;\n          }\n\n          if(cur.v !== '') handleXpathExpr();\n          backtrack();\n          cur = stack.pop();\n          if(cur.t !== 'fn') err();\n          if(cur.v) {\n            var expectedReturnType = rT;\n            if(rT === XPathResult.BOOLEAN_TYPE) {\n              if(NUMERIC_COMPARATOR.test(input) && !BOOLEAN_FN_COMPARATOR.test(input)) expectedReturnType = XPathResult.NUMBER_TYPE;\n              if(BOOLEAN_COMPARATOR.test(input)) expectedReturnType = XPathResult.BOOLEAN_TYPE;\n              if(COMPARATOR.test(input) && cur.t === 'fn' && /^(date|date-time)$/.test(cur.v)) {\n                expectedReturnType = XPathResult.STRING_TYPE;\n              }\n            }\n            var res = callFn(cur.v, cur.tokens, expectedReturnType)\n            if(cur.v === 'node' && res.t === 'arr' && res.v.length > 0)\n              res.v = [res.v[0]]; // only interested in first element\n            peek().tokens.push(res);\n          } else {\n            if(cur.tokens.length !== 1) err();\n            peek().tokens.push(cur.tokens[0]);\n          }\n          newCurrent();\n          break;\n        case ',':\n          if(cur.v !== '') handleXpathExpr();\n          if(peek().t !== 'fn') err();\n          break;\n        case '*':\n          if(c === '*' && (cur.v !== '' || peek().tokens.length === 0)) {\n            cur.v += c;\n            if(cur.v === './*') handleXpathExpr();\n          } else if(cur.v === '' &&\n            ([')', ''].includes(nextChar()) ||\n            input.substring(i+1).trim() === ')')) {\n            cur.v = c;\n            handleXpathExpr();\n          } else {\n            pushOp(c);\n          }\n          break;\n        case '-':\n          var prev = prevToken();\n          if(cur.v !== '' && nextChar() !== ' ' && input.charAt(i-1) !== ' ') {\n            // function name expr\n            cur.v += c;\n          } else if((peek().tokens.length === 0 && cur.v === '') ||\n            (prev && prev.t === 'op') ||\n            // two argument function\n            (prev && prev.t === 'num' && stack.length > 1 && stack[1].t === 'fn') ||\n            // negative argument\n            (prev && prev.t !== 'num' && isNum(nextChar()))) {\n            // -ve number\n            cur = { t:'num', string:'-' };\n          } else {\n            if(cur.v !== '') {\n              if(!DIGIT.test(cur.v) && input[i-1] !== ' ') throw INVALID_ARGS;\n              peek().tokens.push(cur);\n            }\n            pushOp(c);\n          }\n          break;\n        case '=':\n          if(cur.v === '<' || cur.v === '&lt;' ||\n              cur.v === '>' || cur.v === '&gt;' || cur.v === '!') {\n            cur.v += c;\n            switch(cur.v) {\n              case '<=': case '&lt;=': pushOp('<='); break;\n              case '>=': case '&gt;=': pushOp('>='); break;\n              case '!=':               pushOp('!='); break;\n            }\n          } else {\n            if(cur.v) handleXpathExpr();\n            pushOp(c);\n          }\n          break;\n        case ';':\n          switch(cur.v) {\n            case '&lt': cur.v = ''; c = '<'; break;\n            case '&gt': cur.v = ''; c = '>'; break;\n            default: cur.v += c; continue;\n          }\n          /* falls through */\n        case '>':\n        case '<':\n          if(cur.v) handleXpathExpr();\n          if(nextChar() === '=') {\n            cur.v = c; break;\n          }\n          /* falls through */\n        case '+':\n          pushOp(c);\n          break;\n        case ' ':\n          switch(cur.v) {\n            case '': break; // trim leading whitespace\n            case 'mod': pushOp('%'); break;\n            case 'div': pushOp('/'); break;\n            case 'and': pushOp('&'); break;\n            case 'or':  pushOp('|'); break;\n            default: {\n              var op = cur.v.toLowerCase();\n              if(/^(mod|div|and|or)$/.test(op)) throw INVALID_ARGS;\n              if(!FUNCTION_NAME.test(cur.v)) handleXpathExpr();\n            }\n          }\n          break;\n        case '[':\n          cur.sq = (cur.sq || 0) + 1;\n          /* falls through */\n        case '.':\n          if(cur.v === '' && nextChar() === ')') {\n            cur.v = c;\n            handleXpathExpr();\n            break;\n          }\n          if(cur.v === '' && isNum(nextChar())) {\n            cur = { t:'num', string:c };\n            break;\n          }\n          /* falls through */\n        default:\n          cur.v += c;\n      }\n    }\n    if(cur.t === 'num') finaliseNum();\n    if(cur.t === '?' && cur.v !== '') handleXpathExpr();\n    if(cur.t !== '?' || cur.v !== '' || (cur.tokens && cur.tokens.length)) err('Current item not evaluated!');\n    if(stack.length > 1) err('Stuff left on stack.');\n    if(stack[0].t !== 'root') err('Weird stuff on stack.');\n    if(stack[0].tokens.length === 0) err('No tokens.');\n    if(stack[0].tokens.length >= 3) backtrack();\n    if(stack[0].tokens.length > 1) err('Too many tokens.');\n    return toExternalResult(stack[0].tokens[0], rT);\n  };\n};\n\nmodule.exports = ExtendedXpathEvaluator;\n","var MAX_INT32 = 2147483647;\nvar MINSTD = 16807;\n\n/**\n * Performs the \"inside-out\" variant of the Fisher-Yates array shuffle.\n *\n * @see https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle#The_%22inside-out%22_algorithm\n *\n * @param  {<*>}        array the array to shuffle\n * @param  {number=}    seed the seed value\n * @return {<*>}        the suffled array\n */\nfunction shuffle(array, seed) {\n  var rng;\n  var result = [];\n\n  if(typeof seed !== 'undefined'){\n    if(!Number.isInteger(seed)) {\n      throw new Error('Invalid seed argument. Integer required.');\n    }\n    var rnd = new Random(seed);\n    rng = rnd.nextFloat.bind(rnd);\n  } else {\n    rng = Math.random;\n  }\n\n  for (var i = 0; i < array.length; ++i) {\n    var j = Math.floor(rng() * (i + 1));\n    if(j !== i) {\n      result[i] = result[j];\n    }\n    result[j] = array[i];\n  }\n  return result;\n}\n\n/**\n * Creates a the Park-Miller PRNG pseudo-random value generator.\n * The seed must be an integer.\n *\n * Adapted from: https://gist.github.com/blixt/f17b47c62508be59987b\n */\nfunction Random(seed) {\n    this._seed = seed % MAX_INT32;\n\tif(this._seed <= 0) {\n\t\tthis._seed += (MAX_INT32 - 1);\n\t}\n}\n\n/**\n * Returns a pseudo-random integer value.\n */\nRandom.prototype.next = function () {\n  this._seed = this._seed * MINSTD % MAX_INT32;\n  return this._seed;\n};\n\n/**\n * Returns a pseudo-random floating point number in range [0, 1).\n */\nRandom.prototype.nextFloat = function () {\n    // We know that result of next() will be 1 to 2147483646 (inclusive).\n    return (this.next() - 1) / (MAX_INT32 - 1);\n};\n\nmodule.exports = shuffle;\n","var {toSnapshotResult} = require('./result');\n\nfunction namespace(input, cN) {\n  var nsId = input.substring(11);\n  var xnamespaces = [];\n  var xitems = [];\n  if(cN.attributes) {\n    for(var ii=0; ii<cN.attributes.length; ii++) {\n      var xattr = cN.attributes[ii];\n      var xitem = xattr.ownerElement.getAttributeNode(xattr.name);\n      if(xitem.nodeName === 'xmlns:'+nsId) {\n        xitems.push(xitem);\n        xnamespaces.push({\n          nodeName: '#namespace',\n          localName: nsId,\n          namespaceURI: xitem.nodeValue\n        });\n      }\n    }\n  }\n  return toSnapshotResult(xnamespaces);\n}\n\nfunction namespaceNode(cN) {\n  var namespaces = [];\n  var namespaceKeys = {};\n  var items = [];\n  var node = cN;\n  while(node) {\n    if(node.attributes) {\n      for(var j=0; j<node.attributes.length; j++) {\n        var attr = node.attributes[j];\n        var item = attr.ownerElement.getAttributeNode(attr.name);\n        if(item.nodeName.startsWith('xmlns') && !namespaceKeys[item.nodeName]) {\n          var names = item.nodeName.split(':');\n          namespaceKeys[item.nodeName] = item.nodeName;\n          if(item.nodeValue.length) {\n            items.push(item);\n            namespaces.push({\n              nodeName: '#namespace',\n              localName: names.length > 1 ? names[1] : '',\n              namespaceURI: item.nodeValue\n            });\n          }\n        }\n      }\n    }\n    node = cN.nodeType === 1 ? node.parentNode : null;\n  }\n  if(namespaces.length > 0 && !namespaceKeys.xmlns) {\n    namespaces.push({nodeName: '#namespace', localName: 'xmlns', namespaceURI: 'http://www.w3.org/1999/xhtml'});\n  }\n  if(namespaces.length > 0 && !namespaceKeys.xml) {\n    namespaces.push({nodeName: '#namespace', localName: 'xml', namespaceURI: 'http://www.w3.org/XML/1998/namespace'});\n  }\n  namespaces = namespaces.sort(function(n1, n2){\n    if(n1.localName < n2.localName){ return -1;}\n    if(n1.localName > n2.localName){ return 1;}\n    return 0;\n  });\n  return toSnapshotResult(namespaces, 7, items[0]);\n}\n\nfunction isNamespaceExpr(input) {\n  return /^(namespace::node\\(\\)|namespace::\\*)$/.test(input)\n    || /^namespace::/.test(input);\n}\n\nfunction handleNamespaceExpr(input, cN) {\n  if(/^(namespace::node\\(\\)|namespace::\\*)$/.test(input)) {\n    return namespaceNode(cN);\n  }\n\n  if(/^namespace::/.test(input)) {\n    return namespace(input, cN);\n  }\n}\n\nmodule.exports = {\n  isNamespaceExpr,\n  handleNamespaceExpr\n};\n","var {dateToDays} = require('./date');\n\nfunction isNumber(value) {\n  if(typeof value === 'string') {\n    var nbr = value.replace(/[\"']/g, \"\");\n    // return nbr.trim().length && /^\\d+$/.test(nbr.trim());\n    return nbr.trim().length && !isNaN(nbr.trim());\n  }\n  return typeof value === 'number';\n}\n\nfunction handleOperation(lhs, op, rhs, config) {\n  //Removes quotes for numbers\n  if(op.v === '+' && isNumber(lhs.v) && isNumber(rhs.v)) {\n    lhs.v = Number(lhs.v);\n    rhs.v = Number(rhs.v);\n  }\n\n  //Comparing node expressions with numbers/strings/etc\n  if(lhs.t === 'arr' && lhs.v.length === 1 && rhs.t === 'num') {\n    if (/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/.test(lhs.v[0])) {\n      lhs = {t: 'num', v: dateToDays(lhs.v[0], false)};\n    }\n  }\n  if(rhs.t === 'arr' && rhs.v.length === 1 && lhs.t === 'num') {\n    if (/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/.test(rhs.v[0])) {\n      rhs = {t: 'num', v: dateToDays(rhs.v[0], false)};\n    }\n  }\n\n  if(lhs.t === 'arr' && lhs.v.length === 1 && rhs.t === 'str') {\n    lhs = {t: 'str', v: lhs.v[0]};\n  }\n  if(rhs.t === 'arr' && rhs.v.length === 1 && lhs.t === 'str') {\n    rhs = {t: 'str', v: rhs.v[0]};\n  }\n  if(rhs.t === 'arr' && rhs.v.length === 1 &&\n    lhs.t === 'arr' && lhs.v.length === 1) {\n    lhs = {t: 'str', v: lhs.v[0]};\n    rhs = {t: 'str', v: rhs.v[0]};\n  }\n\n  if(lhs.t === 'str' && /^\\d\\d\\d\\d-\\d{1,2}-\\d{1,2}/.test(lhs.v)) {\n    lhs = {t: 'num', v: dateToDays(lhs.v, false)};\n  }\n\n  if(rhs.t === 'str' && /^\\d\\d\\d\\d-\\d{1,2}-\\d{1,2}/.test(rhs.v)) {\n    rhs = {t: 'num', v: dateToDays(rhs.v, false)};\n  }\n\n  if(op.v === '-' && (isNaN(lhs.v) || isNaN(rhs.v))) {\n    return NaN;\n  }\n\n  if(/^(=|!=)$/.test(op.v)) {\n    if(lhs.t === 'str' && rhs.t === 'bool') {\n      if(lhs.v.length > 0 && lhs.v === '1') {\n        lhs = {t: 'bool', v: true};\n      } else if(lhs.v === '') {\n        lhs = {t: 'bool', v: false};\n      } else {\n        lhs = {t: 'bool', v: undefined};\n      }\n    }\n    if(rhs.t === 'str' && lhs.t === 'bool') {\n      if(rhs.v.length > 0 && rhs.v === '1') {\n        rhs = {t: 'bool', v: true};\n      } else if(rhs.v === '') {\n        rhs = {t: 'bool', v: false};\n      } else {\n        rhs = {t: 'bool', v: undefined};\n      }\n    }\n\n    if(lhs.t === 'num' && rhs.t === 'bool') {\n      lhs = {t: 'bool', v: Boolean(lhs.v)};\n    }\n    if(rhs.t === 'num' && lhs.t === 'bool') {\n      rhs = {t: 'bool', v: Boolean(rhs.v)};\n    }\n  }\n\n  switch(op.v) {\n    case '+':  return lhs.v + rhs.v;\n    case '-':  return lhs.v - rhs.v;\n    case '*':  return lhs.v * rhs.v;\n    case '/':  return lhs.v / rhs.v;\n    case '%':  return lhs.v % rhs.v;\n    case '=':\n      if(/^(num|str)$/.test(lhs.t) && rhs.t === 'arr') {return rhs.v.includes(lhs.string || lhs.v);}\n      if(/^(num|str)$/.test(rhs.t) && lhs.t === 'arr') {return lhs.v.includes(rhs.string || rhs.v);}\n      if(lhs.t === 'bool' && rhs.t === 'arr') {return lhs.v === rhs.v.length > 0;}\n      if(rhs.t === 'bool' && lhs.t === 'arr') {return rhs.v === lhs.v.length > 0;}\n\n      return lhs.v == rhs.v;\n    case '<':\n      if(lhs.t === 'bool') {\n        if(lhs.v === false && rhs.t === 'arr' && rhs.v.length > 0) return true;\n        if(lhs.v === true && rhs.t === 'num') return 1 < rhs.v;\n        if(lhs.v === false && rhs.t === 'num') return 0 < rhs.v;\n        if(lhs.v === false && rhs.t === 'bool') return rhs.v === true;\n        return false;\n      }\n      if(rhs.t === 'bool') {\n        if(rhs.v === true && lhs.t === 'arr' && lhs.v.length === 0) return true;\n        if(rhs.v === true && lhs.t === 'num' && lhs.v < 1) return true;\n        return false;//rhs = {t: 'num', v: rhs.v === true ? 1 : 0, string: rhs.v === true ? '1' : '0'};\n      }\n\n      if(lhs.t === 'arr' && lhs.v.length > 0) {\n        for(var iii=0;iii<lhs.v.length;iii++) {\n          if(Number(lhs.v[iii]) < rhs.v) return true;\n        }\n        return false;\n      }\n      if(rhs.t === 'arr' && rhs.v.length > 0) {\n        for(var k=0;k<rhs.v.length;k++) {\n          if(lhs.v < Number(rhs.v[k])) return true;\n        }\n        return false;\n      }\n      if(lhs.t === 'arr' && lhs.v.length===0) lhs ={t: 'num', string: '0', v: 0};\n      if(rhs.t === 'arr' && rhs.v.length===0) rhs ={t: 'num', string: '0', v: 0};\n      if(lhs.t === 'str' && rhs.t === 'str' && config.allowStringComparison) return lhs.v < rhs.v;\n      if(!isNumber(lhs.v) || !isNumber(rhs.v)) return false;\n      return lhs.v < rhs.v;\n    case '>':\n      if(lhs.t === 'bool') {\n        if(lhs.v === true && rhs.t === 'arr' && rhs.v.length === 0) return true;\n        if(lhs.v === true && rhs.t === 'num') return 1 > rhs.v;\n        if(lhs.v === true && rhs.t === 'bool') return 1 > (rhs.v === true ?  1 : 0);\n        return false;//lhs = {t: 'num', v: lhs.v === true ? 1 : 0, string: lhs.v === true ? '1' : '0'};\n      }\n      if(rhs.t === 'bool') {\n        if(rhs.v === false && lhs.t === 'arr' && lhs.v.length > 0) return true;\n        if(rhs.v === false && lhs.t === 'num') return lhs.v > 0;\n        if(rhs.v === true && lhs.t === 'num') return lhs.v > 1;\n        if(lhs.t === 'num') return lhs.v > rhs.v === true ? 1 : 0;\n        return false;\n      }\n\n      if(lhs.t === 'arr' && lhs.v.length > 0) {\n        for(var j=0;j<lhs.v.length;j++) {\n          if(Number(lhs.v[j]) > rhs.v) return true;\n        }\n        return false;\n      }\n      if(rhs.t === 'arr' && rhs.v.length > 0) {\n        for(var l=0;l<rhs.v.length;l++) {\n          if(lhs.v > Number(rhs.v[l])) return true;\n        }\n        return false;\n      }\n\n      if(lhs.t === 'arr' && lhs.v.length===0) lhs ={t: 'num', string: '0', v: 0};\n      if(lhs.t === 'bool' && lhs.v === true) lhs ={t: 'num', string: '1', v: 1};\n      if(lhs.t === 'bool' && lhs.v === false) lhs ={t: 'num', string: '0', v: 0};\n      if(rhs.t === 'arr' && rhs.v.length===0) rhs ={t: 'num', string: '0', v: 0};\n      if(rhs.t === 'bool' && rhs.v === true) rhs ={t: 'num', string: '1', v: 1};\n      if(rhs.t === 'bool' && rhs.v === false) rhs ={t: 'num', string: '0', v: 0};\n      if(lhs.t === 'str' && rhs.t === 'str' && config.allowStringComparison) return lhs.v > rhs.v;\n      if(!isNumber(lhs.v) || !isNumber(rhs.v)) return false;\n      return lhs.v > rhs.v;\n    case '<=':\n      if(rhs.t === 'arr' && rhs.v.length===0 && lhs.string && lhs.string.length>0) return false;\n      if(lhs.t === 'arr' && lhs.v.length===0 && rhs.string && rhs.string.length>0) return false;\n      if(rhs.t === 'bool' && rhs.v === false && lhs.t === 'arr' && lhs.v.length > 0) return false;\n      if(lhs.t === 'bool') lhs = {t: 'num', v: lhs.v === true ? 1 : 0, string: lhs.v === true ? '1' : '0'};\n      if(rhs.t === 'bool') rhs = {t: 'num', v: rhs.v === true ? 1 : 0, string: lhs.v === true ? '1' : '0'};\n\n      if(lhs.t === 'arr' && lhs.v.length > 0) {\n        for(var m=0;m<lhs.v.length;m++) {\n          if(Number(lhs.v[m]) <= rhs.v) return true;\n        }\n        return false;\n      }\n      if(rhs.t === 'arr' && rhs.v.length > 0) {\n        for(var p=0;p<rhs.v.length;p++) {\n          if(lhs.v <= Number(rhs.v[p])) return true;\n        }\n        return false;\n      }\n\n      if(rhs.t === 'arr' && rhs.v.length===0) rhs ={t: 'num', string: '0', v: 0};\n      if(lhs.t === 'arr' && lhs.v.length===0) lhs ={t: 'num', string: '0', v: 0};\n      if(lhs.t === 'bool' && lhs.v === true) lhs ={t: 'num', string: '1', v: 1};\n      if(lhs.t === 'bool' && lhs.v === false) lhs ={t: 'num', string: '0', v: 0};\n      if(rhs.t === 'bool' && rhs.v === true) rhs ={t: 'num', string: '1', v: 1};\n      if(rhs.t === 'bool' && rhs.v === false) rhs ={t: 'num', string: '0', v: 0};\n      if(lhs.t === 'str' && rhs.t === 'str' && config.allowStringComparison) return lhs.v <= rhs.v;\n      if(!isNumber(lhs.v) || !isNumber(rhs.v)) return false;\n      return lhs.v <= rhs.v;\n    case '>=':\n\n      if(rhs.t === 'arr' && rhs.v.length===0 && lhs.string && lhs.string.length>0) return false;\n      if(rhs.t === 'arr' && rhs.v.length > 0 && lhs.v === false) return false;\n      if(lhs.t === 'arr' && lhs.v.length===0) {\n        if(rhs.t === 'str' && rhs.v === '') return false;\n        if(rhs.t === 'str') return rhs.v.length >= 0;\n        return (rhs.v.length >= 0 || rhs.v === false);\n      }\n\n      if(lhs.t === 'bool') lhs = {t: 'num', v: lhs.v === true ? 1 : 0, string: lhs.v === true ? '1' : '0'};\n      if(rhs.t === 'bool') rhs = {t: 'num', v: rhs.v === true ? 1 : 0, string: lhs.v === true ? '1' : '0'};\n\n      if(lhs.t === 'arr' && lhs.v.length>0) {\n        for(var q=0;q<lhs.v.length;q++) {\n          if(Number(lhs.v[q]) >= rhs.v) return true;\n        }\n        return false;\n      }\n\n      if(rhs.t === 'arr' && rhs.v.length>0) {\n        for(var r=0;r<rhs.v.length;r++) {\n          if(lhs.v >= Number(rhs.v[r])) return true;\n        }\n        return false;\n      }\n\n      if(lhs.t === 'arr' && lhs.v.length===0) lhs ={t: 'num', string: '0', v: 0};\n      if(lhs.t === 'bool' && lhs.v === true) lhs ={t: 'num', string: '1', v: 1};\n      if(lhs.t === 'bool' && lhs.v === false) lhs ={t: 'num', string: '0', v: 0};\n      if(rhs.t === 'arr' && rhs.v.length===0) rhs ={t: 'num', string: '0', v: 0};\n      if(rhs.t === 'bool' && rhs.v === true) rhs ={t: 'num', string: '1', v: 1};\n      if(rhs.t === 'bool' && rhs.v === false) rhs ={t: 'num', string: '0', v: 0};\n\n      if(lhs.t === 'str' && rhs.t === 'str' && config.allowStringComparison) return lhs.v >= rhs.v;\n      if(!isNumber(lhs.v) || !isNumber(rhs.v)) return false;\n      return lhs.v >= rhs.v;\n\n    case '!=':\n      if(lhs.t === 'bool' && rhs.t === 'arr') {return lhs.v === rhs.v.length < 1;}\n      if(rhs.t === 'bool' && lhs.t === 'arr') {return rhs.v === lhs.v.length < 1;}\n\n      return lhs.v != rhs.v;\n    case '&':  return Boolean(lhs.v && rhs.v);\n    case '|':  return Boolean(lhs.v || rhs.v);\n  }\n}\n\nmodule.exports = {\n  handleOperation\n};\n","var {DATE_STRING, dateToDays} = require('./date');\n\nvar TOO_MANY_ARGS = new Error('too many args');\nvar TOO_FEW_ARGS = new Error('too few args');\nvar INVALID_ARGS = new Error('invalid args');\n\nvar NATIVE_FUNS = /^id\\(|^\\([a-zA-Z]|lang\\(|local-name|namespace-uri|last\\(|name\\(|child::|parent::|descendant::|descendant-or-self::|ancestor::|ancestor-or-self::sibling|following::|following-sibling::|preceding-sibling::|preceding::|attribute::/;\n\nfunction isNativeFunction(input) {\n  return NATIVE_FUNS.test(input);\n}\n\nfunction checkMinMaxArgs(args, min, max) {\n  if(min != null && args.length < min) throw TOO_FEW_ARGS;\n  if(max != null && args.length > max) throw TOO_MANY_ARGS;\n}\n\nfunction checkNativeFn(name, args) {\n  if(name === 'last') {\n    checkMinMaxArgs(args, null, 0);\n  } else if(/^(boolean|lang|ceiling|name|floor)$/.test(name)) {\n    checkMinMaxArgs(args, 1, 1);\n  } else if(/^(number|string|normalize-space|string-length)$/.test(name)) {\n    checkMinMaxArgs(args, null, 1);\n  } else if(name === 'substring') {\n    checkMinMaxArgs(args, 2, 3);\n  } else if(/^(starts-with|contains|substring-before|substring-after)$/.test(name)) {\n    checkMinMaxArgs(args, 2, 2);\n  } else if(name === 'translate') {\n    checkMinMaxArgs(args, 3, 3);\n  }\n}\n\nfunction preprocessNativeArgs(name, args) {\n  if(name === 'number' && args.length) {\n    if(args[0].t === 'arr') {\n      args = [{t: 'num', v: args[0].v[0]}];\n    } else if(args[0].t === 'str' && DATE_STRING.test(args[0].v)) {\n      args = [{t: 'num', v: dateToDays(args[0].v)}];\n    } else if(args[0].t === 'num' && args[0].v.toString().indexOf('e-') > 0) {\n      args = [{t: 'num', v: 0}];\n    }\n  }\n  if(name === 'name' && args.length < 2) throw TOO_FEW_ARGS;\n  if(name === 'namespace-uri') {\n    if(args.length > 1) throw TOO_MANY_ARGS;\n    if(args.length === 0) throw TOO_FEW_ARGS;\n    if(args.length === 1 && !isNaN(args[0].v)) throw INVALID_ARGS;\n  }\n  if(name === 'local-name') {\n    if(args.length > 1) throw TOO_MANY_ARGS;\n    if(args.length === 1 && !isNaN(args[0].v)) throw INVALID_ARGS;\n  }\n\n  if(name === 'substring' && args.length > 2 && args[1].v === Number.NEGATIVE_INFINITY && args[2].v === Number.POSITIVE_INFINITY) {\n    args[0].v = '';\n  }\n\n  if(name === 'substring' && args.length > 1 && args[1].v < 0) {\n    args[1].v = 0;\n  }\n  if(name === 'substring' && args.length > 2 && args[2].v === Number.POSITIVE_INFINITY) {\n    args[2].v = args[0].v.length + 1;\n  }\n  checkNativeFn(name, args);\n  return args;\n}\n\nmodule.exports = {\n  isNativeFunction,\n  preprocessNativeArgs\n};\n","function isOperation(input, rT) {\n  return rT === XPathResult.NUMBER_TYPE && // expects a number result\n    input.indexOf('(') < 0 // not a function based expression\n    && !input.startsWith('/'); // not a path expression\n}\n\nvar ARGS_REGEX = /\\(\\s*([^)]*)\\)$/;\n\nfunction inputArgs(input) {\n  var m = input.match(ARGS_REGEX);\n  return m ? m[1].split(',') : [];\n}\n\nfunction preprocessInput(input, rT) {\n  if(isOperation(input, rT)) {\n    input = input.replace('\\n', ''); //replaces new lines for expressions without functions\n    if(input.indexOf('mod') > 0) { // to support 1mod1 or any weirdness\n      input = input.replace('mod', ' mod ');\n    }\n    if(input.indexOf('div') > 0) { // to support 1div1 or any weirdness\n      input = input.replace('div', ' div ');\n    }\n  }\n\n  if(input === 'string(namespace::node())') {\n    input = input.replace('namespace::node()', 'namespace-uri(/*)');\n  }\n  return input;\n}\n\nmodule.exports = {\n  inputArgs,\n  preprocessInput\n};\n","const {area, distance, areaOrDistance} = require('./geo');\nconst {digest} = require('./digest');\nconst {randomToken} = require('./random-token');\n\nvar openrosa_xpath_extensions = function(config) {\n  var\n      TOO_MANY_ARGS = new Error('too many args'),\n      TOO_FEW_ARGS = new Error('too few args'),\n      MILLIS_PER_DAY = 1000 * 60 * 60 * 24,\n      RAW_NUMBER = /^(-?[0-9]+)(\\.[0-9]+)?$/,\n      DATE_STRING = /^\\d\\d\\d\\d-\\d{1,2}-\\d{1,2}(?:T\\d\\d:\\d\\d:\\d\\d\\.?\\d?\\d?(?:Z|[+-]\\d\\d:\\d\\d)|.*)?$/,\n      XPR = {\n        nodes: function(val) { return { t:'nodes', v:val }; },\n        boolean: function(val) { return { t:'bool', v:val }; },\n        number: function(val) { return { t:'num', v:val }; },\n        string: function(val) { return { t:'str', v:val }; },\n        date: function(val) {\n          if(!(val instanceof Date)) throw new Error('Cannot create date from ' + val + ' (' + (typeof val) + ')');\n          return { t:'date', v:val };\n        }\n      },\n      _zeroPad = function(n, len) {\n        len = len || 2;\n        n = n.toString();\n        while(n.length < len) n = '0' + n;\n        return n;\n      },\n      _int = function(r) { return Math.round(_float(r)); },\n      _float = function(r) { return r.t === 'num'? r.v: parseFloat(_str(r)); },\n      _str = function(r) {\n        return r.t === 'arr' ?\n               r.v.length ? r.v[0].toString() : '' :\n            r.v.toString();\n      },\n      _dateToString = function(d) {\n            return d.getFullYear() + '-' + _zeroPad(d.getMonth()+1) + '-' +\n                _zeroPad(d.getDate());\n      },\n      _round = function(num) {\n        if(num < 0) {\n          return -Math.round(-num);\n        }\n        return Math.round(num);\n      },\n      _uuid_part = function(c) {\n        var r = Math.random()*16|0,\n            v = c == 'x' ? r : r&0x3|0x8;\n        return v.toString(16);\n      },\n      _date = function(it, keepTime) {\n        var temp, t;\n        if(it.v instanceof Date) {\n          return new Date(it.v);\n        }\n        it = _str(it);\n        if(RAW_NUMBER.test(it)) {\n          // Create a date at 00:00:00 1st Jan 1970 _in the current timezone_\n          temp = new Date(1970, 0, 1);\n          temp.setDate(1 + parseInt(it, 10));\n          return temp;\n        } else if(DATE_STRING.test(it)) {\n          if(keepTime && it.indexOf('T')>0) return new Date(it);\n          t = it.indexOf('T');\n          if(t !== -1) it = it.substring(0, t);\n          temp = it.split('-');\n          temp = new Date(temp[0], temp[1]-1, temp[2]);\n          return temp;\n        }\n        var d = new Date(it);\n        return d == 'Invalid Date' ? null : d;\n      },\n      _dateForReturnType = function(it, rt) {\n        if(rt === XPathResult.BOOLEAN_TYPE) {\n          if(!it) return XPR.boolean(false);\n          return XPR.boolean(!isNaN(new Date(it).getTime()));\n        }\n        if(rt === XPathResult.NUMBER_TYPE) {\n          if(!it) return XPR.number(0);\n          return XPR.number((new Date(it).getTime()) / (1000 * 60 * 60 * 24));\n        }\n        if(rt === XPathResult.STRING_TYPE) {\n          if(!it) return XPR.string('Invalid Date');\n          return XPR.string(new Date(it).toISOLocalString());\n        }\n        if(!it) return XPR.string('Invalid Date');\n        return XPR.date(it);\n      },\n      uuid = function() {\n          return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'\n                  .replace(/[xy]/g, _uuid_part);\n      },\n      date = function(it, rt) {\n        it = _date(it);\n        return _dateForReturnType(it, rt);\n      },\n      format_date = function(date, format) {\n        date = _date(date, true);\n        if(!format) return '';\n        format = _str(format);\n        if(!date) return 'Invalid Date';\n        var c, i, sb = '', f = {\n          year: 1900 + date.getYear(),\n          month: 1 + date.getMonth(),\n          day: date.getDate(),\n          hour: date.getHours(),\n          minute: date.getMinutes(),\n          second: date.getSeconds(),\n          millis: date.getMilliseconds(),\n          secTicks: date.getTime(),\n          dow: 1 + date.getDay(),\n        };\n        var locale = window ? window.enketoFormLocale : undefined;\n\n        for(i=0; i<format.length; ++i) {\n          c = format.charAt(i);\n\n          if (c === '%') {\n            if(++i >= format.length) {\n              throw new Error(\"date format string ends with %\");\n            }\n            c = format.charAt(i);\n\n            if (c === '%') { // literal '%'\n              sb += '%';\n            } else if (c === 'Y') {  //4-digit year\n              sb += _zeroPad(f.year, 4);\n            } else if (c === 'y') {  //2-digit year\n              sb += _zeroPad(f.year, 4).substring(2);\n            } else if (c === 'm') {  //0-padded month\n              sb += _zeroPad(f.month, 2);\n            } else if (c === 'n') {  //numeric month\n              sb += f.month;\n            } else if (c === 'b') {  //short text month\n              sb += date.toLocaleDateString( locale, { month: 'short' } );\n            } else if (c === 'd') {  //0-padded day of month\n              sb += _zeroPad(f.day, 2);\n            } else if (c === 'e') {  //day of month\n              sb += f.day;\n            } else if (c === 'H') {  //0-padded hour (24-hr time)\n              sb += _zeroPad(f.hour, 2);\n            } else if (c === 'h') {  //hour (24-hr time)\n              sb += f.hour;\n            } else if (c === 'M') {  //0-padded minute\n              sb += _zeroPad(f.minute, 2);\n            } else if (c === 'S') {  //0-padded second\n              sb += _zeroPad(f.second, 2);\n            } else if (c === '3') {  //0-padded millisecond ticks (000-999)\n              // sb += _zeroPad(f.secTicks, 3);\n              sb += _zeroPad(f.millis, 3);\n            } else if (c === 'a') {  //Three letter short text day\n              sb += date.toLocaleDateString( locale, { weekday: 'short' } );\n            } else if (c === 'Z' || c === 'A' || c === 'B') {\n              throw new Error('unsupported escape in date format string [%' + c + ']');\n            } else {\n              throw new Error('unrecognized escape in date format string [%' + c + ']');\n            }\n          } else {\n            sb += c;\n          }\n        }\n\n        return sb;\n      },\n      func, process, ret = {},\n      now_and_today = function(rt, resetTime) {\n        return _dateForReturnType(ret._now(resetTime), rt);\n      };\n\n  func = {\n    abs: function(r) { return XPR.number(Math.abs(r.v)); },\n    acos: function(r) { return XPR.number(Math.acos(r.v)); },\n    asin: function(r) { return XPR.number(Math.asin(r.v)); },\n    atan: function(r) { return XPR.number(Math.atan(r.v)); },\n    atan2: function(r) {\n      if(arguments.length>1) {\n        var y = arguments[0].v;\n        var x = arguments[1].v;\n        return XPR.number(Math.atan2(y, x));\n      }\n      return XPR.number(Math.atan2(r.v));\n    },\n    'boolean-from-string': function(string) {\n      string = _str(string);\n      return XPR.boolean(string === '1' || string === 'true');\n    },\n    area: function(r) {\n      if(arguments.length === 0) throw TOO_FEW_ARGS;\n      return areaOrDistance(XPR.number, area, r);\n\t\t},\n    checklist: function(min, max) {\n      var i, j, trues = 0;\n      min = min.v;\n      max = max.v;\n      for (i=2;i < arguments.length;i++) {\n        var arg = arguments[i];\n        if (arg.t === 'bool' && Boolean(arg.v)) {\n          trues++;\n        } else if (arg.t === 'arr') {\n          for(j=0;j<arg.v.length;j++) {\n            if(Boolean(arg.v[j])) trues++;\n          }\n        }\n      }\n      return XPR.boolean((min < 0 || trues >= min) && (max < 0 || trues <= max));\n    },\n    coalesce: function(a, b) { return XPR.string(_str(a) || _str(b)); },\n    concat: function() {\n      var out = [];\n      for (var j = 0; j < arguments.length; j++){\n        if(arguments[j].t === 'arr') {\n          out.push(arguments[j].v.join(''));\n        } else {\n          out.push(arguments[j].v);\n        }\n      }\n      return XPR.string(out.join(''));\n    },\n    cos: function(r) { return XPR.number(Math.cos(r.v)); },\n    'count-non-empty': function(r) {\n      if(arguments.length === 0 || r.t !== 'arr') throw TOO_FEW_ARGS;\n      var counter = 0;\n      for (var j = 0; j < r.v.length; j++){\n        counter += r.v[j] === '' ? 0 : 1;\n      }\n      return XPR.number(counter);\n    },\n    'count-selected': function(s) {\n      var parts = _str(s).split(' '),\n          i = parts.length,\n          count = 0;\n      while(--i >= 0) if(parts[i].length) ++count;\n      return XPR.number(count);\n    },\n    date: function(it, rt) {\n      it = _date(it);\n      return _dateForReturnType(it, rt);\n    },\n    'decimal-date': function(date) {\n      if(arguments.length > 1) throw TOO_MANY_ARGS;\n      var res = Date.parse(_str(date)) / MILLIS_PER_DAY;\n      return XPR.number(Math.round(res * 1000)/1000);\n    },\n    'decimal-time': function(r) {\n      if(arguments.length > 1) throw TOO_MANY_ARGS;\n      if(r.t === 'num') return XPR.number(NaN);\n      var time = r.v;\n      // There is no Time type, and so far we don't need it so we do all validation\n      // and conversion here, manually.\n      var\tm = time.match(/^(\\d\\d):(\\d\\d):(\\d\\d)(\\.\\d\\d?\\d?)?(\\+|-)(\\d\\d):(\\d\\d)$/);\n      var PRECISION = 1000;\n      var dec;\n      if (m &&\n        m[1] < 24 && m[1] >= 0 &&\n        m[2] < 60 && m[2] >= 0 &&\n        m[3] < 60 && m[3] >= 0 &&\n        m[6] < 24 && m[6] >= 0 && // this could be tighter\n        m[7] < 60 && m[7] >= 0 // this is probably either 0 or 30\n      ) {\n        var pad2 = function(x) { return (x < 10) ? '0' + x : x; };\n        var today = new Date(); // use today to cater to daylight savings time.\n        var d = new Date(today.getFullYear() + '-' + pad2(today.getMonth() + 1) + '-' + pad2(today.getDate()) + 'T' + time);\n        if(d.toString() === 'Invalid Date'){\n          dec = NaN;\n        } else {\n          dec = Math.round((d.getSeconds()/3600 + d.getMinutes()/60 + d.getHours()) * PRECISION/24) / PRECISION;\n        }\n      } else {\n        dec = NaN;\n      }\n      return XPR.number(dec);\n    },\n    digest: function(msg, algo, encoding) {\n      return XPR.string(digest(msg, algo, encoding));\n    },\n    distance: function(r) {\n      if(arguments.length === 0) throw TOO_FEW_ARGS;\n      return areaOrDistance(XPR.number, distance, r);\n    },\n    exp: function(r) { return XPR.number(Math.exp(r.v)); },\n    exp10: function(r) { return XPR.number(Math.pow(10, r.v)); },\n    'false': function(rt) {\n      if(rt === XPathResult.NUMBER_TYPE) return XPR.number(0);\n      if(arguments.length>1) throw TOO_MANY_ARGS;\n      return XPR.boolean(false);\n    },\n    'format-date': function(date, format) {\n      return XPR.string(format_date(date, format)); },\n    'if': function(con, a, b) {\n      if(con.t === 'bool') return XPR.string(Boolean(con.v) ? a.v : b.v);\n      if(con.t === 'arr') {\n        var exists = con.v.length && con.v[0] !== null;\n        return XPR.string(exists ? a.v : b.v);\n      }\n      return XPR.string(b.v);\n    },\n    'ends-with': function(a, b) {\n      if(arguments.length > 2) throw TOO_MANY_ARGS;\n      if(arguments.length < 2) throw TOO_FEW_ARGS;\n      return XPR.boolean(a.v.endsWith(b.v));\n    },\n    int: function(v) {\n      if(v.t === 'str' && v.v.indexOf('e-')>0) return XPR.number(NaN);\n      v = _str(v);\n      if(v.indexOf('e-')>0) return XPR.number(0);\n      return XPR.number(parseInt(v, 10));\n    },\n    join: function() {\n      var delim = arguments[0];\n      if(arguments.length<2) return XPR.string('');\n      if(arguments.length>2) {\n        var out = [];\n        for (var i = 1; i < arguments.length; i++){\n          out.push(arguments[i].v);\n        }\n        return XPR.string(out.join(_str(delim)));\n      }\n      return XPR.string(arguments[1].v.join(_str(delim)));\n    },\n    log: function(r) { return XPR.number(Math.log(r.v)); },\n    log10: function(r) { return XPR.number(Math.log10(r.v)); },\n    max: function() {\n      if(arguments.length > 1) {\n        var out = [];\n        for (var j = 0; j < arguments.length; j++){\n          out.push(arguments[j].v);\n        }\n        return XPR.number(Math.max.apply(null, out));\n      }\n      var max, i;\n      var r = arguments[0].v;\n      if(!(i=r.length)) return XPR.number(NaN);\n      max = parseFloat(r[0]);\n      while(--i) max = Math.max(max, parseFloat(r[i]));\n      return XPR.number(max);\n    },\n    min: function() {\n      if(arguments.length > 1) {\n        var out = [];\n        for (var j = 0; j < arguments.length; j++){\n          out.push(arguments[j].v);\n        }\n        return XPR.number(Math.min.apply(null, out));\n      }\n      var min, i;\n      var r = arguments[0].v;\n      if(!(i=r.length)) return XPR.number(NaN);\n      min = parseFloat(r[0]);\n      while(--i) min = Math.min(min, parseFloat(r[i]));\n      return XPR.number(min);\n    },\n    /*\n     * As per https://github.com/alxndrsn/openrosa-xpath-evaluator/issues/15,\n     * the pass-through to the wrapped implementation always requests\n     * XPathResult.STRING_TYPE.  This seems to cause an issue with the response\n     * from `not()` calls, which should ideally be handled by the built-in\n     * XPath implementation.  The following method is supplied as a workaround,\n     * and ideally would be unnecessary.\n     */\n    not: function(r) {\n      if(arguments.length === 0) throw TOO_FEW_ARGS;\n      if(arguments.length > 1) throw TOO_MANY_ARGS;\n      return XPR.boolean(!r.v);\n    },\n    now: function(rt) {\n      return now_and_today(rt);\n    },\n    today: function(rt) {\n      var r = now_and_today(rt, !config.returnCurrentTimeForToday);\n      if(rt === XPathResult.STRING_TYPE && !config.includeTimeForTodayString) {\n        r.v = r.v.split('T')[0];\n      }\n      return r;\n    },\n    /**\n     * The once function returns the value of the parameter if its own value\n     * is not empty, NaN, [Infinity or -Infinity]. The naming is therefore misleading!\n     * Also note that the parameter expr is always evaluated.\n     * This function simply decides whether to return the new result or the old value.\n     */\n    once: function(node, r) {\n      if(node.v.length && node.v[0].length) {\n        return XPR.string(node.v[0]);\n      }\n      if(r.v == Infinity) return XPR.string('');\n      if(r.t === 'num' && r.v === 0) return XPR.string('');\n      return XPR.string(r.v);\n    },\n    pi: function() { return XPR.number(Math.PI); },\n    position: function(r) {\n      var position = 1;\n      if(r) {\n        var node = r.iterateNext();\n        var nodeName = node.tagName;\n        while (node.previousElementSibling && node.previousElementSibling.tagName === nodeName) {\n          node = node.previousElementSibling;\n          position++;\n        }\n      }\n      return XPR.number(position);\n    },\n    pow: function(x, y) { return XPR.number(Math.pow(_float(x), _float(y))); },\n    random: function() { return XPR.number(Math.random()); },\n    randomize: function(r) {\n      if(arguments.length === 1) throw TOO_FEW_ARGS;//only rT passed\n      if(arguments.length > 3) throw TOO_MANY_ARGS;\n\n      var seed = arguments.length > 2 ? arguments[1] : arguments[2];\n      var rt = arguments[arguments.length - 1];\n\n      if(rt === XPathResult.BOOLEAN_TYPE) {\n        return XPR.boolean(r.v.length > 0 ? true : false);\n      }\n      if(rt === XPathResult.STRING_TYPE) {\n        if (r.v.length < 1) return '';\n        return XPR.string(r.v[0]);\n      }\n      // nodes as seed\n      if(Array.isArray(seed) && seed.length && seed[0].nodeType === 1) {\n        return [r, parseInt(seed[0].textContent)];\n      }\n      return [r, seed && seed.v];\n    },\n    regex: function(haystack, pattern) {\n        return XPR.boolean(new RegExp(_str(pattern)).test(_str(haystack))); },\n    round: function(number, num_digits) {\n      if(arguments.length === 0) throw TOO_FEW_ARGS;\n      if(arguments.length > 2) throw TOO_MANY_ARGS;\n      number = _float(number);\n      if(!num_digits) {\n        return XPR.number(_round(number));\n      }\n      num_digits = _int(num_digits);\n      var pow = Math.pow(10, Math.abs(num_digits));\n      if(num_digits > 0) {\n        return XPR.number(_round(number * pow) / pow);\n      } else {\n        return XPR.number(pow * _round(number / pow));\n      }\n    },\n    selected: function(haystack, needle) {\n      return XPR.boolean(_str(haystack).split(' ').indexOf(_str(needle).trim()) !== -1);\n    },\n    'selected-at': function(list, index) {\n      if(!index) throw new Error(JSON.stringify(list));\n      return XPR.string(_str(list).split(' ')[_int(index)] || '');\n    },\n    sin: function(r) { return XPR.number(Math.sin(r.v)); },\n    sqrt: function(r) { return XPR.number(Math.sqrt(r.v)); },\n    substr: function(string, startIndex, endIndex) {\n      return XPR.string(_str(string).slice(\n          _int(startIndex),\n          endIndex && _int(endIndex)));\n    },\n    sum: function(r) {\n      if(arguments.length > 1) throw TOO_MANY_ARGS;\n      var out = 0;\n      for (var i = 0; i < r.v.length; i++) {\n        if(!RAW_NUMBER.test(r.v[i])) XPR.number(NaN);\n        out += parseInt(r.v[i], 10);\n      }\n      return XPR.number(out);\n    },\n    tan: function(r) { return XPR.number(Math.tan(r.v)); },\n    'true': function(rt) {\n      if(rt === XPathResult.NUMBER_TYPE) return XPR.number(1);\n      if(arguments.length>1) throw TOO_MANY_ARGS;\n      return XPR.boolean(true);\n    },\n    uuid: function(r) {\n      if(r && r.v) return XPR.string(randomToken(r.v));\n      return XPR.string(uuid());\n    },\n    'weighted-checklist': function(min, max) {\n      var i, values = [], weights = [], weightedTrues = 0;\n      min = min.v;\n      max = max.v;\n      for (i=2 ; i < arguments.length ; i=i+2) {\n        var v = arguments[i];\n        var w = arguments[i+1];\n        if (v && w) {\n          // value or weight might be a nodeset\n          values.push(v.t === 'arr' ? v.v[0] : v.v);\n          weights.push(w.t === 'arr' ? w.v[0] : w.v);\n        }\n      }\n\n      for(i=0; i < values.length; i++) {\n        if(Boolean(values[i])) {\n          weightedTrues += weights[i];\n        }\n      }\n      return XPR.boolean((min < 0 || weightedTrues >= min) && (max < 0 || weightedTrues <= max));\n    }\n  };\n\n  // function aliases\n  func['date-time'] = func.date;\n  func['decimal-date-time'] = func['decimal-date'];\n  func['format-date-time'] = func['format-date'];\n\n  process = {\n      toExternalResult: function(r) {\n        if(r.t === 'date') return {\n          resultType:XPathResult.STRING_TYPE,\n          // TODO a bit naughty, but we return both a string and number value\n          // for dates.  We should actually know from where the xpath evaluator\n          // was initially called whether we expect a STRING_TYPE or NUMBER_TYPE\n          // result, but we should get away with it because:\n          //   1. this setup makes testing easy\n          //   2. dates should never leak outside openrosa functionality anyway\n          numberValue:r.v.getTime(),\n          stringValue:_dateToString(r.v),\n        };\n      },\n      typefor: function(val) {\n        if(val instanceof Date) return 'date';\n      },\n      handleInfix: function(err, lhs, op, rhs) {\n        if(lhs.t === 'date' || rhs.t === 'date') {\n          // For comparisons, we must make sure that both values are numbers\n          // Dates would be fine, except for equality!\n          if( op.v === '=' ||\n              op.v === '<' ||\n              op.v === '>' ||\n              op.v === '<=' ||\n              op.v === '>=' ||\n              op.v === '!=') {\n            if(lhs.t === 'arr' || lhs.t === 'str') lhs = date(lhs);\n            if(rhs.t === 'arr' || rhs.t === 'str') rhs = date(rhs);\n            if(lhs.t !== 'date' || rhs.t !== 'date') {\n              return op.v === '!=';\n            } else {\n              lhs = { t:'num', v:lhs.v.getTime() };\n              rhs = { t:'num', v:rhs.v.getTime() };\n            }\n          } else if(op.v === '+' || op.v === '-') {\n            // for math operators, we need to do it ourselves\n            if(lhs.t === 'date' && rhs.t === 'date') err();\n            var d = lhs.t === 'date'? lhs.v: rhs.v,\n                n = lhs.t !== 'date'? _int(lhs): _int(rhs),\n                res = new Date(d.getTime());\n            if(op.v === '-') n = -n;\n            res.setDate(d.getDate() + n);\n            return res;\n          }\n          return { t:'continue', lhs:lhs, op:op, rhs:rhs };\n        }\n      },\n  };\n\n  ret.func = func;\n  ret.process = process;\n  ret.XPR = XPR;\n  ret._now = function(resetTime) {\n    var t = new Date();\n    if(resetTime) {\n      return new Date(t.getFullYear(), t.getMonth(), t.getDate());\n    }\n    return t;\n  };\n\n  return ret;\n};\n\nmodule.exports = openrosa_xpath_extensions;\n","var EARTH_EQUATORIAL_RADIUS_METERS = 6378100;\nvar PRECISION = 100;\n\nfunction _toLatLngs(geopoints) {\n  return geopoints.map(function (geopoint) {\n    return geopoint.trim().split(' ');\n  });\n}\n\n// converts degrees to radians\nfunction _toRadians(angle) {\n  return angle * Math.PI / 180;\n}\n\n// check if all geopoints are valid (copied from Enketo FormModel)\nfunction _latLngsValid(latLngs) {\n  return latLngs.every(function (coords) {\n    return (\n      (coords[0] !== '' && coords[0] >= -90 && coords[0] <= 90) &&\n      (coords[1] !== '' && coords[1] >= -180 && coords[1] <= 180) &&\n      (typeof coords[2] == 'undefined' || !isNaN(coords[2])) &&\n      (typeof coords[3] == 'undefined' || (!isNaN(coords[3]) && coords[3] >= 0))\n    );\n  });\n}\n\n/**\n * Adapted from https://www.movable-type.co.uk/scripts/latlong.html\n *\n * @param {{lat:number, lng: number}} p1\n * @param {{lat:number, lng: number}} p2\n * @returns {number}\n */\nfunction _distanceBetween(p1,p2) {\n  var Δλ = _toRadians(p1.lng - p2.lng);\n  var φ1 = _toRadians(p1.lat);\n  var φ2 = _toRadians(p2.lat);\n  return Math.acos(Math.sin(φ1) * Math.sin(φ2) + Math.cos(φ1) * Math.cos(φ2) * Math.cos(Δλ)) * EARTH_EQUATORIAL_RADIUS_METERS;\n}\n\nfunction areaOrDistance(xpr, fn, r) {\n  var geopoints = [];\n  if(r.t === 'str') geopoints = r.v.split(';');\n  if(r.t === 'arr') {\n    if(r.v.length === 1) geopoints = r.v[0].split(';');\n    else geopoints = r.v;\n  }\n  return xpr(fn(geopoints));\n}\n\n/**\n * Adapted from https://github.com/Leaflet/Leaflet.draw/blob/3cba37065ea5be28f42efe9cc47836c9e3f5db8c/src/ext/GeometryUtil.js#L3-L20\n */\nfunction area(geopoints) {\n  var latLngs = _toLatLngs(geopoints);\n\n  if (!_latLngsValid(latLngs)) {\n    return Number.NaN;\n  }\n\n  var pointsCount = latLngs.length;\n  var area = 0.0;\n\n  if (pointsCount > 2) {\n    for (var i = 0; i < pointsCount; i++) {\n      var p1 = {\n        lat: latLngs[i][0],\n        lng: latLngs[i][1]\n      };\n      var p2 = {\n        lat: latLngs[(i + 1) % pointsCount][0],\n        lng: latLngs[(i + 1) % pointsCount][1]\n      };\n      area += _toRadians(p2.lng - p1.lng) *\n          (2 + Math.sin(_toRadians(p1.lat)) + Math.sin(_toRadians(p2.lat)));\n    }\n    area = area * EARTH_EQUATORIAL_RADIUS_METERS * EARTH_EQUATORIAL_RADIUS_METERS / 2.0;\n  }\n  return Math.abs(Math.round(area * PRECISION)) / PRECISION;\n}\n\n/**\n * @param {any} geopoints\n * @returns\n */\nfunction distance(geopoints) {\n  var latLngs = _toLatLngs(geopoints);\n\n  if (!_latLngsValid(latLngs)) {\n    return Number.NaN;\n  }\n\n  var pointsCount = latLngs.length;\n  var distance = 0.0;\n\n  if (pointsCount > 1) {\n    for (var i = 1; i < pointsCount; i++) {\n      var p1 = {\n        lat: latLngs[i - 1][0],\n        lng: latLngs[i - 1][1]\n      };\n      var p2 = {\n        lat: latLngs[i][0],\n        lng: latLngs[i][1]\n      };\n\n      distance += _distanceBetween(p1, p2);\n    }\n  }\n\n  return Math.abs(Math.round(distance * PRECISION)) / PRECISION;\n}\n\nmodule.exports = {\n  area,\n  areaOrDistance,\n  distance\n};\n","const forge = require('forge');\n\nconst digest = (message, algo, encoding) => {\n  message = message.v;\n  algo = algo && algo.v && algo.v.toLowerCase();\n  encoding = (encoding && encoding.v && encoding.v.toLowerCase()) || 'base64';\n  if(!algo || !/^(md5|sha-1|sha-256|sha-384|sha-512)$/.test(algo)) {\n    throw new Error('Invalid algo.');\n  }\n  if(!/^(base64|hex)$/.test(encoding)) {\n    throw new Error('Invalid encoding.');\n  }\n  const md = forge.md[algo.replace('-', '')].create();\n  md.update(message);\n  const hashBuffer = md.digest();\n  if(!encoding || encoding === 'base64') {\n    return forge.util.encode64(hashBuffer.bytes());\n  }\n  return md.digest().toHex();\n}\n\nmodule.exports = {\n  digest\n};\n","module.exports = __WEBPACK_EXTERNAL_MODULE__15__;","function _random13chars() {\n  return Math.random().toString(16).substring(2);\n}\n\nfunction randomToken(length) {\n\tvar loops = Math.ceil(length / 13);\n\treturn new Array(loops)\n    .fill(_random13chars)\n    .reduce((string, func) => {\n\t\t    return string + func();\n\t   }, '').substring(0, length);\n}\n\nmodule.exports = {\n  randomToken\n};\n"],"sourceRoot":""}