{"version":3,"sources":["webpack://orxe/webpack/universalModuleDefinition","webpack://orxe/webpack/bootstrap","webpack://orxe/./src/utils/date.js","webpack://orxe/./src/config.js","webpack://orxe/./src/utils/result.js","webpack://orxe/./src/xpr.js","webpack://orxe/./src/orxe.js","webpack://orxe/./src/engine.js","webpack://orxe/./src/date-extensions.js","webpack://orxe/./src/extended-xpath.js","webpack://orxe/./src/utils/shuffle.js","webpack://orxe/./src/utils/ns.js","webpack://orxe/./src/utils/operation.js","webpack://orxe/./src/utils/native.js","webpack://orxe/./src/utils/input.js","webpack://orxe/./src/openrosa-extensions.js","webpack://orxe/./src/geo.js","webpack://orxe/./src/digest.js","webpack://orxe/external \"node-forge\"","webpack://orxe/./src/random-token.js"],"names":["DATE_STRING","dateToDays","d","rounded","temp","indexOf","Date","split","r","getTime","Math","round","module","exports","allowStringComparison","includeTimeForTodayString","returnCurrentTimeForToday","toNodes","n","v","iterateNext","push","getNamespaceAtts","result","name","unshift","toSnapshotResult","nodes","rt","singleItem","idx","resultType","singleNodeValue","length","snapshotLength","snapshotItem","i","val","t","number","string","date","Error","require","ExtendedXPathEvaluator","openrosaExtensions","config","extensions","extendedXPathEvaluator","openrosaXPathExtensions","customXPathFunction","getCurrentDomLevel3XPathBindings","XPathException","window","XPathExpression","XPathNSResolver","XPathResult","XPathNamespace","createExpression","document","createNSResolver","evaluate","createDomLevel3XPathBindings","options","evaluator","XPathEvaluator","e","contextPath","namespaceResolver","wrappedXpathEvaluator","node","startsWith","wrappedResultType","ANY_TYPE","xevaluator","apply","arguments","bindDomLevel3XPath","doc","bindings","newBindings","currentBindings","prototype","toISOLocalString","toString","dt","getTimezoneOffset","toISOString","replace","getTimezoneOffsetAsTime","offsetMinutesTotal","hours","minutes","direction","pad2","x","floor","abs","shuffle","isNamespaceExpr","handleNamespaceExpr","handleOperation","isNativeFunction","preprocessNativeArgs","inputArgs","preprocessInput","xpr","OP_PRECEDENCE","DIGIT","FUNCTION_NAME","NUMERIC_COMPARATOR","BOOLEAN_COMPARATOR","BOOLEAN_FN_COMPARATOR","COMPARATOR","INVALID_ARGS","TOO_MANY_ARGS","TOO_FEW_ARGS","wrapped","extendedFuncs","func","extendedProcessors","process","toInternalResult","NUMBER_TYPE","numberValue","BOOLEAN_TYPE","booleanValue","UNORDERED_NODE_ITERATOR_TYPE","textContent","stringValue","toExternalResult","res","then","STRING_TYPE","test","days","UNORDERED_SNAPSHOT_TYPE","Array","isArray","parseInt","callFn","args","hasOwnProperty","callExtended","Number","POSITIVE_INFINITY","NEGATIVE_INFINITY","callNative","argVals","argString","arg","quote","typefor","input","cN","nR","rT","isNaN","nodeType","ownerElement","exec","bargs","substring","ownerDocument","cur","stack","tokens","peek","err","message","JSON","stringify","newCurrent","pushOp","evalOp","lhs","op","rhs","handleInfix","evalOpAt","opIndex","splice","backtrack","j","ops","handleXpathExpr","expr","evaluated","includes","nextChar","charAt","finaliseNum","parseFloat","prevToken","peeked","isNum","c","sq","decimal","tail","pop","expectedReturnType","trim","prev","toLowerCase","MAX_INT32","MINSTD","array","seed","rng","isInteger","rnd","Random","nextFloat","bind","random","_seed","next","namespace","nsId","xnamespaces","xitems","attributes","ii","xattr","xitem","getAttributeNode","nodeName","localName","namespaceURI","nodeValue","namespaceNode","namespaces","namespaceKeys","items","attr","item","names","parentNode","xmlns","xml","sort","n1","n2","isNumber","value","nbr","NaN","undefined","Boolean","iii","k","l","m","p","q","NATIVE_FUNS","checkMinMaxArgs","min","max","checkNativeFn","isOperation","ARGS_REGEX","match","area","distance","areaOrDistance","digest","randomToken","openrosa_xpath_extensions","MILLIS_PER_DAY","RAW_NUMBER","XPR","_zeroPad","len","_int","_float","_str","_dateToString","getFullYear","getMonth","getDate","_round","num","_uuid_part","_date","it","keepTime","setDate","_dateForReturnType","uuid","format_date","format","sb","f","year","getYear","month","day","hour","getHours","minute","getMinutes","second","getSeconds","millis","getMilliseconds","secTicks","dow","getDay","locale","enketoFormLocale","toLocaleDateString","weekday","ret","now_and_today","resetTime","_now","acos","asin","atan","atan2","y","checklist","trues","coalesce","a","b","concat","out","join","cos","counter","s","parts","count","parse","time","dec","today","msg","algo","encoding","exp","exp10","pow","con","exists","endsWith","delim","log","log10","not","now","once","Infinity","pi","PI","position","tagName","previousElementSibling","randomize","regex","haystack","pattern","RegExp","num_digits","selected","needle","list","index","sin","sqrt","substr","startIndex","endIndex","slice","sum","tan","values","weights","weightedTrues","w","type","StringType","NumberType","BooleanType","DateType","add","fnObj","remove","all","EARTH_EQUATORIAL_RADIUS_METERS","PRECISION","_toLatLngs","geopoints","map","geopoint","_toRadians","angle","_latLngsValid","latLngs","every","coords","_distanceBetween","p1","p2","Δλ","lng","φ1","lat","φ2","fn","pointsCount","forge","md","create","update","hashBuffer","util","encode64","bytes","toHex","_random13chars","loops","ceil","fill","reduce"],"mappings":"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","file":"orxe.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"node-forge\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"orxe\", [\"node-forge\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"orxe\"] = factory(require(\"node-forge\"));\n\telse\n\t\troot[\"orxe\"] = factory(root[\"node-forge\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__16__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n","var DATE_STRING = /^\\d\\d\\d\\d-\\d{1,2}-\\d{1,2}(?:T\\d\\d:\\d\\d:\\d\\d\\.?\\d?\\d?(?:Z|[+-]\\d\\d:\\d\\d)|.*)?$/;\n\nfunction dateToDays(d, rounded) {\n  var temp = null;\n  if(d.indexOf('T') > 0) {\n    temp = new Date(d);\n  } else {\n    temp = d.split('-');\n    temp = new Date(temp[0], temp[1]-1, temp[2]);\n  }\n  var r = (temp.getTime()) / (1000 * 60 * 60 * 24);\n  return rounded === false ? r : Math.round(r*100000)/100000;\n}\n\nmodule.exports = {\n  DATE_STRING,\n  dateToDays\n};\n","module.exports = {\n  allowStringComparison: false,\n  includeTimeForTodayString: false,\n  returnCurrentTimeForToday: false\n};\n","function toNodes(r) {\n  var n, v = [];\n  while((n = r.iterateNext())) v.push(n);\n  return v;\n}\n\nfunction getNamespaceAtts(result) {\n  var v = [], n;\n  while((n = result.iterateNext())) {\n    if(n.name.indexOf(':')>0) v.unshift(n);\n  }\n  return v;\n}\n\nfunction toSnapshotResult(nodes, rt, singleItem) {\n  return function() {\n    var idx = 0;\n    return {\n      resultType: rt,\n      singleNodeValue: nodes.length ? singleItem || nodes[0] : null,\n      snapshotLength: nodes.length,\n      snapshotItem: function(i){return nodes[i];},\n      iterateNext: function(){return nodes.length > idx ? nodes[idx++] : null;}\n    };\n  }();\n}\n\nmodule.exports = {\n  getNamespaceAtts,\n  toNodes,\n  toSnapshotResult\n};\n","module.exports = {\n  nodes: function(val) { return { t:'nodes', v:val }; },\n  boolean: function(val) { return { t:'bool', v:val }; },\n  number: function(val) { return { t:'num', v:val }; },\n  string: function(val) { return { t:'str', v:val }; },\n  date: function(val) {\n    if(!(val instanceof Date)) throw new Error('Cannot create date from ' + val + ' (' + (typeof val) + ')');\n    return { t:'date', v:val };\n  }\n};\n","module.exports = require('./engine');\n","require('./date-extensions');\r\nvar ExtendedXPathEvaluator = require('./extended-xpath');\r\nvar openrosaExtensions = require('./openrosa-extensions');\r\nvar config = require('./config');\r\nvar extensions = openrosaExtensions(config);\r\n\r\nmodule.exports = (function(){\r\n\r\n  var module = {\r\n    extendedXPathEvaluator: ExtendedXPathEvaluator,\r\n    openrosaXPathExtensions: openrosaExtensions,\r\n    config: config,\r\n    customXPathFunction: extensions.customXPathFunction,\r\n\r\n    /**\r\n\t\t * Get the current list of DOM Level 3 XPath window and document objects\r\n\t\t * that are in use.\r\n\t\t *\r\n\t\t * @return {Object} List of DOM Level 3 XPath window and document objects\r\n\t\t *         that are currently in use.\r\n\t\t */\r\n\t\tgetCurrentDomLevel3XPathBindings: function()\r\n\t\t{\r\n\t\t\treturn {\r\n\t\t\t\t'window': {\r\n\t\t\t\t\tXPathException: window.XPathException,\r\n\t\t\t\t\tXPathExpression: window.XPathExpression,\r\n\t\t\t\t\tXPathNSResolver: window.XPathNSResolver,\r\n\t\t\t\t\tXPathResult: window.XPathResult,\r\n\t\t\t\t\tXPathNamespace: window.XPathNamespace\r\n\t\t\t\t},\r\n\t\t\t\t'document': {\r\n\t\t\t\t\tcreateExpression: document.createExpression,\r\n\t\t\t\t\tcreateNSResolver: document.createNSResolver,\r\n\t\t\t\t\tevaluate: document.evaluate\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Get the list of DOM Level 3 XPath objects that are implemented by\r\n\t\t * the XPathJS module.\r\n\t\t *\r\n\t\t * @return {Object} List of DOM Level 3 XPath objects implemented by\r\n\t\t *         the XPathJS module.\r\n\t\t */\r\n\t\tcreateDomLevel3XPathBindings: function(options)\r\n\t\t{\r\n\t\t\tvar evaluator = new XPathEvaluator(options);\r\n\r\n\t\t\treturn {\r\n\t\t\t\t'document': {\r\n          evaluate: function(e, contextPath, namespaceResolver, resultType, result) {\r\n            var wrappedXpathEvaluator = function(v, node, rt) {\r\n              if(resultType < 7 || v.startsWith('//')) resultType = null;\r\n              var wrappedResultType = rt || resultType || XPathResult.ANY_TYPE;\r\n              return evaluator.evaluate(v, node || contextPath, namespaceResolver, wrappedResultType || XPathResult.ANY_TYPE, result);\r\n            };\r\n            var xevaluator = new ExtendedXPathEvaluator(wrappedXpathEvaluator, extensions);\r\n            return xevaluator.evaluate.apply(xevaluator, arguments);\r\n          }\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Bind DOM Level 3 XPath interfaces to the DOM.\r\n\t\t *\r\n\t\t * @param {Object} doc the document or (Document.prototype!) to bind the evaluator etc. to\r\n\t\t * @return List of original DOM Level 3 XPath objects that has been replaced\r\n\t\t */\r\n\t\tbindDomLevel3XPath: function(doc, bindings)\r\n\t\t{\r\n\t\t\tvar newBindings = (bindings || module.createDomLevel3XPathBindings()),\r\n\t\t\t\tcurrentBindings = module.getCurrentDomLevel3XPathBindings(),\r\n\t\t\t\ti\r\n\t\t\t;\r\n\r\n\t\t\tdoc = doc || document;\r\n\r\n\t\t\tfor(i in newBindings['document'])\r\n\t\t\t{\r\n\t\t\t\tdoc[i] = newBindings['document'][i];\r\n\t\t\t}\r\n\r\n\t\t\treturn currentBindings;\r\n\t\t}\r\n  };\r\n\treturn module;\r\n\r\n})();\r\n","/**\n * Converts a native Date UTC String to a RFC 3339-compliant date string with local offsets\n * used in ODK, so it replaces the Z in the ISOstring with a local offset\n * @return {string} a datetime string formatted according to RC3339 with local offset\n */\nDate.prototype.toISOLocalString = function() {\n  //2012-09-05T12:57:00.000-04:00 (ODK)\n\n  if(this.toString() === 'Invalid Date') {\n    return this.toString();\n  }\n\n  var dt = new Date(this.getTime() - (this.getTimezoneOffset() * 60 * 1000)).toISOString()\n      .replace('Z', this.getTimezoneOffsetAsTime());\n\n  if(dt.indexOf('T00:00:00.000') > 0) {\n    return dt.split('T')[0];\n  } else {\n    return dt;\n  }\n};\n\nDate.prototype.getTimezoneOffsetAsTime = function() {\n  var offsetMinutesTotal;\n  var hours;\n  var minutes;\n  var direction;\n  var pad2 = function(x) {\n    return (x < 10) ? '0' + x : x;\n  };\n\n  if(this.toString() === 'Invalid Date') {\n    return this.toString();\n  }\n\n  offsetMinutesTotal = this.getTimezoneOffset();\n\n  direction = (offsetMinutesTotal < 0) ? '+' : '-';\n  hours = pad2(Math.floor(Math.abs(offsetMinutesTotal / 60)));\n  minutes = pad2(Math.floor(Math.abs(offsetMinutesTotal % 60)));\n\n  return direction + hours + ':' + minutes;\n};\n","var config = require('./config');\nvar shuffle = require('./utils/shuffle');\nvar {isNamespaceExpr, handleNamespaceExpr} = require('./utils/ns');\nvar {handleOperation} = require('./utils/operation');\nvar {isNativeFunction, preprocessNativeArgs} = require('./utils/native');\nvar {DATE_STRING, dateToDays} = require('./utils/date');\nvar {toNodes, toSnapshotResult} = require('./utils/result');\nvar {inputArgs, preprocessInput} = require('./utils/input');\nvar xpr = require('./xpr');\n/*\n * From http://www.w3.org/TR/xpath/#section-Expressions XPath infix\n * operator precedence is left-associative, and as follows:\n */\nvar OP_PRECEDENCE = [\n  ['|'],\n  ['&'],\n  ['=', '!='],\n  ['<', '<=', '>=', '>'],\n  ['+', '-'],\n  ['*', '/', '%']\n];\n\nvar DIGIT = /[0-9]/;\nvar FUNCTION_NAME = /^[a-z]/;\nvar NUMERIC_COMPARATOR = /(>|<)/;\nvar BOOLEAN_COMPARATOR = /(=)/;\nvar BOOLEAN_FN_COMPARATOR = /(true\\(\\)|false\\(\\))/;\nvar COMPARATOR = /(=|<|>)/;\n\nvar INVALID_ARGS = new Error('invalid args');\nvar TOO_MANY_ARGS = new Error('too many args');\nvar TOO_FEW_ARGS = new Error('too few args');\n\n// TODO remove all the checks for cur.t==='?' - what else woudl it be?\nvar ExtendedXPathEvaluator = function(wrapped, extensions) {\n  var\n    extendedFuncs = extensions.func || {},\n    extendedProcessors = extensions.process || {},\n    toInternalResult = function(r) {\n      var n, v;\n      if(r.resultType === XPathResult.NUMBER_TYPE) return { t:'num', v:r.numberValue };\n      if(r.resultType === XPathResult.BOOLEAN_TYPE) return {  t:'bool', v:r.booleanValue };\n      if(r.resultType === XPathResult.UNORDERED_NODE_ITERATOR_TYPE) {\n        v = [];\n        while((n = r.iterateNext())) v.push(n.textContent);\n        return { t:'arr', v:v };\n      }\n      return { t:'str', v:r.stringValue };\n    },\n    toExternalResult = function(r, rt) {\n      if(extendedProcessors.toExternalResult) {\n        var res = extendedProcessors.toExternalResult(r);\n        if(res) return res;\n      }\n\n      // returns promise\n      if(r.v && typeof r.v.then === 'function' && rt === XPathResult.STRING_TYPE) {\n        return {resultType: XPathResult.STRING_TYPE, stringValue: r.v};\n      }\n\n      if((r.t === 'arr' && rt === XPathResult.NUMBER_TYPE && DATE_STRING.test(r.v[0])) ||\n          (r.t === 'str' && rt === XPathResult.NUMBER_TYPE && DATE_STRING.test(r.v))) {\n        var val = r.t === 'arr' ? r.v[0] : r.v;\n        var days = dateToDays(val);\n        return {\n          resultType:XPathResult.NUMBER_TYPE,\n          numberValue:days,\n          stringValue:days\n        };\n      }\n\n      if(r.t === 'num') return { resultType:XPathResult.NUMBER_TYPE, numberValue:r.v, stringValue:r.v.toString() };\n      if(r.t === 'bool')return { resultType:XPathResult.BOOLEAN_TYPE, booleanValue:r.v, stringValue:r.v.toString() };\n\n      if(rt > 3) {\n        r = shuffle(r[0], r[1]);\n        return toSnapshotResult(r, XPathResult.UNORDERED_SNAPSHOT_TYPE);\n      }\n\n      if(!r.t && Array.isArray(r)) {\n        if(rt === XPathResult.NUMBER_TYPE) {\n          var v = parseInt(r[0].textContent);\n          return { resultType:XPathResult.NUMBER_TYPE, numberValue:v, stringValue:v.toString() };\n        } else if(rt === XPathResult.STRING_TYPE) {\n          return { resultType:XPathResult.STRING_TYPE, stringValue: r.length ? r[0] : '' };\n        }\n      }\n\n      return { resultType:XPathResult.STRING_TYPE, stringValue: r.v===null ? '' : r.v.toString() };\n    },\n    callFn = function(name, args, rt) {\n      if(extendedFuncs.hasOwnProperty(name)) {\n        // if(rt && (/^(date|true|false|now$|today$|randomize$)/.test(name))) args.push(rt);\n        if(rt && (/^(date|now$|today$|randomize$)/.test(name))) args.push(rt);\n        if(/^(true$|false$)/.test(name)) args.push(rt || XPathResult.BOOLEAN_TYPE);\n        return callExtended(name, args);\n      }\n\n      if(name === 'normalize-space' && args.length) {\n        var res = args[0].v;\n        res = res.replace(/\\f/g, '\\\\f');\n        res = res.replace(/\\r\\v/g, '\\v');\n        res = res.replace(/\\v/g, '\\\\v');\n        res = res.replace(/\\s+/g, ' ');\n        res = res.replace(/^\\s+|\\s+$/g, '');\n        res = res.replace(/\\\\v/g, '\\v');\n        res = res.replace(/\\\\f/g, '\\f');\n        return {t: 'str', v: res};\n      }\n\n      if(name === 'string' && args.length > 0 && (\n        args[0].v === Number.POSITIVE_INFINITY ||\n        args[0].v === Number.NEGATIVE_INFINITY ||\n        args[0].v !== args[0].v )) {//NaN\n        return { t:'str', v: args[0].v };\n      }\n      return callNative(name, preprocessNativeArgs(name, args));\n    },\n    callExtended = function(name, args) {\n      var argVals = [], res, i;\n      for(i=0; i<args.length; ++i) argVals.push(args[i]);\n      res = extendedFuncs[name].apply(null, argVals);\n      return res;\n    },\n    callNative = function(name, args) {\n      var argString = '', arg, quote, i;\n      for(i=0; i<args.length; ++i) {\n        arg = args[i];\n        if(arg.t !== 'num' && arg.t !== 'bool') {\n          quote = arg.v.indexOf('\"') === -1 ? '\"' : \"'\";\n          argString += quote;\n        }\n        argString += arg.v;\n        if(arg.t === 'bool') argString += '()';\n        if(arg.t !== 'num' && arg.t !== 'bool') argString += quote;\n        if(i < args.length - 1) argString += ', ';\n      }\n      return toInternalResult(wrapped(name + '(' + argString + ')'));\n    },\n    typefor = function(val) {\n      if(extendedProcessors.typefor) {\n        var res = extendedProcessors.typefor(val);\n        if(res) return res;\n      }\n      if(typeof val === 'boolean') return 'bool';\n      if(typeof val === 'number') return 'num';\n      return 'str';\n    };\n\n  /**\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/Document/evaluate\n   */\n  this.evaluate = function(input, cN, nR, rT) {\n    input = preprocessInput(input, rT);\n    if(isNamespaceExpr(input)) return handleNamespaceExpr(input, cN);\n\n    if(isNativeFunction(input)) {\n      var args = inputArgs(input);\n      if(args.length && args[0].length && !isNaN(args[0])) { throw INVALID_ARGS; }\n      if(input === 'lang()') throw TOO_FEW_ARGS;\n      if(/^lang\\(/.test(input) && cN.nodeType === 2) cN = cN.ownerElement;\n      var res = wrapped(input, cN);\n      if(rT === XPathResult.NUMBER_TYPE &&\n        (res.resultType === XPathResult.UNORDERED_NODE_ITERATOR_TYPE ||\n         res.resultType === XPathResult.UNORDERED_NODE_ITERATOR_TYPE)) {\n        var val = parseInt(res.iterateNext().textContent);\n        return {\n          resultType: XPathResult.NUMBER_TYPE,\n          numberValue: val,\n          stringValue: val\n        };\n      }\n      return res;\n    }\n\n    if((rT > 3 && !input.startsWith('randomize')) ||\n      /^count\\(|boolean\\(/.test(input)) {\n\n      if(input.startsWith('count(')) {\n        if(input.indexOf(',') > 0) throw TOO_MANY_ARGS;\n        if(input === 'count()') throw TOO_FEW_ARGS;\n        if(!isNaN(/\\((.*)\\)/.exec(input)[1])) throw INVALID_ARGS;//firefox\n      }\n      if(input.startsWith('boolean(')) { //firefox\n        if(input === 'boolean()') throw TOO_FEW_ARGS;\n        var bargs = input.substring(8, input.indexOf(')')).split(',');\n        if(bargs.length > 1) throw TOO_MANY_ARGS;\n      }\n      if(input === '/') cN = cN.ownerDocument || cN;\n      return wrapped(input, cN);\n    }\n\n    if(rT === XPathResult.BOOLEAN_TYPE && input.indexOf('(') < 0 &&\n        input.indexOf('/') < 0 && input.indexOf('=') < 0 &&\n        input.indexOf('!=') < 0) {\n      input = input.replace(/(\\n|\\r|\\t)/g, '');\n      input = input.replace(/\"(\\d)\"/g, '$1');\n      input = input.replace(/'(\\d)'/g, '$1');\n      input = \"boolean-from-string(\"+input+\")\";\n    }\n\n    if(rT === XPathResult.NUMBER_TYPE && input.indexOf('string-length') < 0) {\n      input = input.replace(/(\\n|\\r|\\t)/g, '');\n    }\n\n    var i, cur, stack = [{ t:'root', tokens:[] }],\n      peek = function() { return stack[stack.length-1]; },\n      err = function(message) { throw new Error((message||'') + ' [stack=' + JSON.stringify(stack) + '] [cur=' + JSON.stringify(cur) + ']'); },\n      newCurrent = function() { cur = { t:'?', v:'' }; },\n      pushOp = function(t) {\n        peek().tokens.push({ t:'op', v:t });\n        newCurrent();\n      },\n      evalOp = function(lhs, op, rhs) {\n        if(extendedProcessors.handleInfix) {\n          var res = extendedProcessors.handleInfix(err, lhs, op, rhs);\n          if(res && res.t === 'continue') {\n            lhs = res.lhs; op = res.op; rhs = res.rhs; res = null;\n          }\n\n          if(typeof res !== 'undefined' && res !== null) return res;\n        }\n        return handleOperation(lhs, op, rhs, config);\n      },\n      evalOpAt = function(tokens, opIndex) {\n        var res = evalOp(\n            tokens[opIndex - 1],\n            tokens[opIndex],\n            tokens[opIndex + 1]);\n\n        if(typeof res !== 'undefined' && res !== null) {\n          tokens.splice(opIndex, 2);\n          tokens[opIndex - 1] = { t:typefor(res), v:res };\n        }\n      },\n      backtrack = function() {\n        // handle infix operators\n        var i, j, ops, tokens;\n        tokens = peek().tokens;\n        for(j=OP_PRECEDENCE.length-1; j>=0; --j) {\n          ops = OP_PRECEDENCE[j];\n          i = 1;\n          while(i < tokens.length-1) {\n            if(tokens[i].t === 'op' && ops.indexOf(tokens[i].v) !== -1) {\n              evalOpAt(tokens, i);\n            } else ++i;\n          }\n        }\n      },\n      handleXpathExpr = function() {\n        var expr = cur.v;\n        var evaluated;\n        if(['position'].includes(peek().v)) {\n          evaluated = wrapped(expr);\n        } else {\n          if(rT > 3 || (cur.v.indexOf('position()=') >= 0 &&\n            stack.length === 1 && !/^[a-z]*[(|[]{1}/.test(cur.v))) {\n            evaluated = toNodes(wrapped(expr));\n          } else {\n            if(expr.startsWith('$')) {\n              evaluated = expr;\n            } else {\n              evaluated = toInternalResult(wrapped(expr, cN));\n            }\n          }\n        }\n        peek().tokens.push(evaluated);\n        newCurrent();\n      },\n      nextChar = function() {\n        return input.charAt(i+1);\n      },\n      finaliseNum = function() {\n        cur.v = parseFloat(cur.string);\n        peek().tokens.push(cur);\n        newCurrent();\n      },\n      prevToken = function() {\n        var peeked = peek().tokens;\n        return peeked[peeked.length - 1];\n      },\n      isNum = function(c) {\n        return c >= '0' && c <= '9';\n      };\n\n    newCurrent();\n\n    for(i=0; i<input.length; ++i) {\n      var c = input.charAt(i);\n      if(cur.sq) {\n        cur.v += c;\n        if(c === ']') --cur.sq;\n        else if(c === '[') ++cur.sq;\n        continue;\n      }\n      if(cur.t === 'str') {\n        if(c === cur.quote) {\n          peek().tokens.push(cur);\n          newCurrent();\n        } else cur.v += c;\n        continue;\n      }\n      if(cur.t === 'num') {\n        if(DIGIT.test(c) || ['e', '\"', \"'\"].includes(c) ||\n            (c === '-' && input[i-1] === 'e')) {\n          cur.string += c;\n          continue;\n        } else if(c === ' ' && cur.string === '-') {\n          continue;\n        } else if(c === '.' && !cur.decimal) {\n          cur.decimal = 1;\n          cur.string += c;\n        } else finaliseNum();\n      }\n      if(isNum(c)) {\n        if(cur.v === '') {\n          cur = { t:'num', string:c };\n        } else cur.v += c;\n      } else switch(c) {\n        case \"'\":\n        case '\"':\n          if(cur.v === '') {\n            cur = { t:'str', quote:c, v:'' };\n          } else err('Not sure how to handle: ' + c);\n          break;\n        case '(':\n          cur.t = 'fn';\n          cur.tokens = [];\n          stack.push(cur);\n          if(cur.v === 'once') {\n            newCurrent();\n            cur.v = '.';\n            handleXpathExpr();\n          }\n          newCurrent();\n\n          break;\n        case ')':\n          if(nextChar() === '[') {\n            // collapse the stack, and let the native evaluator handle this...\n            var tail = stack.pop();\n            tail.v = tail.v + '(' + cur.v + c;\n            tail.t = '?';\n            cur = tail;\n            break;\n          }\n\n          if(cur.v !== '') handleXpathExpr();\n          backtrack();\n          cur = stack.pop();\n\n          if(cur.t !== 'fn') err();\n          if(cur.v) {\n            var expectedReturnType = rT;\n            if(rT === XPathResult.BOOLEAN_TYPE) {\n              if(NUMERIC_COMPARATOR.test(input) && !BOOLEAN_FN_COMPARATOR.test(input)) expectedReturnType = XPathResult.NUMBER_TYPE;\n              if(BOOLEAN_COMPARATOR.test(input)) expectedReturnType = XPathResult.BOOLEAN_TYPE;\n              if(COMPARATOR.test(input) && cur.t === 'fn' && /^(date|date-time)$/.test(cur.v)) {\n                expectedReturnType = XPathResult.STRING_TYPE;\n              }\n            }\n            var res = callFn(cur.v, cur.tokens, expectedReturnType);\n            if(cur.v === 'node' && res.t === 'arr' && res.v.length > 0)\n              res.v = [res.v[0]]; // only interested in first element\n            peek().tokens.push(res);\n          } else {\n            if(cur.tokens.length !== 1) err();\n            peek().tokens.push(cur.tokens[0]);\n          }\n          newCurrent();\n          break;\n        case ',':\n          if(cur.v !== '') handleXpathExpr();\n          if(peek().t !== 'fn') err();\n          break;\n        case '*':\n          if(c === '*' && (cur.v !== '' || peek().tokens.length === 0)) {\n            cur.v += c;\n            if(cur.v === './*') handleXpathExpr();\n          } else if(cur.v === '' &&\n            ([')', ''].includes(nextChar()) ||\n            input.substring(i+1).trim() === ')')) {\n            cur.v = c;\n            handleXpathExpr();\n          } else {\n            pushOp(c);\n          }\n          break;\n        case '-':\n          var prev = prevToken();\n          if(cur.v !== '' && nextChar() !== ' ' && input.charAt(i-1) !== ' ') {\n            // function name expr\n            cur.v += c;\n          } else if((peek().tokens.length === 0 && cur.v === '') ||\n            (prev && prev.t === 'op') ||\n            // two argument function\n            (prev && prev.t === 'num' && stack.length > 1 && stack[1].t === 'fn') ||\n            // negative argument\n            (prev && prev.t !== 'num' && isNum(nextChar()))) {\n            // -ve number\n            cur = { t:'num', string:'-' };\n          } else {\n            if(cur.v !== '') {\n              if(!DIGIT.test(cur.v) && input[i-1] !== ' ') throw INVALID_ARGS;\n              peek().tokens.push(cur);\n            }\n            pushOp(c);\n          }\n          break;\n        case '=':\n          if(cur.v === '<' || cur.v === '&lt;' ||\n              cur.v === '>' || cur.v === '&gt;' || cur.v === '!') {\n            cur.v += c;\n            switch(cur.v) {\n              case '<=': case '&lt;=': pushOp('<='); break;\n              case '>=': case '&gt;=': pushOp('>='); break;\n              case '!=':               pushOp('!='); break;\n            }\n          } else {\n            if(cur.v) handleXpathExpr();\n            pushOp(c);\n          }\n          break;\n        case ';':\n          switch(cur.v) {\n            case '&lt': cur.v = ''; c = '<'; break;\n            case '&gt': cur.v = ''; c = '>'; break;\n            default: cur.v += c; continue;\n          }\n          /* falls through */\n        case '>':\n        case '<':\n          if(cur.v) handleXpathExpr();\n          if(nextChar() === '=') {\n            cur.v = c; break;\n          }\n          /* falls through */\n        case '+':\n          pushOp(c);\n          break;\n        case ' ':\n          switch(cur.v) {\n            case '': break; // trim leading whitespace\n            case 'mod': pushOp('%'); break;\n            case 'div': pushOp('/'); break;\n            case 'and': pushOp('&'); break;\n            case 'or':  pushOp('|'); break;\n            default: {\n              var op = cur.v.toLowerCase();\n              if(/^(mod|div|and|or)$/.test(op)) throw INVALID_ARGS;\n              if(!FUNCTION_NAME.test(cur.v)) handleXpathExpr();\n            }\n          }\n          break;\n        case '[':\n          cur.sq = (cur.sq || 0) + 1;\n          /* falls through */\n        case '.':\n          if(cur.v === '' && nextChar() === ')') {\n            cur.v = c;\n            handleXpathExpr();\n            break;\n          }\n          if(cur.v === '' && isNum(nextChar())) {\n            cur = { t:'num', string:c };\n            break;\n          }\n          /* falls through */\n        default:\n          cur.v += c;\n      }\n    }\n    if(cur.t === 'num') finaliseNum();\n    if(cur.t === '?' && cur.v !== '') handleXpathExpr();\n    if(cur.t !== '?' || cur.v !== '' || (cur.tokens && cur.tokens.length)) err('Current item not evaluated!');\n    if(stack.length > 1) err('Stuff left on stack.');\n    if(stack[0].t !== 'root') err('Weird stuff on stack.');\n    if(stack[0].tokens.length === 0) err('No tokens.');\n    if(stack[0].tokens.length >= 3) backtrack();\n    if(stack[0].tokens.length > 1) err('Too many tokens.');\n    return toExternalResult(stack[0].tokens[0], rT);\n  };\n\n};\n\nmodule.exports = ExtendedXPathEvaluator;\n","var MAX_INT32 = 2147483647;\nvar MINSTD = 16807;\n\n/**\n * Performs the \"inside-out\" variant of the Fisher-Yates array shuffle.\n *\n * @see https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle#The_%22inside-out%22_algorithm\n *\n * @param  {<*>}        array the array to shuffle\n * @param  {number=}    seed the seed value\n * @return {<*>}        the suffled array\n */\nfunction shuffle(array, seed) {\n  var rng;\n  var result = [];\n\n  if(typeof seed !== 'undefined'){\n    if(!Number.isInteger(seed)) {\n      throw new Error('Invalid seed argument. Integer required.');\n    }\n    var rnd = new Random(seed);\n    rng = rnd.nextFloat.bind(rnd);\n  } else {\n    rng = Math.random;\n  }\n\n  for (var i = 0; i < array.length; ++i) {\n    var j = Math.floor(rng() * (i + 1));\n    if(j !== i) {\n      result[i] = result[j];\n    }\n    result[j] = array[i];\n  }\n  return result;\n}\n\n/**\n * Creates a the Park-Miller PRNG pseudo-random value generator.\n * The seed must be an integer.\n *\n * Adapted from: https://gist.github.com/blixt/f17b47c62508be59987b\n */\nfunction Random(seed) {\n    this._seed = seed % MAX_INT32;\n\tif(this._seed <= 0) {\n\t\tthis._seed += (MAX_INT32 - 1);\n\t}\n}\n\n/**\n * Returns a pseudo-random integer value.\n */\nRandom.prototype.next = function () {\n  this._seed = this._seed * MINSTD % MAX_INT32;\n  return this._seed;\n};\n\n/**\n * Returns a pseudo-random floating point number in range [0, 1).\n */\nRandom.prototype.nextFloat = function () {\n    // We know that result of next() will be 1 to 2147483646 (inclusive).\n    return (this.next() - 1) / (MAX_INT32 - 1);\n};\n\nmodule.exports = shuffle;\n","var {toSnapshotResult} = require('./result');\n\nfunction namespace(input, cN) {\n  var nsId = input.substring(11);\n  var xnamespaces = [];\n  var xitems = [];\n  if(cN.attributes) {\n    for(var ii=0; ii<cN.attributes.length; ii++) {\n      var xattr = cN.attributes[ii];\n      var xitem = xattr.ownerElement.getAttributeNode(xattr.name);\n      if(xitem.nodeName === 'xmlns:'+nsId) {\n        xitems.push(xitem);\n        xnamespaces.push({\n          nodeName: '#namespace',\n          localName: nsId,\n          namespaceURI: xitem.nodeValue\n        });\n      }\n    }\n  }\n  return toSnapshotResult(xnamespaces);\n}\n\nfunction namespaceNode(cN) {\n  var namespaces = [];\n  var namespaceKeys = {};\n  var items = [];\n  var node = cN;\n  while(node) {\n    if(node.attributes) {\n      for(var j=0; j<node.attributes.length; j++) {\n        var attr = node.attributes[j];\n        var item = attr.ownerElement.getAttributeNode(attr.name);\n        if(item.nodeName.startsWith('xmlns') && !namespaceKeys[item.nodeName]) {\n          var names = item.nodeName.split(':');\n          namespaceKeys[item.nodeName] = item.nodeName;\n          if(item.nodeValue.length) {\n            items.push(item);\n            namespaces.push({\n              nodeName: '#namespace',\n              localName: names.length > 1 ? names[1] : '',\n              namespaceURI: item.nodeValue\n            });\n          }\n        }\n      }\n    }\n    node = cN.nodeType === 1 ? node.parentNode : null;\n  }\n  if(namespaces.length > 0 && !namespaceKeys.xmlns) {\n    namespaces.push({nodeName: '#namespace', localName: 'xmlns', namespaceURI: 'http://www.w3.org/1999/xhtml'});\n  }\n  if(namespaces.length > 0 && !namespaceKeys.xml) {\n    namespaces.push({nodeName: '#namespace', localName: 'xml', namespaceURI: 'http://www.w3.org/XML/1998/namespace'});\n  }\n  namespaces = namespaces.sort(function(n1, n2){\n    if(n1.localName < n2.localName){ return -1;}\n    if(n1.localName > n2.localName){ return 1;}\n    return 0;\n  });\n  return toSnapshotResult(namespaces, 7, items[0]);\n}\n\nfunction isNamespaceExpr(input) {\n  return /^(namespace::node\\(\\)|namespace::\\*)$/.test(input)\n    || /^namespace::/.test(input);\n}\n\nfunction handleNamespaceExpr(input, cN) {\n  if(/^(namespace::node\\(\\)|namespace::\\*)$/.test(input)) {\n    return namespaceNode(cN);\n  }\n\n  if(/^namespace::/.test(input)) {\n    return namespace(input, cN);\n  }\n}\n\nmodule.exports = {\n  isNamespaceExpr,\n  handleNamespaceExpr\n};\n","var {dateToDays} = require('./date');\n\nfunction isNumber(value) {\n  if(typeof value === 'string') {\n    var nbr = value.replace(/[\"']/g, \"\");\n    // return nbr.trim().length && /^\\d+$/.test(nbr.trim());\n    return nbr.trim().length && !isNaN(nbr.trim());\n  }\n  return typeof value === 'number';\n}\n\nfunction handleOperation(lhs, op, rhs, config) {\n  //Removes quotes for numbers\n  if(op.v === '+' && isNumber(lhs.v) && isNumber(rhs.v)) {\n    lhs.v = Number(lhs.v);\n    rhs.v = Number(rhs.v);\n  }\n\n  //Comparing node expressions with numbers/strings/etc\n  if(lhs.t === 'arr' && lhs.v.length === 1 && rhs.t === 'num') {\n    if (/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/.test(lhs.v[0])) {\n      lhs = {t: 'num', v: dateToDays(lhs.v[0], false)};\n    }\n  }\n  if(rhs.t === 'arr' && rhs.v.length === 1 && lhs.t === 'num') {\n    if (/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/.test(rhs.v[0])) {\n      rhs = {t: 'num', v: dateToDays(rhs.v[0], false)};\n    }\n  }\n\n  if(lhs.t === 'arr' && lhs.v.length === 1 && rhs.t === 'str') {\n    lhs = {t: 'str', v: lhs.v[0]};\n  }\n  if(rhs.t === 'arr' && rhs.v.length === 1 && lhs.t === 'str') {\n    rhs = {t: 'str', v: rhs.v[0]};\n  }\n  if(rhs.t === 'arr' && rhs.v.length === 1 &&\n    lhs.t === 'arr' && lhs.v.length === 1) {\n    lhs = {t: 'str', v: lhs.v[0]};\n    rhs = {t: 'str', v: rhs.v[0]};\n  }\n\n  if(lhs.t === 'str' && /^\\d\\d\\d\\d-\\d{1,2}-\\d{1,2}/.test(lhs.v)) {\n    lhs = {t: 'num', v: dateToDays(lhs.v, false)};\n  }\n\n  if(rhs.t === 'str' && /^\\d\\d\\d\\d-\\d{1,2}-\\d{1,2}/.test(rhs.v)) {\n    rhs = {t: 'num', v: dateToDays(rhs.v, false)};\n  }\n\n  if(op.v === '-' && (isNaN(lhs.v) || isNaN(rhs.v))) {\n    return NaN;\n  }\n\n  if(/^(=|!=)$/.test(op.v)) {\n    if(lhs.t === 'str' && rhs.t === 'bool') {\n      if(lhs.v.length > 0 && lhs.v === '1') {\n        lhs = {t: 'bool', v: true};\n      } else if(lhs.v === '') {\n        lhs = {t: 'bool', v: false};\n      } else {\n        lhs = {t: 'bool', v: undefined};\n      }\n    }\n    if(rhs.t === 'str' && lhs.t === 'bool') {\n      if(rhs.v.length > 0 && rhs.v === '1') {\n        rhs = {t: 'bool', v: true};\n      } else if(rhs.v === '') {\n        rhs = {t: 'bool', v: false};\n      } else {\n        rhs = {t: 'bool', v: undefined};\n      }\n    }\n\n    if(lhs.t === 'num' && rhs.t === 'bool') {\n      lhs = {t: 'bool', v: Boolean(lhs.v)};\n    }\n    if(rhs.t === 'num' && lhs.t === 'bool') {\n      rhs = {t: 'bool', v: Boolean(rhs.v)};\n    }\n  }\n\n  switch(op.v) {\n    case '+':  return lhs.v + rhs.v;\n    case '-':  return lhs.v - rhs.v;\n    case '*':  return lhs.v * rhs.v;\n    case '/':  return lhs.v / rhs.v;\n    case '%':  return lhs.v % rhs.v;\n    case '=':\n      if(/^(num|str)$/.test(lhs.t) && rhs.t === 'arr') {return rhs.v.includes(lhs.string || lhs.v);}\n      if(/^(num|str)$/.test(rhs.t) && lhs.t === 'arr') {return lhs.v.includes(rhs.string || rhs.v);}\n      if(lhs.t === 'bool' && rhs.t === 'arr') {return lhs.v === rhs.v.length > 0;}\n      if(rhs.t === 'bool' && lhs.t === 'arr') {return rhs.v === lhs.v.length > 0;}\n\n      return lhs.v == rhs.v;\n    case '<':\n      if(lhs.t === 'bool') {\n        if(lhs.v === false && rhs.t === 'arr' && rhs.v.length > 0) return true;\n        if(lhs.v === true && rhs.t === 'num') return 1 < rhs.v;\n        if(lhs.v === false && rhs.t === 'num') return 0 < rhs.v;\n        if(lhs.v === false && rhs.t === 'bool') return rhs.v === true;\n        return false;\n      }\n      if(rhs.t === 'bool') {\n        if(rhs.v === true && lhs.t === 'arr' && lhs.v.length === 0) return true;\n        if(rhs.v === true && lhs.t === 'num' && lhs.v < 1) return true;\n        return false;//rhs = {t: 'num', v: rhs.v === true ? 1 : 0, string: rhs.v === true ? '1' : '0'};\n      }\n\n      if(lhs.t === 'arr' && lhs.v.length > 0) {\n        for(var iii=0;iii<lhs.v.length;iii++) {\n          if(Number(lhs.v[iii]) < rhs.v) return true;\n        }\n        return false;\n      }\n      if(rhs.t === 'arr' && rhs.v.length > 0) {\n        for(var k=0;k<rhs.v.length;k++) {\n          if(lhs.v < Number(rhs.v[k])) return true;\n        }\n        return false;\n      }\n      if(lhs.t === 'arr' && lhs.v.length===0) lhs ={t: 'num', string: '0', v: 0};\n      if(rhs.t === 'arr' && rhs.v.length===0) rhs ={t: 'num', string: '0', v: 0};\n      if(lhs.t === 'str' && rhs.t === 'str' && config.allowStringComparison) return lhs.v < rhs.v;\n      if(!isNumber(lhs.v) || !isNumber(rhs.v)) return false;\n      return lhs.v < rhs.v;\n    case '>':\n      if(lhs.t === 'bool') {\n        if(lhs.v === true && rhs.t === 'arr' && rhs.v.length === 0) return true;\n        if(lhs.v === true && rhs.t === 'num') return 1 > rhs.v;\n        if(lhs.v === true && rhs.t === 'bool') return 1 > (rhs.v === true ?  1 : 0);\n        return false;//lhs = {t: 'num', v: lhs.v === true ? 1 : 0, string: lhs.v === true ? '1' : '0'};\n      }\n      if(rhs.t === 'bool') {\n        if(rhs.v === false && lhs.t === 'arr' && lhs.v.length > 0) return true;\n        if(rhs.v === false && lhs.t === 'num') return lhs.v > 0;\n        if(rhs.v === true && lhs.t === 'num') return lhs.v > 1;\n        if(lhs.t === 'num') return lhs.v > rhs.v === true ? 1 : 0;\n        return false;\n      }\n\n      if(lhs.t === 'arr' && lhs.v.length > 0) {\n        for(var j=0;j<lhs.v.length;j++) {\n          if(Number(lhs.v[j]) > rhs.v) return true;\n        }\n        return false;\n      }\n      if(rhs.t === 'arr' && rhs.v.length > 0) {\n        for(var l=0;l<rhs.v.length;l++) {\n          if(lhs.v > Number(rhs.v[l])) return true;\n        }\n        return false;\n      }\n\n      if(lhs.t === 'arr' && lhs.v.length===0) lhs ={t: 'num', string: '0', v: 0};\n      if(lhs.t === 'bool' && lhs.v === true) lhs ={t: 'num', string: '1', v: 1};\n      if(lhs.t === 'bool' && lhs.v === false) lhs ={t: 'num', string: '0', v: 0};\n      if(rhs.t === 'arr' && rhs.v.length===0) rhs ={t: 'num', string: '0', v: 0};\n      if(rhs.t === 'bool' && rhs.v === true) rhs ={t: 'num', string: '1', v: 1};\n      if(rhs.t === 'bool' && rhs.v === false) rhs ={t: 'num', string: '0', v: 0};\n      if(lhs.t === 'str' && rhs.t === 'str' && config.allowStringComparison) return lhs.v > rhs.v;\n      if(!isNumber(lhs.v) || !isNumber(rhs.v)) return false;\n      return lhs.v > rhs.v;\n    case '<=':\n      if(rhs.t === 'arr' && rhs.v.length===0 && lhs.string && lhs.string.length>0) return false;\n      if(lhs.t === 'arr' && lhs.v.length===0 && rhs.string && rhs.string.length>0) return false;\n      if(rhs.t === 'bool' && rhs.v === false && lhs.t === 'arr' && lhs.v.length > 0) return false;\n      if(lhs.t === 'bool') lhs = {t: 'num', v: lhs.v === true ? 1 : 0, string: lhs.v === true ? '1' : '0'};\n      if(rhs.t === 'bool') rhs = {t: 'num', v: rhs.v === true ? 1 : 0, string: lhs.v === true ? '1' : '0'};\n\n      if(lhs.t === 'arr' && lhs.v.length > 0) {\n        for(var m=0;m<lhs.v.length;m++) {\n          if(Number(lhs.v[m]) <= rhs.v) return true;\n        }\n        return false;\n      }\n      if(rhs.t === 'arr' && rhs.v.length > 0) {\n        for(var p=0;p<rhs.v.length;p++) {\n          if(lhs.v <= Number(rhs.v[p])) return true;\n        }\n        return false;\n      }\n\n      if(rhs.t === 'arr' && rhs.v.length===0) rhs ={t: 'num', string: '0', v: 0};\n      if(lhs.t === 'arr' && lhs.v.length===0) lhs ={t: 'num', string: '0', v: 0};\n      if(lhs.t === 'bool' && lhs.v === true) lhs ={t: 'num', string: '1', v: 1};\n      if(lhs.t === 'bool' && lhs.v === false) lhs ={t: 'num', string: '0', v: 0};\n      if(rhs.t === 'bool' && rhs.v === true) rhs ={t: 'num', string: '1', v: 1};\n      if(rhs.t === 'bool' && rhs.v === false) rhs ={t: 'num', string: '0', v: 0};\n      if(lhs.t === 'str' && rhs.t === 'str' && config.allowStringComparison) return lhs.v <= rhs.v;\n      if(!isNumber(lhs.v) || !isNumber(rhs.v)) return false;\n      return lhs.v <= rhs.v;\n    case '>=':\n\n      if(rhs.t === 'arr' && rhs.v.length===0 && lhs.string && lhs.string.length>0) return false;\n      if(rhs.t === 'arr' && rhs.v.length > 0 && lhs.v === false) return false;\n      if(lhs.t === 'arr' && lhs.v.length===0) {\n        if(rhs.t === 'str' && rhs.v === '') return false;\n        if(rhs.t === 'str') return rhs.v.length >= 0;\n        return (rhs.v.length >= 0 || rhs.v === false);\n      }\n\n      if(lhs.t === 'bool') lhs = {t: 'num', v: lhs.v === true ? 1 : 0, string: lhs.v === true ? '1' : '0'};\n      if(rhs.t === 'bool') rhs = {t: 'num', v: rhs.v === true ? 1 : 0, string: lhs.v === true ? '1' : '0'};\n\n      if(lhs.t === 'arr' && lhs.v.length>0) {\n        for(var q=0;q<lhs.v.length;q++) {\n          if(Number(lhs.v[q]) >= rhs.v) return true;\n        }\n        return false;\n      }\n\n      if(rhs.t === 'arr' && rhs.v.length>0) {\n        for(var r=0;r<rhs.v.length;r++) {\n          if(lhs.v >= Number(rhs.v[r])) return true;\n        }\n        return false;\n      }\n\n      if(lhs.t === 'arr' && lhs.v.length===0) lhs ={t: 'num', string: '0', v: 0};\n      if(lhs.t === 'bool' && lhs.v === true) lhs ={t: 'num', string: '1', v: 1};\n      if(lhs.t === 'bool' && lhs.v === false) lhs ={t: 'num', string: '0', v: 0};\n      if(rhs.t === 'arr' && rhs.v.length===0) rhs ={t: 'num', string: '0', v: 0};\n      if(rhs.t === 'bool' && rhs.v === true) rhs ={t: 'num', string: '1', v: 1};\n      if(rhs.t === 'bool' && rhs.v === false) rhs ={t: 'num', string: '0', v: 0};\n\n      if(lhs.t === 'str' && rhs.t === 'str' && config.allowStringComparison) return lhs.v >= rhs.v;\n      if(!isNumber(lhs.v) || !isNumber(rhs.v)) return false;\n      return lhs.v >= rhs.v;\n\n    case '!=':\n      if(lhs.t === 'bool' && rhs.t === 'arr') {return lhs.v === rhs.v.length < 1;}\n      if(rhs.t === 'bool' && lhs.t === 'arr') {return rhs.v === lhs.v.length < 1;}\n\n      return lhs.v != rhs.v;\n    case '&':  return Boolean(lhs.v && rhs.v);\n    case '|':  return Boolean(lhs.v || rhs.v);\n  }\n}\n\nmodule.exports = {\n  handleOperation\n};\n","var {DATE_STRING, dateToDays} = require('./date');\n\nvar TOO_MANY_ARGS = new Error('too many args');\nvar TOO_FEW_ARGS = new Error('too few args');\nvar INVALID_ARGS = new Error('invalid args');\n\nvar NATIVE_FUNS = /^id\\(|^\\([1-9]|^\\([a-zA-Z]|lang\\(|local-name|namespace-uri|last\\(|name\\(|child::|parent::|descendant::|descendant-or-self::|ancestor::|ancestor-or-self::sibling|following::|following-sibling::|preceding-sibling::|preceding::|attribute::/;\n\nfunction isNativeFunction(input) {\n  return NATIVE_FUNS.test(input);\n}\n\nfunction checkMinMaxArgs(args, min, max) {\n  if(min != null && args.length < min) throw TOO_FEW_ARGS;\n  if(max != null && args.length > max) throw TOO_MANY_ARGS;\n}\n\nfunction checkNativeFn(name, args) {\n  if(name === 'last') {\n    checkMinMaxArgs(args, null, 0);\n  } else if(/^(boolean|lang|ceiling|name|floor)$/.test(name)) {\n    checkMinMaxArgs(args, 1, 1);\n  } else if(/^(number|string|normalize-space|string-length)$/.test(name)) {\n    checkMinMaxArgs(args, null, 1);\n  } else if(name === 'substring') {\n    checkMinMaxArgs(args, 2, 3);\n  } else if(/^(starts-with|contains|substring-before|substring-after)$/.test(name)) {\n    checkMinMaxArgs(args, 2, 2);\n  } else if(name === 'translate') {\n    checkMinMaxArgs(args, 3, 3);\n  }\n}\n\nfunction preprocessNativeArgs(name, args) {\n  if(name === 'number' && args.length) {\n    if(args[0].t === 'arr') {\n      args = [{t: 'num', v: args[0].v[0]}];\n    } else if(args[0].t === 'str' && DATE_STRING.test(args[0].v)) {\n      args = [{t: 'num', v: dateToDays(args[0].v)}];\n    } else if(args[0].t === 'num' && args[0].v.toString().indexOf('e-') > 0) {\n      args = [{t: 'num', v: 0}];\n    }\n  }\n  if(name === 'name' && args.length < 2) throw TOO_FEW_ARGS;\n  if(name === 'namespace-uri') {\n    if(args.length > 1) throw TOO_MANY_ARGS;\n    if(args.length === 0) throw TOO_FEW_ARGS;\n    if(args.length === 1 && !isNaN(args[0].v)) throw INVALID_ARGS;\n  }\n  if(name === 'local-name') {\n    if(args.length > 1) throw TOO_MANY_ARGS;\n    if(args.length === 1 && !isNaN(args[0].v)) throw INVALID_ARGS;\n  }\n\n  if(name === 'substring' && args.length > 2 && args[1].v === Number.NEGATIVE_INFINITY && args[2].v === Number.POSITIVE_INFINITY) {\n    args[0].v = '';\n  }\n\n  if(name === 'substring' && args.length > 1 && args[1].v < 0) {\n    args[1].v = 0;\n  }\n  if(name === 'substring' && args.length > 2 && args[2].v === Number.POSITIVE_INFINITY) {\n    args[2].v = args[0].v.length + 1;\n  }\n  checkNativeFn(name, args);\n  return args;\n}\n\nmodule.exports = {\n  isNativeFunction,\n  preprocessNativeArgs\n};\n","function isOperation(input, rT) {\n  return rT === XPathResult.NUMBER_TYPE && // expects a number result\n    input.indexOf('(') < 0 // not a function based expression\n    && !input.startsWith('/'); // not a path expression\n}\n\nvar ARGS_REGEX = /\\(\\s*([^)]*)\\)$/;\n\nfunction inputArgs(input) {\n  var m = input.match(ARGS_REGEX);\n  return m ? m[1].split(',') : [];\n}\n\nfunction preprocessInput(input, rT) {\n  if(isOperation(input, rT)) {\n    input = input.replace('\\n', ''); //replaces new lines for expressions without functions\n    if(input.indexOf('mod') > 0) { // to support 1mod1 or any weirdness\n      input = input.replace('mod', ' mod ');\n    }\n    if(input.indexOf('div') > 0) { // to support 1div1 or any weirdness\n      input = input.replace('div', ' div ');\n    }\n  }\n\n  if(input === 'string(namespace::node())') {\n    input = input.replace('namespace::node()', 'namespace-uri(/*)');\n  }\n  return input;\n}\n\nmodule.exports = {\n  inputArgs,\n  preprocessInput\n};\n","var {area, distance, areaOrDistance} = require('./geo');\nvar {digest} = require('./digest');\nvar {randomToken} = require('./random-token');\nvar xpr = require('./xpr');\n\nvar openrosa_xpath_extensions = function(config) {\n  var\n      TOO_MANY_ARGS = new Error('too many args'),\n      TOO_FEW_ARGS = new Error('too few args'),\n      MILLIS_PER_DAY = 1000 * 60 * 60 * 24,\n      RAW_NUMBER = /^(-?[0-9]+)(\\.[0-9]+)?$/,\n      DATE_STRING = /^\\d\\d\\d\\d-\\d{1,2}-\\d{1,2}(?:T\\d\\d:\\d\\d:\\d\\d\\.?\\d?\\d?(?:Z|[+-]\\d\\d:\\d\\d)|.*)?$/,\n      XPR = xpr,\n      _zeroPad = function(n, len) {\n        len = len || 2;\n        n = n.toString();\n        while(n.length < len) n = '0' + n;\n        return n;\n      },\n      _int = function(r) { return Math.round(_float(r)); },\n      _float = function(r) { return r.t === 'num'? r.v: parseFloat(_str(r)); },\n      _str = function(r) {\n        return r.t === 'arr' ?\n               r.v.length ? r.v[0].toString() : '' :\n            r.v.toString();\n      },\n      _dateToString = function(d) {\n            return d.getFullYear() + '-' + _zeroPad(d.getMonth()+1) + '-' +\n                _zeroPad(d.getDate());\n      },\n      _round = function(num) {\n        if(num < 0) {\n          return -Math.round(-num);\n        }\n        return Math.round(num);\n      },\n      _uuid_part = function(c) {\n        var r = Math.random()*16|0,\n            v = c == 'x' ? r : r&0x3|0x8;\n        return v.toString(16);\n      },\n      _date = function(it, keepTime) {\n        var temp, t;\n        if(it.v instanceof Date) {\n          return new Date(it.v);\n        }\n        it = _str(it);\n        if(RAW_NUMBER.test(it)) {\n          // Create a date at 00:00:00 1st Jan 1970 _in the current timezone_\n          temp = new Date(1970, 0, 1);\n          temp.setDate(1 + parseInt(it, 10));\n          return temp;\n        } else if(DATE_STRING.test(it)) {\n          if(keepTime && it.indexOf('T')>0) return new Date(it);\n          t = it.indexOf('T');\n          if(t !== -1) it = it.substring(0, t);\n          temp = it.split('-');\n          temp = new Date(temp[0], temp[1]-1, temp[2]);\n          return temp;\n        }\n        var d = new Date(it);\n        return d == 'Invalid Date' ? null : d;\n      },\n      _dateForReturnType = function(it, rt) {\n        if(rt === XPathResult.BOOLEAN_TYPE) {\n          if(!it) return XPR.boolean(false);\n          return XPR.boolean(!isNaN(new Date(it).getTime()));\n        }\n        if(rt === XPathResult.NUMBER_TYPE) {\n          if(!it) return XPR.number(0);\n          return XPR.number((new Date(it).getTime()) / (1000 * 60 * 60 * 24));\n        }\n        if(rt === XPathResult.STRING_TYPE) {\n          if(!it) return XPR.string('Invalid Date');\n          return XPR.string(new Date(it).toISOLocalString());\n        }\n        if(!it) return XPR.string('Invalid Date');\n        return XPR.date(it);\n      },\n      uuid = function() {\n          return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'\n                  .replace(/[xy]/g, _uuid_part);\n      },\n      date = function(it, rt) {\n        it = _date(it);\n        return _dateForReturnType(it, rt);\n      },\n      format_date = function(date, format) {\n        date = _date(date, true);\n        if(!format) return '';\n        format = _str(format);\n        if(!date) return 'Invalid Date';\n        var c, i, sb = '', f = {\n          year: 1900 + date.getYear(),\n          month: 1 + date.getMonth(),\n          day: date.getDate(),\n          hour: date.getHours(),\n          minute: date.getMinutes(),\n          second: date.getSeconds(),\n          millis: date.getMilliseconds(),\n          secTicks: date.getTime(),\n          dow: 1 + date.getDay(),\n        };\n        var locale = window ? window.enketoFormLocale : undefined;\n\n        for(i=0; i<format.length; ++i) {\n          c = format.charAt(i);\n\n          if (c === '%') {\n            if(++i >= format.length) {\n              throw new Error(\"date format string ends with %\");\n            }\n            c = format.charAt(i);\n\n            if (c === '%') { // literal '%'\n              sb += '%';\n            } else if (c === 'Y') {  //4-digit year\n              sb += _zeroPad(f.year, 4);\n            } else if (c === 'y') {  //2-digit year\n              sb += _zeroPad(f.year, 4).substring(2);\n            } else if (c === 'm') {  //0-padded month\n              sb += _zeroPad(f.month, 2);\n            } else if (c === 'n') {  //numeric month\n              sb += f.month;\n            } else if (c === 'b') {  //short text month\n              sb += date.toLocaleDateString( locale, { month: 'short' } );\n            } else if (c === 'd') {  //0-padded day of month\n              sb += _zeroPad(f.day, 2);\n            } else if (c === 'e') {  //day of month\n              sb += f.day;\n            } else if (c === 'H') {  //0-padded hour (24-hr time)\n              sb += _zeroPad(f.hour, 2);\n            } else if (c === 'h') {  //hour (24-hr time)\n              sb += f.hour;\n            } else if (c === 'M') {  //0-padded minute\n              sb += _zeroPad(f.minute, 2);\n            } else if (c === 'S') {  //0-padded second\n              sb += _zeroPad(f.second, 2);\n            } else if (c === '3') {  //0-padded millisecond ticks (000-999)\n              // sb += _zeroPad(f.secTicks, 3);\n              sb += _zeroPad(f.millis, 3);\n            } else if (c === 'a') {  //Three letter short text day\n              sb += date.toLocaleDateString( locale, { weekday: 'short' } );\n            } else if (c === 'Z' || c === 'A' || c === 'B') {\n              throw new Error('unsupported escape in date format string [%' + c + ']');\n            } else {\n              throw new Error('unrecognized escape in date format string [%' + c + ']');\n            }\n          } else {\n            sb += c;\n          }\n        }\n\n        return sb;\n      },\n      func, process, ret = {},\n      now_and_today = function(rt, resetTime) {\n        return _dateForReturnType(ret._now(resetTime), rt);\n      };\n\n  func = {\n    abs: function(r) { return XPR.number(Math.abs(r.v)); },\n    acos: function(r) { return XPR.number(Math.acos(r.v)); },\n    asin: function(r) { return XPR.number(Math.asin(r.v)); },\n    atan: function(r) { return XPR.number(Math.atan(r.v)); },\n    atan2: function(r) {\n      if(arguments.length>1) {\n        var y = arguments[0].v;\n        var x = arguments[1].v;\n        return XPR.number(Math.atan2(y, x));\n      }\n      return XPR.number(Math.atan2(r.v));\n    },\n    'boolean-from-string': function(string) {\n      string = _str(string);\n      return XPR.boolean(string === '1' || string === 'true');\n    },\n    area: function(r) {\n      if(arguments.length === 0) throw TOO_FEW_ARGS;\n      return areaOrDistance(XPR.number, area, r);\n\t\t},\n    checklist: function(min, max) {\n      var i, j, trues = 0;\n      min = min.v;\n      max = max.v;\n      for (i=2;i < arguments.length;i++) {\n        var arg = arguments[i];\n        if (arg.t === 'bool' && Boolean(arg.v)) {\n          trues++;\n        } else if (arg.t === 'arr') {\n          for(j=0;j<arg.v.length;j++) {\n            if(arg.v[j]) trues++;\n          }\n        }\n      }\n      return XPR.boolean((min < 0 || trues >= min) && (max < 0 || trues <= max));\n    },\n    coalesce: function(a, b) { return XPR.string(_str(a) || _str(b)); },\n    concat: function() {\n      var out = [];\n      for (var j = 0; j < arguments.length; j++){\n        if(arguments[j].t === 'arr') {\n          out.push(arguments[j].v.join(''));\n        } else {\n          out.push(arguments[j].v);\n        }\n      }\n      return XPR.string(out.join(''));\n    },\n    cos: function(r) { return XPR.number(Math.cos(r.v)); },\n    'count-non-empty': function(r) {\n      if(arguments.length === 0 || r.t !== 'arr') throw TOO_FEW_ARGS;\n      var counter = 0;\n      for (var j = 0; j < r.v.length; j++){\n        counter += r.v[j] === '' ? 0 : 1;\n      }\n      return XPR.number(counter);\n    },\n    'count-selected': function(s) {\n      var parts = _str(s).split(' '),\n          i = parts.length,\n          count = 0;\n      while(--i >= 0) if(parts[i].length) ++count;\n      return XPR.number(count);\n    },\n    date: function(it, rt) {\n      it = _date(it);\n      return _dateForReturnType(it, rt);\n    },\n    'decimal-date': function(date) {\n      if(arguments.length > 1) throw TOO_MANY_ARGS;\n      var res = Date.parse(_str(date)) / MILLIS_PER_DAY;\n      return XPR.number(res);\n    },\n    'decimal-time': function(r) {\n      if(arguments.length > 1) throw TOO_MANY_ARGS;\n      if(r.t === 'num') return XPR.number(NaN);\n      var time = r.v;\n      // There is no Time type, and so far we don't need it so we do all validation\n      // and conversion here, manually.\n      var\tm = time.match(/^(\\d\\d):(\\d\\d):(\\d\\d)(\\.\\d\\d?\\d?)?(\\+|-)(\\d\\d):(\\d\\d)$/);\n      var dec;\n      if (m &&\n        m[1] < 24 && m[1] >= 0 &&\n        m[2] < 60 && m[2] >= 0 &&\n        m[3] < 60 && m[3] >= 0 &&\n        m[6] < 24 && m[6] >= 0 && // this could be tighter\n        m[7] < 60 && m[7] >= 0 // this is probably either 0 or 30\n      ) {\n        var pad2 = function(x) { return (x < 10) ? '0' + x : x; };\n        var today = new Date(); // use today to cater to daylight savings time.\n        var d = new Date(today.getFullYear() + '-' + pad2(today.getMonth() + 1) + '-' + pad2(today.getDate()) + 'T' + time);\n        if(d.toString() === 'Invalid Date'){\n          dec = NaN;\n        } else {\n          dec = (d.getSeconds()/3600 + d.getMinutes()/60 + d.getHours()) / 24;\n        }\n      } else {\n        dec = NaN;\n      }\n      return XPR.number(dec);\n    },\n    digest: function(msg, algo, encoding) {\n      return XPR.string(digest(msg, algo, encoding));\n    },\n    distance: function(r) {\n      if(arguments.length === 0) throw TOO_FEW_ARGS;\n      return areaOrDistance(XPR.number, distance, r);\n    },\n    exp: function(r) { return XPR.number(Math.exp(r.v)); },\n    exp10: function(r) { return XPR.number(Math.pow(10, r.v)); },\n    'false': function(rt) {\n      if(rt === XPathResult.NUMBER_TYPE) return XPR.number(0);\n      if(arguments.length>1) throw TOO_MANY_ARGS;\n      return XPR.boolean(false);\n    },\n    'format-date': function(date, format) {\n      return XPR.string(format_date(date, format)); },\n    'if': function(con, a, b) {\n      if(con.t === 'bool') return XPR.string(con.v ? a.v : b.v);\n      if(con.t === 'arr') {\n        var exists = con.v.length && con.v[0] !== null;\n        return XPR.string(exists ? a.v : b.v);\n      }\n      return XPR.string(b.v);\n    },\n    'ends-with': function(a, b) {\n      if(arguments.length > 2) throw TOO_MANY_ARGS;\n      if(arguments.length < 2) throw TOO_FEW_ARGS;\n      return XPR.boolean(a.v.endsWith(b.v));\n    },\n    int: function(v) {\n      if(v.t === 'str' && v.v.indexOf('e-')>0) return XPR.number(NaN);\n      v = _str(v);\n      if(v.indexOf('e-')>0) return XPR.number(0);\n      return XPR.number(parseInt(v, 10));\n    },\n    join: function() {\n      var delim = arguments[0];\n      if(arguments.length<2) return XPR.string('');\n      if(arguments.length>2) {\n        var out = [];\n        for (var i = 1; i < arguments.length; i++){\n          out.push(arguments[i].v);\n        }\n        return XPR.string(out.join(_str(delim)));\n      }\n      return XPR.string(arguments[1].v.join(_str(delim)));\n    },\n    log: function(r) { return XPR.number(Math.log(r.v)); },\n    log10: function(r) { return XPR.number(Math.log10(r.v)); },\n    max: function() {\n      if(arguments.length > 1) {\n        var out = [];\n        for (var j = 0; j < arguments.length; j++){\n          out.push(arguments[j].v);\n        }\n        return XPR.number(Math.max.apply(null, out));\n      }\n      var max, i;\n      var r = arguments[0].v;\n      if(!(i=r.length)) return XPR.number(NaN);\n      max = parseFloat(r[0]);\n      while(--i) max = Math.max(max, parseFloat(r[i]));\n      return XPR.number(max);\n    },\n    min: function() {\n      if(arguments.length > 1) {\n        var out = [];\n        for (var j = 0; j < arguments.length; j++){\n          out.push(arguments[j].v);\n        }\n        return XPR.number(Math.min.apply(null, out));\n      }\n      var min, i;\n      var r = arguments[0].v;\n      if(!(i=r.length)) return XPR.number(NaN);\n      min = parseFloat(r[0]);\n      while(--i) min = Math.min(min, parseFloat(r[i]));\n      return XPR.number(min);\n    },\n    /*\n     * As per https://github.com/alxndrsn/openrosa-xpath-evaluator/issues/15,\n     * the pass-through to the wrapped implementation always requests\n     * XPathResult.STRING_TYPE.  This seems to cause an issue with the response\n     * from `not()` calls, which should ideally be handled by the built-in\n     * XPath implementation.  The following method is supplied as a workaround,\n     * and ideally would be unnecessary.\n     */\n    not: function(r) {\n      if(arguments.length === 0) throw TOO_FEW_ARGS;\n      if(arguments.length > 1) throw TOO_MANY_ARGS;\n      return XPR.boolean(!r.v);\n    },\n    now: function(rt) {\n      return now_and_today(rt);\n    },\n    today: function(rt) {\n      var r = now_and_today(rt, !config.returnCurrentTimeForToday);\n      if(rt === XPathResult.STRING_TYPE && !config.includeTimeForTodayString) {\n        r.v = r.v.split('T')[0];\n      }\n      return r;\n    },\n    /**\n     * The once function returns the value of the parameter if its own value\n     * is not empty, NaN, [Infinity or -Infinity]. The naming is therefore misleading!\n     * Also note that the parameter expr is always evaluated.\n     * This function simply decides whether to return the new result or the old value.\n     */\n    once: function(node, r) {\n      if(node.v.length && node.v[0].length) {\n        return XPR.string(node.v[0]);\n      }\n      if(r.v == Infinity) return XPR.string('');\n      if(r.t === 'num' && r.v === 0) return XPR.string('');\n      return XPR.string(r.v);\n    },\n    pi: function() { return XPR.number(Math.PI); },\n    position: function(r) {\n      var position = 1;\n      if(r) {\n        var node = r.iterateNext();\n        var nodeName = node.tagName;\n        while (node.previousElementSibling && node.previousElementSibling.tagName === nodeName) {\n          node = node.previousElementSibling;\n          position++;\n        }\n      }\n      return XPR.number(position);\n    },\n    pow: function(x, y) { return XPR.number(Math.pow(_float(x), _float(y))); },\n    random: function() { return XPR.number(Math.random()); },\n    randomize: function(r) {\n      if(arguments.length === 1) throw TOO_FEW_ARGS;//only rT passed\n      if(arguments.length > 3) throw TOO_MANY_ARGS;\n\n      var seed = arguments.length > 2 ? arguments[1] : arguments[2];\n      var rt = arguments[arguments.length - 1];\n\n      if(rt === XPathResult.BOOLEAN_TYPE) {\n        return XPR.boolean(r.v.length > 0 ? true : false);\n      }\n      if(rt === XPathResult.STRING_TYPE) {\n        if (r.v.length < 1) return '';\n        return XPR.string(r.v[0]);\n      }\n      // nodes as seed\n      if(Array.isArray(seed) && seed.length && seed[0].nodeType === 1) {\n        return [r, parseInt(seed[0].textContent)];\n      }\n      return [r, seed && seed.v];\n    },\n    regex: function(haystack, pattern) {\n        return XPR.boolean(new RegExp(_str(pattern)).test(_str(haystack))); },\n    round: function(number, num_digits) {\n      if(arguments.length === 0) throw TOO_FEW_ARGS;\n      if(arguments.length > 2) throw TOO_MANY_ARGS;\n      number = _float(number);\n      if(!num_digits) {\n        return XPR.number(_round(number));\n      }\n      num_digits = _int(num_digits);\n      var pow = Math.pow(10, Math.abs(num_digits));\n      if(num_digits > 0) {\n        return XPR.number(_round(number * pow) / pow);\n      } else {\n        return XPR.number(pow * _round(number / pow));\n      }\n    },\n    selected: function(haystack, needle) {\n      return XPR.boolean(_str(haystack).split(' ').indexOf(_str(needle).trim()) !== -1);\n    },\n    'selected-at': function(list, index) {\n      if(!index) throw new Error(JSON.stringify(list));\n      return XPR.string(_str(list).split(' ')[_int(index)] || '');\n    },\n    sin: function(r) { return XPR.number(Math.sin(r.v)); },\n    sqrt: function(r) { return XPR.number(Math.sqrt(r.v)); },\n    substr: function(string, startIndex, endIndex) {\n      return XPR.string(_str(string).slice(\n          _int(startIndex),\n          endIndex && _int(endIndex)));\n    },\n    sum: function(r) {\n      if(arguments.length > 1) throw TOO_MANY_ARGS;\n      var out = 0;\n      for (var i = 0; i < r.v.length; i++) {\n        if(!RAW_NUMBER.test(r.v[i])) XPR.number(NaN);\n        out += parseInt(r.v[i], 10);\n      }\n      return XPR.number(out);\n    },\n    tan: function(r) { return XPR.number(Math.tan(r.v)); },\n    'true': function(rt) {\n      if(rt === XPathResult.NUMBER_TYPE) return XPR.number(1);\n      if(arguments.length>1) throw TOO_MANY_ARGS;\n      return XPR.boolean(true);\n    },\n    uuid: function(r) {\n      if(r && r.v) return XPR.string(randomToken(r.v));\n      return XPR.string(uuid());\n    },\n    'weighted-checklist': function(min, max) {\n      var i, values = [], weights = [], weightedTrues = 0;\n      min = min.v;\n      max = max.v;\n      for (i=2 ; i < arguments.length ; i=i+2) {\n        var v = arguments[i];\n        var w = arguments[i+1];\n        if (v && w) {\n          // value or weight might be a nodeset\n          values.push(v.t === 'arr' ? v.v[0] : v.v);\n          weights.push(w.t === 'arr' ? w.v[0] : w.v);\n        }\n      }\n\n      for(i=0; i < values.length; i++) {\n        if(values[i]) {\n          weightedTrues += weights[i];\n        }\n      }\n      return XPR.boolean((min < 0 || weightedTrues >= min) && (max < 0 || weightedTrues <= max));\n    }\n  };\n\n  // function aliases\n  func['date-time'] = func.date;\n  func['decimal-date-time'] = func['decimal-date'];\n  func['format-date-time'] = func['format-date'];\n\n  process = {\n      toExternalResult: function(r) {\n        if(r.t === 'date') return {\n          resultType:XPathResult.STRING_TYPE,\n          // TODO a bit naughty, but we return both a string and number value\n          // for dates.  We should actually know from where the xpath evaluator\n          // was initially called whether we expect a STRING_TYPE or NUMBER_TYPE\n          // result, but we should get away with it because:\n          //   1. this setup makes testing easy\n          //   2. dates should never leak outside openrosa functionality anyway\n          numberValue:r.v.getTime(),\n          stringValue:_dateToString(r.v),\n        };\n      },\n      typefor: function(val) {\n        if(val instanceof Date) return 'date';\n      },\n      handleInfix: function(err, lhs, op, rhs) {\n        if(lhs.t === 'date' || rhs.t === 'date') {\n          // For comparisons, we must make sure that both values are numbers\n          // Dates would be fine, except for equality!\n          if( op.v === '=' ||\n              op.v === '<' ||\n              op.v === '>' ||\n              op.v === '<=' ||\n              op.v === '>=' ||\n              op.v === '!=') {\n            if(lhs.t === 'arr' || lhs.t === 'str') lhs = date(lhs);\n            if(rhs.t === 'arr' || rhs.t === 'str') rhs = date(rhs);\n            if(lhs.t !== 'date' || rhs.t !== 'date') {\n              return op.v === '!=';\n            } else {\n              lhs = { t:'num', v:lhs.v.getTime() };\n              rhs = { t:'num', v:rhs.v.getTime() };\n            }\n          } else if(op.v === '+' || op.v === '-') {\n            // for math operators, we need to do it ourselves\n            if(lhs.t === 'date' && rhs.t === 'date') err();\n            var d = lhs.t === 'date'? lhs.v: rhs.v,\n                n = lhs.t !== 'date'? _int(lhs): _int(rhs),\n                res = new Date(d.getTime());\n            if(op.v === '-') n = -n;\n            res.setDate(d.getDate() + n);\n            return res;\n          }\n          return { t:'continue', lhs:lhs, op:op, rhs:rhs };\n        }\n      },\n  };\n\n  ret.func = func;\n  ret.process = process;\n  ret.XPR = XPR;\n  ret._now = function(resetTime) {\n    var t = new Date();\n    if(resetTime) {\n      return new Date(t.getFullYear(), t.getMonth(), t.getDate());\n    }\n    return t;\n  };\n  ret.customXPathFunction = {\n    type: {\n      StringType: XPR.string,\n      NumberType: XPR.number,\n      BooleanType: XPR.boolean,\n      DateType: XPR.date\n    },\n    add: function(name, fnObj) {\n      func[name] = fnObj;\n    },\n    remove: function(name) {\n      delete func[name];\n    },\n    all: function() {\n      return func;\n    }\n  };\n\n  return ret;\n};\n\nmodule.exports = openrosa_xpath_extensions;\n","var EARTH_EQUATORIAL_RADIUS_METERS = 6378100;\nvar PRECISION = 100;\n\nfunction _toLatLngs(geopoints) {\n  return geopoints.map(function (geopoint) {\n    return geopoint.trim().split(' ');\n  });\n}\n\n// converts degrees to radians\nfunction _toRadians(angle) {\n  return angle * Math.PI / 180;\n}\n\n// check if all geopoints are valid (copied from Enketo FormModel)\nfunction _latLngsValid(latLngs) {\n  return latLngs.every(function (coords) {\n    return (\n      (coords[0] !== '' && coords[0] >= -90 && coords[0] <= 90) &&\n      (coords[1] !== '' && coords[1] >= -180 && coords[1] <= 180) &&\n      (typeof coords[2] == 'undefined' || !isNaN(coords[2])) &&\n      (typeof coords[3] == 'undefined' || (!isNaN(coords[3]) && coords[3] >= 0))\n    );\n  });\n}\n\n/**\n * Adapted from https://www.movable-type.co.uk/scripts/latlong.html\n *\n * @param {{lat:number, lng: number}} p1\n * @param {{lat:number, lng: number}} p2\n * @returns {number}\n */\nfunction _distanceBetween(p1,p2) {\n  var Δλ = _toRadians(p1.lng - p2.lng);\n  var φ1 = _toRadians(p1.lat);\n  var φ2 = _toRadians(p2.lat);\n  return Math.acos(Math.sin(φ1) * Math.sin(φ2) + Math.cos(φ1) * Math.cos(φ2) * Math.cos(Δλ)) * EARTH_EQUATORIAL_RADIUS_METERS;\n}\n\nfunction areaOrDistance(xpr, fn, r) {\n  var geopoints = [];\n  if(r.t === 'str') geopoints = r.v.split(';');\n  if(r.t === 'arr') {\n    if(r.v.length === 1) geopoints = r.v[0].split(';');\n    else geopoints = r.v;\n  }\n  return xpr(fn(geopoints));\n}\n\n/**\n * Adapted from https://github.com/Leaflet/Leaflet.draw/blob/3cba37065ea5be28f42efe9cc47836c9e3f5db8c/src/ext/GeometryUtil.js#L3-L20\n */\nfunction area(geopoints) {\n  var latLngs = _toLatLngs(geopoints);\n\n  if (!_latLngsValid(latLngs)) {\n    return Number.NaN;\n  }\n\n  var pointsCount = latLngs.length;\n  var area = 0.0;\n\n  if (pointsCount > 2) {\n    for (var i = 0; i < pointsCount; i++) {\n      var p1 = {\n        lat: latLngs[i][0],\n        lng: latLngs[i][1]\n      };\n      var p2 = {\n        lat: latLngs[(i + 1) % pointsCount][0],\n        lng: latLngs[(i + 1) % pointsCount][1]\n      };\n      area += _toRadians(p2.lng - p1.lng) *\n          (2 + Math.sin(_toRadians(p1.lat)) + Math.sin(_toRadians(p2.lat)));\n    }\n    area = area * EARTH_EQUATORIAL_RADIUS_METERS * EARTH_EQUATORIAL_RADIUS_METERS / 2.0;\n  }\n  return Math.abs(Math.round(area * PRECISION)) / PRECISION;\n}\n\n/**\n * @param {any} geopoints\n * @returns\n */\nfunction distance(geopoints) {\n  var latLngs = _toLatLngs(geopoints);\n\n  if (!_latLngsValid(latLngs)) {\n    return Number.NaN;\n  }\n\n  var pointsCount = latLngs.length;\n  var distance = 0.0;\n\n  if (pointsCount > 1) {\n    for (var i = 1; i < pointsCount; i++) {\n      var p1 = {\n        lat: latLngs[i - 1][0],\n        lng: latLngs[i - 1][1]\n      };\n      var p2 = {\n        lat: latLngs[i][0],\n        lng: latLngs[i][1]\n      };\n\n      distance += _distanceBetween(p1, p2);\n    }\n  }\n\n  return Math.abs(Math.round(distance * PRECISION)) / PRECISION;\n}\n\nmodule.exports = {\n  area,\n  areaOrDistance,\n  distance\n};\n","const forge = require('node-forge');\n\nconst digest = (message, algo, encoding) => {\n  message = message.v;\n  algo = algo && algo.v && algo.v.toLowerCase();\n  encoding = (encoding && encoding.v && encoding.v.toLowerCase()) || 'base64';\n  if(!algo || !/^(md5|sha-1|sha-256|sha-384|sha-512)$/.test(algo)) {\n    throw new Error('Invalid algo.');\n  }\n  if(!/^(base64|hex)$/.test(encoding)) {\n    throw new Error('Invalid encoding.');\n  }\n  const md = forge.md[algo.replace('-', '')].create();\n  md.update(message);\n  const hashBuffer = md.digest();\n  if(!encoding || encoding === 'base64') {\n    return forge.util.encode64(hashBuffer.bytes());\n  }\n  return md.digest().toHex();\n};\n\nmodule.exports = {\n  digest\n};\n","module.exports = __WEBPACK_EXTERNAL_MODULE__16__;","function _random13chars() {\n  return Math.random().toString(16).substring(2);\n}\n\nfunction randomToken(length) {\n\tvar loops = Math.ceil(length / 13);\n\treturn new Array(loops)\n    .fill(_random13chars)\n    .reduce((string, func) => {\n      return string + func();\n    }, '').substring(0, length);\n}\n\nmodule.exports = {\n  randomToken\n};\n"],"sourceRoot":""}